(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{"0uxT":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),r=i("10Js");function a(){o.call(this,r.ServerDavModuleName),this.davServer=n.observable(r.ExternalHostNameOfDAVServer)}s.extendOwn(a.prototype,o.prototype),a.prototype.ViewTemplate="MobileSyncWebclient_DavAdminSettingsView",a.prototype.getCurrentValues=function(){return[this.davServer()]},a.prototype.revertGlobalValues=function(){this.davServer(r.ExternalHostNameOfDAVServer)},a.prototype.getParametersForSave=function(){return{ExternalHostNameOfDAVServer:this.davServer()}},a.prototype.applySavedValues=function(e){r.update(e.ExternalHostNameOfDAVServer)},a.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new a},"10Js":function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"MobileSync",HashModuleName:"mobilesync",ServerDavModuleName:"Dav",ExternalHostNameOfDAVServer:"",init:function(e){var t=e[this.ServerDavModuleName];s.isEmpty(t)||(this.ExternalHostNameOfDAVServer=n.pString(t.ExternalHostNameOfDAVServer,this.ExternalHostNameOfDAVServer))},update:function(e){this.ExternalHostNameOfDAVServer=e}}},"2ug6":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("Ol7c"),r=i("RN+F"),a=i("AFLV"),l=i("Yjhd"),h=null,u=i("JFZZ"),c=null,d=i("hPb3"),p=i("76Kh"),m=i("20Ah"),g=i("SbmC"),f=i("gAbd"),b=null,v=null,y=i("p2hp");function E(e){c=i("IAk5"),h=i("UN2P"),this.id=n.observable(a.pInt(e.AccountID)),this.email=n.observable(a.pString(e.Email)),this.friendlyName=n.observable(a.pString(e.FriendlyName)),this.incomingLogin=n.observable(a.pString(e.IncomingLogin)),this.passwordMightBeIncorrect=n.observable(!1),this.passwordMightBeIncorrect.subscribe((function(){this.passwordMightBeIncorrect()||(this.requireCache(),v.getFolderList(this.id()))}),this);var t=a.pString(e.Signature);0!==t.indexOf("<")&&(t="<div>"+t+"</div>"),this.signature=n.observable(t),this.useSignature=n.observable(!!e.UseSignature),this.serverId=n.observable(a.pInt(e.ServerId)),this.oServer=new f(e.Server),this.useToAuthorize=n.observable(!!e.UseToAuthorize),this.canBeUsedToAuthorize=n.observable(!!e.CanBeUsedToAuthorize),this.useThreading=n.observable(!!e.UseThreading),this.useThreading.subscribe((function(){this.requireCache(),v.clearMessagesCache(this.id())}),this),this.bSaveRepliesToCurrFolder=!!e.SaveRepliesToCurrFolder,this.isCurrent=n.observable(!1),this.isEdited=n.observable(!1),this.hash=n.computed((function(){return l.getHash(this.id()+this.email())}),this),this.fetchers=n.observableArray([]),this.identities=n.observable(null),this.aliases=n.observableArray([]),this.allowAutoresponder=n.observable(a.pBool(e.AllowAutoresponder,!1)),this.autoresponder=n.observable(null),this.allowForward=n.observable(a.pBool(e.AllowForward,!1)),this.forward=n.observable(null),this.allowFilters=n.observable(a.pBool(e.AllowFilters,!1)),this.filters=n.observable(null),this.quota=n.observable(0),this.usedSpace=n.observable(0),this.quotaRecieved=n.observable(!1),this.fullEmail=n.computed((function(){return o.getFullEmail(this.friendlyName(),this.email())}),this),this.bDefault=y.AllowDefaultAccountForUser&&this.email()===c.getUserPublicId(),this.aExtend=a.pObject(e.Extend),this.includeInUnifiedMailbox=n.observable(y.AllowUnifiedInbox&&!!e.IncludeInUnifiedMailbox),this.showUnifiedMailboxLabel=n.observable(y.AllowUnifiedInbox&&!!e.ShowUnifiedMailboxLabel),this.unifiedMailboxLabelText=n.observable(a.pString(e.UnifiedMailboxLabelText)),this.unifiedMailboxLabelColor=n.observable(a.pString(e.UnifiedMailboxLabelColor))}E.prototype.threadingIsAvailable=function(){return this.oServer.bEnableThreading&&this.useThreading()},E.prototype.updateFromServer=function(e){this.email(a.pString(e.Email)),this.friendlyName(a.pString(e.FriendlyName)),this.incomingLogin(a.pString(e.IncomingLogin)),this.serverId(a.pInt(e.ServerId)),this.oServer=new f(e.Server),this.useToAuthorize(!!e.UseToAuthorize),this.useThreading(!!e.UseThreading),this.bSaveRepliesToCurrFolder=!!e.SaveRepliesToCurrFolder,this.includeInUnifiedMailbox(!!e.IncludeInUnifiedMailbox),this.showUnifiedMailboxLabel(!!e.ShowUnifiedMailboxLabel),this.unifiedMailboxLabelText(a.pString(e.UnifiedMailboxLabelText)),this.unifiedMailboxLabelColor(a.pString(e.UnifiedMailboxLabelColor))},E.prototype.requireAccounts=function(){null===b&&(b=i("jonm"))},E.prototype.requireCache=function(){null===v&&(v=i("4+IO"))},E.prototype.onGetQuotaResponse=function(e,t){s.isArray(e.Result)&&1<e.Result.length&&(this.quota(a.pInt(e.Result[1])),this.usedSpace(a.pInt(e.Result[0])),this.requireCache(),v.quotaChangeTrigger(!v.quotaChangeTrigger())),this.quotaRecieved(!0)},E.prototype.updateQuotaParams=function(){d.ShowQuotaBar&&h.send("GetQuota",{AccountID:this.id()},this.onGetQuotaResponse,this)},E.prototype.updateFriendlyName=function(e){this.friendlyName(e)},E.prototype.changeAccount=function(){this.requireAccounts(),b.changeCurrentAccount(this.id(),!0)},E.prototype.getDefaultIdentity=function(){return s.find(this.identities()||[],(function(e){return e.isDefault()}))},E.prototype.getFetchersIdentitiesEmails=function(){var e=this.identities()||[],t=[];return s.each(this.fetchers(),(function(e){t.push(e.email())})),s.each(e,(function(e){t.push(e.email())})),t},E.prototype.remove=function(){var e=s.bind(this.confirmedRemove,this);this.bDefault||p.showPopup(m,[r.i18n("MAILWEBCLIENT/CONFIRM_REMOVE_ACCOUNT"),e,this.email()])},E.prototype.confirmedRemove=function(e){e&&h.send("DeleteAccount",{AccountID:this.id()},this.onAccountDeleteResponse,this)},E.prototype.onAccountDeleteResponse=function(e,t){if(e.Result){var n=i("h1OO");s.isFunction(n.closeComposePopup)&&n.closeComposePopup(t.Parameters.AccountID),this.requireAccounts(),b.deleteAccount(this.id())}else u.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_REMOVE_ACCOUNT"))},E.prototype.requestFilters=function(){h.send("GetFilters",{AccountID:this.id()},this.onGetFiltersResponse,this)},E.prototype.onGetFiltersResponse=function(e,t){var i=new g;e.Result&&i.parse(this.id(),e.Result),this.filters(i)},e.exports=E},"3Y+r":function(e,t,i){"use strict";var s=i("F/us"),n=i("SQrT"),o={checkIfFieldsEmpty:function(e,t){var i=s.find(e,(function(e){return""===e()}));return!i||(t&&n.showError(t),i.focused(!0),!1)},checkPassword:function(e,t){var s=i("RN+F"),o=i("hPb3"),r=!1;return t!==e?n.showError(s.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):o.PasswordMinLength>0&&e.length<o.PasswordMinLength?n.showError(s.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",o.PasswordMinLength)):!o.PasswordMustBeComplex||e.match(/([0-9])/)&&e.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?r=!0:n.showError(s.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),r}};e.exports=o},"4+IO":function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("wd/R"),a=i("RN+F"),l=i("AFLV"),h=i("Yjhd"),u=i("JFZZ"),c=i("IAk5"),d=i("TKFr"),p=i("QaF5"),m=i("hPb3"),g=i("ZCBP"),f=i("76Kh"),b=i("20Ah"),v=i("4M/5"),y=i("jonm"),E=i("UN2P"),S=i("xzvH"),A=null,I=i("p2hp"),T=i("qGK3"),C=i("5aTH"),F=i("lPfU"),L=c.isNewTab()&&window.opener&&window.opener.MainTabMailMethods;function M(){this.currentAccountId=y.currentId,this.currentAccountId.subscribe((function(e){var t=y.getAccount(e),i=this.oFolderListItems[e];t?(t.quotaRecieved(!1),this.messagesLoadingError(!1),i?this.folderList(i):(this.messagesLoading(!0),this.folderList(new C),this.messages([]),this.currentMessage(null),this.getFolderList(e))):this.folderList(new C)}),this),this.editedAccountId=y.editedId,this.editedAccountId.subscribe((function(e){var t=this.oFolderListItems[e];t?this.editedFolderList(t):(this.editedFolderList(new C),this.currentAccountId()!==e&&this.getFolderList(e))}),this),this.oFolderListItems={},this.quotaChangeTrigger=o.observable(!1),this.checkMailStarted=o.observable(!1),this.checkMailStartedAccountId=o.observable(0),this.folderList=o.observable(new C),this.folderListLoading=o.observableArray([]),this.oUnifiedInbox=new T(0,!0),this.getCurrentFolder=o.computed((function(){return this.oUnifiedInbox.selected()?this.oUnifiedInbox:this.folderList().currentFolder()}),this),this.getCurrentFolderFullname=o.computed((function(){return this.oUnifiedInbox.selected()?this.oUnifiedInbox.fullName():this.folderList().currentFolderFullName()}),this),this.getCurrentFolderType=o.computed((function(){return this.oUnifiedInbox.selected()?this.oUnifiedInbox.type():this.folderList().currentFolderType()}),this),this.editedFolderList=o.observable(new C),this.newMessagesCount=o.computed((function(){if(this.oUnifiedInbox.selected())return this.oUnifiedInbox.unseenMessageCount();var e=this.folderList().inboxFolder();return e?e.unseenMessageCount():0}),this),this.messages=o.observableArray([]),this.messages.subscribe((function(){if(this.messages().length>0&&this.messagesLoadingError(!1),this.currentMessage()){var e=s.find(this.messages(),function(e){return e.sUniq===this.currentMessage().sUniq}.bind(this)),t=e?this.getFolderByFullName(e.accountId(),e.folder()):null;t&&!e&&t.getCompletelyFilledMessage(this.currentMessage().uid(),null,null,!0)}}),this),this.uidList=o.observable(new F),this.page=o.observable(1),this.messagesLoading=o.observable(!1),this.messagesLoadingError=o.observable(!1),this.currentMessage=o.observable(null),this.nextMessageUid=o.observable(""),this.prevMessageUid=o.observable(""),this.savingDraftUid=o.observable(""),this.editedDraftUid=o.observable(""),this.disableComposeAutosave=o.observable(!1),this.aResponseHandlers=[],this.iAutoCheckMailTimer=-1,this.waitForUnseenMessages=o.observable(!0),this.iSetMessagesSeenCount=0,c.subscribeEvent("ReceiveAjaxResponse::after",s.bind((function(e){!this.checkMailStarted()&&"Ping"===e.Response.Method&&"Core"===e.Response.Module&&e.Response.Result&&this.executeCheckMail()}),this))}M.prototype.requirePrefetcher=function(){A=i("cPXi")},M.prototype.init=function(){if(E.registerOnAllRequestsClosedHandler((function(){s.delay((function(){E.hasOpenedRequests()||(w.checkMailStarted(!1),w.folderListLoading.removeAll())}),10),E.hasOpenedRequests()||w.savingDraftUid("")})),L){if(this.oFolderListItems=L.getFolderListItems(),this.uidList(L.getUidList()),window.name){var e=l.pInt(window.name);0===e&&(e=L.getComposedMessageAccountId(window.name)),0!==e&&this.currentAccountId(e)}this.currentAccountId.valueHasMutated(),this.initPrevNextSubscribes()}else this.currentAccountId.valueHasMutated(),this.initPrevNextSubscribes();this.oUnifiedInbox.parse({"@Object":"Object/Folder",Name:a.i18n("MAILWEBCLIENT/LABEL_FOLDER_ALL_INBOXES"),FullNameRaw:"__unified__inbox__",FullNameHash:"",Delimiter:"/",Type:Enums.FolderTypes.AllInboxes,AlwaysRefresh:!0,IsSubscribed:!0,IsSelectable:!0,Exists:!0,SubFolders:[]},"","")},M.prototype.initPrevNextSubscribes=function(){this.bInThreadLevel=!1,this.currentMessage.subscribe(this.calcNextMessageUid,this),this.uidList.subscribe(this.calcNextMessageUid,this),this.currentMessage.subscribe(this.calcPrevMessageUid,this),this.uidList.subscribe(this.calcPrevMessageUid,this)},M.prototype.calcNextMessageUid=function(){var e="",t="",i=null,n=null,o=!1;this.currentMessage()&&s.isFunction(this.currentMessage().uid)&&(o=this.currentMessage().threadPart()&&""!==this.currentMessage().threadParentUid(),i=this.getFolderByFullName(this.currentMessage().accountId(),this.currentMessage().folder()),e=this.oUnifiedInbox.selected()?this.currentMessage().unifiedUid():this.currentMessage().uid(),this.bInThreadLevel||o?(this.bInThreadLevel=!!L,o&&(n=i.getMessageByUid(this.currentMessage().threadParentUid()))&&(s.each(n.threadUids(),(function(i,s,n){i===e&&s>0&&(t=n[s-1])})),l.isNonEmptyString(t)||(t=n.uid()))):(s.each(this.uidList().collection(),(function(i,s,n){i===e&&s>0&&(t=n[s-1]||"")})),""===t&&L&&(this.requirePrefetcher(),A.prefetchNextPage(e)))),this.nextMessageUid(t)},M.prototype.calcPrevMessageUid=function(){var e="",t="",i=null,n=null,o=!1;this.currentMessage()&&s.isFunction(this.currentMessage().uid)&&(o=this.currentMessage().threadPart()&&""!==this.currentMessage().threadParentUid(),i=this.getFolderByFullName(this.currentMessage().accountId(),this.currentMessage().folder()),e=this.oUnifiedInbox.selected()?this.currentMessage().unifiedUid():this.currentMessage().uid(),this.bInThreadLevel||o?(this.bInThreadLevel=!0,o?(n=i.getMessageByUid(this.currentMessage().threadParentUid()))&&s.each(n.threadUids(),(function(i,s,n){i===e&&s+1<n.length&&(t=n[s+1]||"")})):this.currentMessage().threadCount()>0&&(t=this.currentMessage().threadUids()[0])):(s.each(this.uidList().collection(),(function(i,s,n){i===e&&s+1<n.length&&(t=n[s+1]||"")})),""===t&&L&&(this.requirePrefetcher(),A.prefetchPrevPage(e)))),this.prevMessageUid(t)},M.prototype.getFolderByFullName=function(e,t){if(t===this.oUnifiedInbox.fullName())return this.oUnifiedInbox;var i=this.oFolderListItems[e];return i?i.getFolderByFullName(t):null},M.prototype.checkCurrentFolderList=function(){var e=y.getCurrent(),t=e?this.oFolderListItems[e.id()]:null;!e||t||this.messagesLoading()||(this.messagesLoading(!0),this.messagesLoadingError(!1),this.getFolderList(e.id()))},M.prototype.getFolderList=function(e){y.getAccount(e)?(this.folderListLoading.push(e),E.send("GetFolders",{AccountID:e},this.onGetFoldersResponse,this)):e===this.currentAccountId()&&this.messagesLoading(!1)},M.prototype.markMessageReplied=function(e,t,i,s){var n=this.getFolderByFullName(e,t);n&&n.markMessageReplied(i,s)},M.prototype.hideThreads=function(e){var t=y.getCurrent();t&&t.threadingIsAvailable()&&e.folder()===this.getCurrentFolderFullname()&&!e.threadOpened()&&this.getCurrentFolder().hideThreadMessages(e)},M.prototype.showOpenedThreads=function(e){this.messages(this.getMessagesWithThreads(e,this.uidList(),this.messages()))},M.prototype.useThreadingInCurrentList=function(e){e=e||this.uidList();var t=y.getCurrent(),i=this.getCurrentFolder(),s=i&&i.withoutThreads(),n=""===e.search()&&""===e.filters();return t&&t.threadingIsAvailable()&&!s&&n},M.prototype.getMessagesWithThreads=function(e,t,i){var n=[],o=[],r=this.getCurrentFolder();return r&&(e===r.fullName()||this.oUnifiedInbox.selected()&&"INBOX"===e)&&this.useThreadingInCurrentList(t)?(o=s.filter(i,(function(e){return!e.threadPart()})),s.each(o,(function(e){var t=[];if(n.push(e),e.threadCount()>0){if(e.threadOpened())t=this.getFolderByFullName(e.accountId(),e.folder()).getThreadMessages(e),n=s.union(n,t);r.computeThreadData(e)}}),this),n):i},M.prototype.setMessagesFromUidList=function(e,t,i){var n=e.getUidsForOffset(t),o=s.map(n,(function(t){var i=e.iAccountId,s=e.sFullName;if(s===this.oUnifiedInbox.fullName()){var n=t.split(":");i=l.pInt(n[0]),s="INBOX",t=n[1]}return S.get([i,s,t])}),this),r=o.length;return i&&(this.messages(this.getMessagesWithThreads(this.getCurrentFolderFullname(),e,o)),t+r<e.resultCount()&&r<I.MailsPerPage&&(e.filters()!==Enums.FolderFilter.Unseen||this.waitForUnseenMessages())&&this.messagesLoading(!0),this.currentMessage()&&(this.currentMessage().deleted()||this.currentMessage().folder()!==this.getCurrentFolderFullname()&&!this.oUnifiedInbox.selected())&&this.currentMessage(null)),n},M.prototype.getNamesOfFoldersToRefresh=function(e){var t=this.oFolderListItems[e],i=t?t.getNamesOfFoldersToRefresh():[],n=y.getCurrentFetchersAndFiltersFolderNames();return i=s.uniq(s.compact(s.union(i,n)))},M.prototype.getUseListStatusIfPossibleValue=function(e,t){var i=this.oFolderListItems[e];return(i?i.getFoldersCount():0)<100||t>50},M.prototype.executeCheckMail=function(e){clearTimeout(this.iAutoCheckMailTimer);var t=this.currentAccountId(),i=[],n=[],o=this.checkMailStarted()&&this.checkMailStartedAccountId()===t,r=e||!E.hasOpenedRequests("GetRelevantFoldersInformation")||!E.hasOpenedRequests("GetUnifiedRelevantFoldersInformation")||!o,a=null;c.getUserRole()!==Enums.UserRole.Anonymous&&r&&(y.unifiedInboxReady()?(s.each(y.collection(),(function(e){(t===e.id()||e.includeInUnifiedMailbox())&&(i=this.getNamesOfFoldersToRefresh(e.id())).length>0&&n.push({AccountID:e.id(),Folders:i,UseListStatusIfPossible:this.getUseListStatusIfPossibleValue(e.id(),i.length)})}),this),n.length>0&&(a={AccountsData:n},this.checkMailStarted(!0),this.checkMailStartedAccountId(t),E.send("GetUnifiedRelevantFoldersInformation",a,this.onGetRelevantFoldersInformationResponse,this))):(i=this.getNamesOfFoldersToRefresh(this.currentAccountId())).length>0&&(a={AccountID:t,Folders:i,UseListStatusIfPossible:this.getUseListStatusIfPossibleValue(t,i.length)},this.checkMailStarted(!0),this.checkMailStartedAccountId(t),E.send("GetRelevantFoldersInformation",a,this.onGetRelevantFoldersInformationResponse,this)))},M.prototype.setAutocheckmailTimer=function(){clearTimeout(this.iAutoCheckMailTimer),!c.isNewTab()&&m.AutoRefreshIntervalMinutes>0&&(this.iAutoCheckMailTimer=setTimeout((function(){w.isSearchExecuting()||(w.checkMessageFlags(),w.executeCheckMail(!1))}),60*m.AutoRefreshIntervalMinutes*1e3))},M.prototype.isSearchExecuting=function(){var e=E.getOpenedRequest("GetMessages"),t=e&&e.Parameters;return t&&""!==t.Search},M.prototype.checkMessageFlags=function(){var e=this.folderList().inboxFolder(),t=e?e.getFlaggedMessageUids():[],i={Folder:this.folderList().inboxFolderFullName(),Uids:t};t.length>0&&E.send("GetMessagesFlags",i,this.onGetMessagesFlagsResponse,this)},M.prototype.onGetMessagesFlagsResponse=function(e,t){var i=t.Parameters,n=this.oFolderListItems[i.AccountID],o=n?n.inboxFolder():null;o&&(e.Result&&s.each(e.Result,(function(e,t){-1===s.indexOf(e,"\\flagged")&&o.setMessageUnflaggedByUid(t)})),o.removeFlaggedMessageListsFromCache(),this.requirePrefetcher(),A.prefetchStarredMessageList())},M.prototype.changeCurrentMessageList=function(e,t,i,s,n,o){this.requestCurrentMessageList(e,t,i,s,n,o,!0)},M.prototype.requestCurrentMessageList=function(e,t,i,s,n,o,a){var l=this.requestMessageList(e,t,i,s||"",n,o,!0,a||!1);if(l){var h=60*m.AutoRefreshIntervalMinutes*1e3,u=l.Folder.oRelevantInformationLastMoment?r().diff(l.Folder.oRelevantInformationLastMoment):h+1;this.uidList(l.UidList),this.page(t),this.messagesLoading(l.RequestStarted),this.messagesLoadingError(!1),!l.RequestStarted&&h>0&&u>h&&this.executeCheckMail(!0)}},M.prototype.requestMessageList=function(e,t,i,s,n,o,r,a,u){u=l.pBool(u,!1);var c=this.getFolderByFullName(this.currentAccountId(),e);if(!c)return h.log("requestMessageList, error: folder not found ",JSON.stringify({currentAccountId:this.currentAccountId(),sFolder:e,iPage:t,sSearch:i,sFilters:s,sSortBy:n,iSortOrder:o,bCurrent:r,bFillMessages:a})),null;var d=c&&c.withoutThreads(),p=y.getCurrent(),m=p&&p.threadingIsAvailable()&&!d&&""===i&&""===s,g=c?c.getUidList(i,s,n,o):null,f=g&&-1===g.resultCount(),b=(t-1)*I.MailsPerPage,v={Folder:e,Offset:b,Limit:I.MailsPerPage,Search:i,Filters:s,SortBy:n,SortOrder:o,UseThreading:m},S=!1,A=!1,T=r?this.onCurrentGetMessagesResponse:this.onGetMessagesResponse,C=[];return e===this.getTemplateFolder()&&0===b&&I.MailsPerPage<I.MaxTemplatesCountOnCompose&&""===i&&""===s&&n===I.MessagesSortBy.DefaultSortBy&&o===I.MessagesSortBy.DefaultSortOrder&&(v.Limit=I.MaxTemplatesCountOnCompose),c.type()===Enums.FolderTypes.Inbox&&""===s?v.InboxUidnext=c.sUidNext:v.InboxUidnext="",f&&g.iAccountId===this.uidList().iAccountId&&g.sFullName===this.uidList().sFullName&&g.search()===this.uidList().search()&&g.filters()===this.uidList().filters()&&g.sortBy()===this.uidList().sortBy()&&g.sortOrder()===this.uidList().sortOrder()&&(g=this.uidList()),g&&(C=this.setMessagesFromUidList(g,b,a),c.updateLastAccessTime(C)),g&&(A=f||b+C.length<g.resultCount()&&C.length<I.MailsPerPage,S=!u&&(c.hasChanges()||A)),S?v.Folder===this.oUnifiedInbox.fullName()?(delete v.Folder,E.send("GetUnifiedMailboxMessages",v,T,this)):E.send("GetMessages",v,T,this):this.waitForUnseenMessages(!1),{UidList:g,RequestStarted:S,DataExpected:A,Folder:c}},M.prototype.executeEmptyTrash=function(){var e=this.folderList().trashFolder();e&&e.emptyFolder()},M.prototype.executeEmptySpam=function(){var e=this.folderList().spamFolder();e&&e.emptyFolder()},M.prototype.onClearFolder=function(e){if(e&&e.selected()){this.messages.removeAll(),this.currentMessage(null);var t=e?e.getUidList(this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder()):null;t?this.uidList(t):this.uidList(new F),this.checkMailStarted(!1),this.setAutocheckmailTimer()}},M.prototype.getOpenedDraftUids=function(){var e=g.getOpenedWindows(),t=s.map(e,(function(e){return e.SlaveTabMailMethods?e.SlaveTabMailMethods.getEditedDraftUid():""}));return f.hasOpenedMinimizedPopups()&&t.push(this.editedDraftUid()),s.uniq(s.compact(t))},M.prototype.closeComposesWithDraftUids=function(e){var t=g.getOpenedWindows();if(s.each(t,(function(t){t.SlaveTabMailMethods&&-1!==n.inArray(t.SlaveTabMailMethods.getEditedDraftUid(),e)&&t.close()})),-1!==n.inArray(this.editedDraftUid(),e)){var o=i("h1OO");s.isFunction(o.closeComposePopup)&&o.closeComposePopup()}},M.prototype.moveMessagesToFolder=function(e,t,i){if(l.isNonEmptyArray(i)){var o=e&&e.type()===Enums.FolderTypes.Drafts,r=o&&this.getOpenedDraftUids(),h=o&&s.find(i,s.bind((function(e){return-1!==n.inArray(e,r)}),this)),u={AccountID:e?e.iAccountId:0,Folder:e?e.fullName():"",ToFolder:t.fullName(),Uids:i.join(",")},c=null,d=s.bind((function(){this.uidList().filters()===Enums.FolderFilter.Unseen&&this.uidList().resultCount()>I.MailsPerPage&&this.waitForUnseenMessages(!0),c=e.markDeletedByUids(i),t.addMessagesCountsDiff(c.MinusDiff,c.UnseenMinusDiff),this.setUnifiedInboxUnseenChanges(t.iAccountId,t.fullName(),c.MinusDiff,c.UnseenMinusDiff),t.recivedAnim(!0),this.excludeDeletedMessages(),t.markHasChanges(),E.send("MoveMessages",u,this.onMoveMessagesResponse,this)}),this);e&&t&&(h?(this.disableComposeAutosave(!0),f.showPopup(b,[a.i18n("MAILWEBCLIENT/CONFIRM_MESSAGE_FOR_DELETE_IS_EDITED"),s.bind((function(e){e&&(this.closeComposesWithDraftUids(i),d()),this.disableComposeAutosave(!1)}),this),"",a.i18n("MAILWEBCLIENT/ACTION_CLOSE_DELETE_DRAFT")])):d())}},M.prototype.copyMessagesToFolder=function(e,t){if(t.length>0){var i=this.getCurrentFolder(),s=this.getFolderByFullName(this.currentAccountId(),e),n={Folder:i?i.fullName():"",ToFolder:e,Uids:t.join(",")};i&&s&&(s.recivedAnim(!0),s.markHasChanges(),E.send("CopyMessages",n,this.onCopyMessagesResponse,this))}},M.prototype.excludeDeletedMessages=function(){s.delay(s.bind((function(){var e=(this.page()-1)*I.MailsPerPage;this.setMessagesFromUidList(this.uidList(),e,!0)}),this),500)},M.prototype.removeOneMessageFromCacheForFolder=function(e,t,i){var s=this.getFolderByFullName(e,t);s&&s.type()===Enums.FolderTypes.Drafts&&(this.currentMessage()&&this.currentMessage().folder()===t&&this.currentMessage().uid()===i&&this.currentMessage(null),s.markDeletedByUids([i]),s.commitDeleted([i]))},M.prototype.startMessagesLoadingWhenDraftSaving=function(e,t){var i=this.getFolderByFullName(e,t);i&&i.type()===Enums.FolderTypes.Drafts&&i.selected()&&this.messagesLoading(!0)},M.prototype.removeMessagesFromCacheForFolder=function(e,t){var i=this.getFolderByFullName(e,t),s=this.getCurrentFolderFullname();i&&(i.markHasChanges(),this.currentAccountId()===e&&t===s&&this.requestCurrentMessageList(s,this.page(),this.uidList().search(),"",this.uidList().sortBy(),this.uidList().sortOrder(),!0))},M.prototype.deleteMessages=function(e){var t=this.getCurrentFolder();t&&this.deleteMessagesFromFolder(t,e)},M.prototype.deleteMessagesFromFolder=function(e,t){var i={AccountID:e.iAccountId,Folder:e.fullName(),Uids:t.join(",")};e.markDeletedByUids(t),this.excludeDeletedMessages(),E.send("DeleteMessages",i,this.onMoveMessagesResponse,this)},M.prototype.showExternalPictures=function(e){var t=this.currentMessage(),i=t?t.oFrom.aCollection:[],s=t?this.getFolderByFullName(t.accountId(),t.folder()):null;s&&(e&&i.length>0?s.alwaysShowExternalPicturesForSender(i[0].sEmail):s.showExternalPictures(t.uid()))},M.prototype.setCurrentFolder=function(e,t){y.unifiedInboxAllowed()||e!==this.oUnifiedInbox.fullName()||(e=this.folderList().inboxFolderFullName()),this.oUnifiedInbox.selected(e===this.oUnifiedInbox.fullName()),this.folderList().setCurrentFolder(e,t)},M.prototype.getMessageUid=function(e){return this.oUnifiedInbox.selected()?e.unifiedUid():e.uid()},M.prototype.setCurrentMessage=function(e,t,i){var s=this.getFolderByFullName(e,t),n=null;s&&i&&s.fullName()===t&&(n=S.get([s.iAccountId,s.fullName(),i])),n&&!n.deleted()?(this.currentMessage(n),I.MarkMessageSeenWhenViewing&&!this.currentMessage().seen()&&this.executeGroupOperation("SetMessagesSeen",[this.getMessageUid(this.currentMessage())],"seen",!0),s.getCompletelyFilledMessage(i,this.onCurrentMessageResponse,this)):(this.currentMessage(null),c.isNewTab()&&s&&s.getCompletelyFilledMessage(i,this.onCurrentMessageResponse,this))},M.prototype.onCurrentMessageResponse=function(e,t,i){var s=this.currentMessage()&&this.currentMessage().uid?this.currentMessage().uid():"";null===e&&L&&i&&u.showErrorByCode(i,"",!0),null===e&&s===t?this.currentMessage(null):e&&s===t?this.currentMessage.valueHasMutated():c.isNewTab()&&e&&null===this.currentMessage()&&this.currentMessage(e)},M.prototype.getMessage=function(e,t,i,s,n){var o=this.getFolderByFullName(e,t);o&&o.getCompletelyFilledMessage(i,s,n)},M.prototype.setUnifiedInboxUnseenChanges=function(e,t,i,s){if(y.unifiedInboxReady()){var n=this.oUnifiedInbox.getUnifiedInbox(e);n&&n.fullName()===t&&(this.oUnifiedInbox.addMessagesCountsDiff(i,s),this.oUnifiedInbox.markHasChanges())}},M.prototype.getUidsSeparatedByAccounts=function(e){var t={};return s.each(e,(function(e){var i=e.split(":"),s=l.pInt(i[0]),n=l.pString(i[1]);""!==n&&(t[s]||(t[s]={AccountId:s,Uids:[]}),t[s].Uids.push(n))})),t},M.prototype.executeGroupOperation=function(e,t,i,n){if(this.oUnifiedInbox.selected()&&t.length>0){var o=this.getUidsSeparatedByAccounts(t);s.each(o,(function(t){var s=t.Uids,o=t.AccountId,r=this.oUnifiedInbox.getUnifiedInbox(o);r&&this.executeGroupOperationForFolder(e,r,s,i,n)}),this)}else if(this.oUnifiedInbox.selected()&&0===t.length)s.each(y.unifiedMailboxAccounts(),(function(s){var o=this.oUnifiedInbox.getUnifiedInbox(s.id());o&&this.executeGroupOperationForFolder(e,o,t,i,n)}),this);else{var r=this.getCurrentFolder();r&&this.executeGroupOperationForFolder(e,r,t,i,n)}},M.prototype.executeGroupOperationForFolder=function(e,t,i,s,n){var o=t.iAccountId,r=this.oFolderListItems[o],a={AccountID:o,Folder:t.fullName(),Uids:i.join(","),SetAction:n},l=(this.page()-1)*I.MailsPerPage,h=i.length,u=r.oStarredFolder?r.oStarredFolder.messageCount():0,c=t.getUidList("",Enums.FolderFilter.Flagged,I.MessagesSortBy.DefaultSortBy,I.MessagesSortBy.DefaultSortOrder),d="SetMessagesSeen"===e?this.onSetMessagesSeenResponse:function(){};"SetMessagesSeen"===e&&this.iSetMessagesSeenCount++,E.send(e,a,d,this),t.executeGroupOperation(s,i,n),t.type()===Enums.FolderTypes.Inbox&&"flagged"===s&&(this.uidList().filters()===Enums.FolderFilter.Flagged?n||(this.uidList().deleteUids(i),r.oStarredFolder&&r.oStarredFolder.messageCount(c.resultCount())):(t.removeFlaggedMessageListsFromCache(),""===this.uidList().search()&&r.oStarredFolder&&(n?r.oStarredFolder.messageCount(u+h):r.oStarredFolder.messageCount(u-h>0?u-h:0)))),"seen"===s&&t.removeUnseenMessageListsFromCache(),(this.uidList().filters()!==Enums.FolderFilter.Unseen||this.waitForUnseenMessages())&&this.setMessagesFromUidList(this.uidList(),l,!0)},M.prototype.onSetMessagesSeenResponse=function(e,t){this.iSetMessagesSeenCount--,this.iSetMessagesSeenCount<0&&(this.iSetMessagesSeenCount=0),this.getCurrentFolder()&&0===this.iSetMessagesSeenCount&&(this.uidList().filters()!==Enums.FolderFilter.Unseen||this.waitForUnseenMessages())&&this.requestCurrentMessageList(this.getCurrentFolder().fullName(),this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),!1)},M.prototype.onGetFoldersResponse=function(e,t){var i=t.Parameters,n=new C,o=i.AccountID,r=this.oFolderListItems[o],a=r?r.oNamedCollection:{};!1===e.Result?(u.showErrorByCode(e),i.AccountID===this.currentAccountId()&&0===this.messages().length&&(this.messagesLoading(!1),this.messagesLoadingError(!0))):(n.parse(o,e.Result,a),r&&n.oStarredFolder.messageCount(r.oStarredFolder.messageCount()),this.__oldFolderList=this.oFolderListItems[o],this.oFolderListItems[o]=n,this.__oldFolderList&&(this.__oldFolderList.destroyFolders(),h.destroyObjectWithObservables(this,"__oldFolderList")),this.currentAccountId()===o&&this.folderList(n),this.editedAccountId()===o&&this.editedFolderList(n),this.requirePrefetcher(),A.prefetchFolderLists()||setTimeout(s.bind(this.getAllFoldersRelevantInformation,this,o),2e3)),this.folderListLoading.remove(o)},M.prototype.getAllFoldersRelevantInformation=function(e){if(y.unifiedInboxReady()){var t=[];s.each(y.collection(),(function(s){var n=[];s.id()===e?n=i?i.getFoldersWithoutCountInfo():[]:s.includeInUnifiedMailbox()&&(n=this.getNamesOfFoldersToRefresh(e)),n.length>0&&t.push({AccountID:s.id(),Folders:n,UseListStatusIfPossible:this.getUseListStatusIfPossibleValue(s.id(),n.length)})}),this),t.length>0&&(o={AccountsData:t},E.send("GetUnifiedRelevantFoldersInformation",o,this.onGetRelevantFoldersInformationResponse,this))}else{var i=this.oFolderListItems[e],n=i?i.getFoldersWithoutCountInfo():[],o={AccountID:e,Folders:n,UseListStatusIfPossible:this.getUseListStatusIfPossibleValue(e,n.length)};n.length>0&&E.send("GetRelevantFoldersInformation",o,this.onGetRelevantFoldersInformationResponse,this)}},M.prototype.onGetRelevantFoldersInformationResponse=function(e,t){var i=!1,n=t.Parameters.AccountID,o=e.Result;if(!1===o)u.showErrorByCode(e),(E.hasOpenedRequests("GetRelevantFoldersInformation")||E.hasOpenedRequests("GetUnifiedRelevantFoldersInformation"))&&(i=!0);else if(o.Unified&&o.Accounts){s.each(o.Accounts,(function(e){this.onGetRelevantFoldersInformationResponseForAccount(e.AccountId,e.Counts)}),this);var r=this.oUnifiedInbox.selected(),a=o.Unified,l=a[0],h=a[1],c=a[2],d=a[3],p=this.oUnifiedInbox.setRelevantInformation(c,d,l,h,r);r&&p&&this.uidList().filters()!==Enums.FolderFilter.Unseen&&(this.requestCurrentMessageList(this.getCurrentFolder().fullName(),this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),!1),i=!0)}else o.Counts&&(i=i||this.onGetRelevantFoldersInformationResponseForAccount(n,o.Counts));this.checkMailStarted(i),this.checkMailStarted()||this.setAutocheckmailTimer()},M.prototype.onGetRelevantFoldersInformationResponseForAccount=function(e,t){var i=!1,n=this.oFolderListItems[e],o=this.currentAccountId()===e,r=this.getCurrentFolderFullname();return n&&(s.each(t,(function(t,n){if(s.isArray(t)&&t.length>3){var a=t[0],l=t[1],h=t[2],u=t[3],c=!1,d=!1,p=null;(p=this.getFolderByFullName(e,n))&&(d=o&&p.fullName()===r,c=p.setRelevantInformation(h,u,a,l,d),d&&c&&this.uidList().filters()!==Enums.FolderFilter.Unseen&&(this.requestCurrentMessageList(p.fullName(),this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),!1),i=!0))}}),this),n.countsCompletelyFilled(!0)),i},M.prototype.showNotificationsForNewMessages=function(e){var t=this.getCurrentFolderFullname(),i=0,n="",o={},r="",u=[];if(e.Result.New&&e.Result.New.length>0){i=e.Result.New.length,n=e.Result.New[0].Uid;var c=e.Result.New[0].AccountId;t===this.oUnifiedInbox.fullName()&&(n=c+":"+n),o={action:"show",icon:"static/styles/images/logo_140x140.png",title:a.i18n("MAILWEBCLIENT/INFO_NEW_MESSAGES_PLURAL",{COUNT:i},null,i),timeout:5e3,callback:function(){window.focus(),p.setHash(v.getMailbox(t,1,n,"",""))}},1===i&&(l.isNonEmptyString(e.Result.New[0].Subject)&&u.push(a.i18n("MAILWEBCLIENT/LABEL_SUBJECT")+": "+e.Result.New[0].Subject),r=s.map(e.Result.New[0].From,(function(e){return""!==e.DisplayName?e.DisplayName:e.Email})).join(", "),l.isNonEmptyString(r)&&u.push(a.i18n("MAILWEBCLIENT/LABEL_FROM")+": "+r),o.body=u.join("\r\n")),h.desktopNotify(o)}},M.prototype.onCurrentGetMessagesResponse=function(e,t){this.checkMailStarted(!1),e.Result?(this.messagesLoadingError(!1),this.parseMessageList(e,t)):(h.log("onCurrentGetMessagesResponse, error ",JSON.stringify(t).substr(0,300),JSON.stringify(e).substr(0,300)),u.showErrorByCode(e),!0!==this.messagesLoading()||0!==this.messages().length&&e.ErrorCode===Enums.Errors.NotDisplayedError||this.messagesLoadingError(!0),this.messagesLoading(!1),this.setAutocheckmailTimer())},M.prototype.onGetMessagesResponse=function(e,t){e&&e.Result?this.parseMessageList(e,t):h.log("onGetMessagesResponse, error ",JSON.stringify(t).substr(0,300),JSON.stringify(e).substr(0,300))},M.prototype.parseAndCacheMessages=function(e,t,i,n){if(t.fullName()===this.oUnifiedInbox.fullName()){var o={},r=null;s.each(e,(function(e){var t=e.UnifiedUid.split(":"),s=l.pInt(t[0]);if(!(r=o[s])){var a=this.oFolderListItems[s];r=a?a.inboxFolder():null}if(r){var h=r.parseAndCacheMessage(e,!1,i);n.push(h)}}),this)}else s.each(e,(function(e){var s=t.parseAndCacheMessage(e,!1,i);n.push(s)}),this)},M.prototype.parseMessageList=function(e,t){t.Parameters&&!l.isNonEmptyString(t.Parameters.Folder)&&(t.Parameters.Folder=this.oUnifiedInbox.fullName());var i=e.Result,s=t.Parameters,n=s.AccountID,o=null,r=null,a=s.UseThreading,h=!1,u=(this.currentAccountId()===n||s.Folder===this.oUnifiedInbox.fullName())&&this.getCurrentFolderFullname()===s.Folder,c=u&&this.uidList().search()===i.Search&&this.uidList().filters()===i.Filters&&this.uidList().sortBy()===s.SortBy&&this.uidList().sortOrder()===s.SortOrder,d=this.page()===s.Offset/I.MailsPerPage+1;this.showNotificationsForNewMessages(e),!1!==i&&"Collection/MessageCollection"===i["@Object"]&&((o=this.getFolderByFullName(n,s.Folder)).setRelevantInformation(i.UidNext.toString(),i.FolderHash,i.MessageCount,i.MessageUnseenCount,u&&!c),h=o.hasChanges(),o.removeAllMessageListsFromCacheIfHasChanges(),(r=o.getUidList(i.Search,i.Filters,s.SortBy,s.SortOrder)).setUidsAndCount(s.Offset,i),this.parseAndCacheMessages(i["@Collection"],o,a,[]),c&&(this.uidList(r),d&&(r.filters()!==Enums.FolderFilter.Unseen||this.waitForUnseenMessages())&&(this.messagesLoading(!1),this.waitForUnseenMessages(!1),this.setMessagesFromUidList(r,s.Offset,!0),this.messagesLoading()||this.setAutocheckmailTimer())),!h||!u||c&&d||this.uidList().filters()===Enums.FolderFilter.Unseen||this.requestCurrentMessageList(this.getCurrentFolderFullname(),this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),!1),o.type()===Enums.FolderTypes.Inbox&&r.filters()===Enums.FolderFilter.Flagged&&""===r.search()&&this.folderList().oStarredFolder&&(this.folderList().oStarredFolder.messageCount(r.resultCount()),this.folderList().oStarredFolder.hasExtendedInfo(!0)))},M.prototype.increaseStarredCount=function(){this.folderList().oStarredFolder&&this.folderList().oStarredFolder.increaseCountIfHasNotInfo()},M.prototype.removeMessageFromCurrentList=function(e,t,i){var n=this.getFolderByFullName(e,t);(n?n.getMessageByUid(i):null)&&(this.messages(s.filter(this.messages(),(function(e){return e.uid()!==i}))),p.replaceHashWithoutMessageUid(i),n.markHasChanges())},M.prototype.onMoveMessagesResponse=function(e,t){var i=e.Result,n=t.Parameters,o=n.Uids.split(","),r=this.getFolderByFullName(n.AccountID,n.Folder),h=this.getFolderByFullName(n.AccountID,n.ToFolder),c=h&&h.type()===Enums.FolderTypes.Trash,d=h&&h.type()===Enums.FolderTypes.Spam,m=null,g=c?a.i18n("MAILWEBCLIENT/CONFIRM_MESSAGES_DELETE_WITHOUT_TRASH"):a.i18n("MAILWEBCLIENT/CONFIRM_MESSAGES_MARK_SPAM_WITHOUT_SPAM"),v=s.bind((function(e){e&&r&&this.deleteMessagesFromFolder(r,o)}),this),y=this.getCurrentFolder(),E=y?y.fullName():"",S=!1;if(!1===i?(r&&(m=r.revertDeleted(o)),h?(m&&h.addMessagesCountsDiff(-m.PlusDiff,-m.UnseenPlusDiff),e.ErrorCode===Enums.MailErrors.CannotMoveMessageQuota&&(c||d)?(l.isNonEmptyString(e.ErrorMessage)&&(g+=" ("+e.ErrorMessage+")"),f.showPopup(b,[g,v])):u.showErrorByCode(e,a.i18n("MAILWEBCLIENT/ERROR_MOVING_MESSAGES"))):u.showErrorByCode(e,a.i18n("MAILWEBCLIENT/ERROR_DELETING_MESSAGES")),S=!0):r&&(this.messages(s.filter(this.messages(),(function(e){return-1===s.indexOf(o,e&&e.uid&&e.uid())}))),r.commitDeleted(o),s.each(o,(function(e){p.replaceHashWithoutMessageUid(e)}))),r&&E===r.fullName()||h&&E===h.fullName()||y.bIsUnifiedInbox&&(r&&r.type()===Enums.FolderTypes.Inbox||h&&h.type()===Enums.FolderTypes.Inbox))switch(y.markHasChanges(),this.uidList().filters()){case Enums.FolderFilter.Flagged:break;case Enums.FolderFilter.Unseen:this.waitForUnseenMessages()&&this.requestCurrentMessageList(E,this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),S);break;default:this.requestCurrentMessageList(E,this.page(),this.uidList().search(),this.uidList().filters(),this.uidList().sortBy(),this.uidList().sortOrder(),S)}else r&&E!==r.fullName()?(this.requirePrefetcher(),A.startFolderPrefetch(r)):h&&E!==h.fullName()&&(this.requirePrefetcher(),A.startFolderPrefetch(h))},M.prototype.onCopyMessagesResponse=function(e,t){var i=e.Result,s=t.Parameters,n=this.getFolderByFullName(s.AccountID,s.Folder),o=this.getFolderByFullName(s.AccountID,s.ToFolder),r=this.getCurrentFolder(),l=r.fullName();!1===i&&u.showErrorByCode(e,a.i18n("MAILWEBCLIENT/ERROR_COPYING_MESSAGES")),l===n.fullName()||o&&l===o.fullName()?(r.markHasChanges(),this.requestCurrentMessageList(l,this.page(),this.uidList().search(),"",this.uidList().sortBy(),this.uidList().sortOrder(),!1)):l!==n.fullName()?(this.requirePrefetcher(),A.startFolderPrefetch(n)):o&&l!==o.fullName()&&(this.requirePrefetcher(),A.startFolderPrefetch(o))},M.prototype.searchMessagesInCurrentFolder=function(e){var t=this.getCurrentFolderFullname()||"INBOX",i=this.currentMessage()?this.currentMessage().uid():"",s=this.uidList().filters();p.setHash(v.getMailbox(t,1,i,e,s))},M.prototype.searchMessagesInInbox=function(e){p.setHash(v.getMailbox(this.folderList().inboxFolderFullName()||"INBOX",1,"",e,""))},M.prototype.getFolderHash=function(e){return p.buildHashFromArray(v.getMailbox(e,1,"","",""))},M.prototype.countMessages=function(e){var t=[],i=function(e){s.each(e.subfolders(),(function(e,s){e.subscribed()&&(t.push(e.unseenMessageCount()),e.subfolders().length&&e.subscribed()&&i(e))}),this)};e.expanded()||e.bNamespace?e.subfoldersMessagesCount(0):(i(e),e.subfoldersMessagesCount(s.reduce(t,(function(e,t){return e+t}),0)))},M.prototype.changeDatesInMessages=function(){S.updateMomentDates()},M.prototype.clearMessagesCache=function(e){var t=this.oFolderListItems[e];s.each(t.collection(),(function(e){e.markHasChanges(),e.removeAllMessageListsFromCacheIfHasChanges()}),this),e===this.currentAccountId()&&this.messages([])},M.prototype.getTemplateFolder=function(){var e=this.folderList(),t="",i=e.currentFolder()?e.currentFolder().fullName():"";return l.isNonEmptyArray(this.getCurrentTemplateFolders())&&(t=-1!==n.inArray(i,this.getCurrentTemplateFolders())?i:s.find(this.getCurrentTemplateFolders(),(function(t){return!!e.oNamedCollection[t]}))),"string"==typeof t?t:""},M.prototype.getCurrentTemplateFolders=function(){return I.AllowTemplateFolders?this.folderList().aTemplateFolders:[]},M.prototype.changeTemplateFolder=function(e,t){I.AllowTemplateFolders&&this.folderList().changeTemplateFolder(e,t)};var w=new M;d.registerDayOfMonthFunction(s.bind(w.changeDatesInMessages,w)),m.timeFormat.subscribe(w.changeDatesInMessages,w),m.dateFormat.subscribe(w.changeDatesInMessages,w),e.exports=w},"4M/5":function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV"),o=(i("QaF5"),null),r=i("p2hp"),a={};function l(e){return"p"===e.substr(0,1)&&/^[1-9][\d]*$/.test(e.substr(1))}function h(e){return"s"===e.substr(0,1)&&/^[1-9][\d]*$/.test(e.substr(1))}a.getMailbox=function(e,t,s,o,a,l,h,u){var c=i("jonm").getCurrent(),d=[r.HashModuleName,c?c.hash():""];return t=n.pInt(t,1),s=n.pString(s),o=n.pString(o),a=n.pString(a),l=n.pString(l,r.MessagesSortBy.DefaultSortBy),h=n.pInt(h,r.MessagesSortBy.DefaultSortOrder),u=n.pString(u),n.isNonEmptyString(e)&&d.push(e),""!==a&&d.push("filter:"+a),""!==l&&r.MessagesSortBy.DefaultSortBy!==l&&d.push("sortby:"+l),r.MessagesSortBy.DefaultSortOrder!==h&&d.push("sortorder:"+h),1<t&&d.push("p"+t),""!==s&&d.push("msg"+s),""!==o&&d.push(o),""!==u&&d.push("custom:"+u),d},a.requireMailCache=function(){null===o&&(o=i("4+IO"))},a.parseMailbox=function(e){this.requireMailCache();var t=e.length>0&&"compose"===e[0]&&"to"===e[1],i=t?[]:e,a="",h="",u=o.folderList().inboxFolderFullName()||"INBOX",c=1,d="",p="",m="",g=r.MessagesSortBy.DefaultSortBy,f=r.MessagesSortBy.DefaultSortOrder,b="",v="",y=0;return n.isNonEmptyArray(i)&&(a=n.pString(i[y]),y++),n.isNonEmptyArray(i)&&(h=n.pString(i[y]),y++,i.length>y&&((v=n.pString(i[y]))==="filter:"+Enums.FolderFilter.Flagged&&(m=Enums.FolderFilter.Flagged,y++),v==="filter:"+Enums.FolderFilter.Unseen&&(m=Enums.FolderFilter.Unseen,y++)),i.length>y&&"sortby:"===(v=n.pString(i[y])).substr(0,7)&&(r.MessagesSortBy.Allow&&(g=v.substr(7)),y++),i.length>y&&"sortorder:"===(v=n.pString(i[y])).substr(0,10)&&(r.MessagesSortBy.Allow&&(f=n.pEnum(n.pInt(v.substr(10)),Enums.SortOrder,r.MessagesSortBy.DefaultSortOrder)),y++),s.find(r.MessagesSortBy.List,(function(e){return e.SortBy===g}))||(g=r.MessagesSortBy.DefaultSortBy,f=r.MessagesSortBy.DefaultSortOrder),i.length>y&&l(v=n.pString(i[y]))&&((c=n.pInt(v.substr(1)))<=0&&(c=1),y++),i.length>y&&function(e){return"msg"===e.substr(0,3)&&/^[1-9][\d:]*$/.test(e.substr(3))}(v=n.pString(i[y]))&&(d=v.substr(3),y++),i.length>y&&"custom:"!==(v=n.pString(i[y])).substr(0,7)&&(p=v,y++),i.length>y&&"custom:"===(v=n.pString(i[y])).substr(0,7)&&(b=v.substr(7))),{MailtoCompose:t,AccountHash:a,Folder:""===h?u:h,Page:c,Uid:d,Search:p,Filters:m,SortBy:g,SortOrder:f,Custom:b}},a.getViewMessage=function(e,t,s){var n=i("jonm").getAccount(e),o=n?n.hash():"";return[r.HashModuleName+"-view",o,t,"msg"+s]},a.getCompose=function(){var e=i("jonm").getCurrent(),t=e?e.hash():"";return[r.HashModuleName+"-compose",t]},a.getComposeFromMessage=function(e,t,s,n){var o=i("jonm").getAccount(t),a=o?o.hash():"";return[r.HashModuleName+"-compose",a,e,s,n]},a.getComposeWithToField=function(e){var t=i("jonm").getCurrent(),s=t?t.hash():"";return[r.HashModuleName+"-compose",s,"to",e]},a.getComposeWithData=function(e){var t=i("jonm").getCurrent(),s=t?t.hash():"";return[r.HashModuleName+"-compose",s,"data",e]},a.getComposeWithObject=function(e,t){var s=i("jonm").getCurrent(),n=s?s.hash():"";return[r.HashModuleName+"-compose",n,e,t]},a.getComposeWithEmlObject=function(e,t,s,n){var o=i("jonm").getAccount(e),a=o?o.hash():"";return[r.HashModuleName+"-compose",a,Enums.ReplyType.ForwardAsAttach,t,s,n]},a.parseCompose=function(e){var t=e.length>0?e[0]:"",i=e.length>1?e[1]:"",s=(i===Enums.ReplyType.ForwardAsAttach||"attachments"===i||"data"===i)&&e.length>2?i===Enums.ReplyType.ForwardAsAttach?e[4]:e[2]:null,n="to"===i&&e.length>2?a.parseToAddr(e[2]):null,o=(i===Enums.ReplyType.Reply||i===Enums.ReplyType.ReplyAll||i===Enums.ReplyType.Resend||i===Enums.ReplyType.Forward||"drafts"===i||i===Enums.ReplyType.ForwardAsAttach)&&e.length>2;return{AccountHash:t,RouteType:i,ToAddr:n,Object:s,MessageFolderName:o?e[2]:"",MessageUid:o?e[3]:""}},a.parseToAddr=function(e){var t=n.pString(e),i=-1!==t.indexOf("mailto:"),o=[],r=[],a="",l="",h="",u="";return i&&(o=t.replace(/^mailto:/,"").split("?"),t=o[0],2===o.length&&(r=o[1].split("&"),s.each(r,(function(e){var t=e.split("=");if(2===t.length)switch(t[0].toLowerCase()){case"subject":a=decodeURIComponent(t[1]);break;case"cc":l=decodeURIComponent(t[1]);break;case"bcc":h=decodeURIComponent(t[1]);break;case"body":u=decodeURIComponent(t[1])}})))),{to:t,hasMailto:i,subject:a,cc:l,bcc:h,body:u}},a.parseMailServers=function(e){var t=0,i="",s=1,o="",r=!1,a=0;return n.isNonEmptyArray(e)&&(e.length>t&&l(i=n.pString(e[t]))&&((s=n.pInt(i.substr(1)))<=0&&(s=1),t++),e.length>t&&(h(i=n.pString(e[t]))||"create"===i||(o=i,t++)),e.length>t&&h(i=n.pString(e[t]))&&((a=n.pInt(i.substr(1),a))<=0&&(a=1),t++),e.length>t&&(r="create"===(i=n.pString(e[t])))),{Page:s,Search:o,Create:r,EditServerId:a}},e.exports=a},"4iw0":function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV"),o=i("hPb3"),r=i("yYIs");function a(){r.call(this,o.ServerModuleName),this.sVersion=n.pString(o.Version),this.sProductName=n.pString(o.ProductName)}s.extendOwn(a.prototype,r.prototype),a.prototype.ViewTemplate="AdminPanelWebclient_AboutAdminSettingsView",a.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new a},"5H03":function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("czxF");function r(){o.call(this),this.fConfirmCallback=null,this.shown=!1}s.extendOwn(r.prototype,o.prototype),r.prototype.PopupTemplate="MailWebclient_ConfirmAnotherMessageComposedPopup",r.prototype.onOpen=function(e){this.fConfirmCallback=n.isFunction(e)?e:null,this.shown=!0},r.prototype.onClose=function(){this.shown=!1},r.prototype.onDiscardClick=function(){this.shown&&this.fConfirmCallback&&this.fConfirmCallback(Enums.AnotherMessageComposedAnswer.Discard),this.closePopup()},r.prototype.onSaveAsDraftClick=function(){this.shown&&this.fConfirmCallback&&this.fConfirmCallback(Enums.AnotherMessageComposedAnswer.SaveAsDraft),this.closePopup()},r.prototype.cancelPopup=function(){this.fConfirmCallback&&this.fConfirmCallback(Enums.AnotherMessageComposedAnswer.Cancel),this.closePopup()},r.prototype.onEnterHandler=function(){this.onSaveAsDraftClick()},e.exports=new r},"5aTH":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("Yjhd"),a=i("gcBV"),l=null,h=i("p2hp"),u=i("qGK3");function c(){this.iAccountId=0,this.initialized=n.observable(!1),this.bExpandFolders=!1,this.expandNames=n.observableArray([]),this.collection=n.observableArray([]),this.options=n.observableArray([]),this.sNamespaceFolder="",this.oStarredFolder=null,this.oNamedCollection={},this.aLinedCollection=[];var e=this,t=function(e){return function(t){t&&t.type(e)}},i=function(t){return{read:function(){return this.collection(),t()?t().fullName():""},write:function(e){t(this.getFolderByFullName(e))},owner:e}};this.currentFolder=n.observable(null),this.inboxFolder=n.observable(null),this.sentFolder=n.observable(null),this.draftsFolder=n.observable(null),this.spamFolder=n.observable(null),this.trashFolder=n.observable(null),this.aTemplateFolders=[],this.countsCompletelyFilled=n.observable(!1),this.inboxFolder.subscribe(t(Enums.FolderTypes.User),this,"beforeChange"),this.sentFolder.subscribe(t(Enums.FolderTypes.User),this,"beforeChange"),this.draftsFolder.subscribe(t(Enums.FolderTypes.User),this,"beforeChange"),this.spamFolder.subscribe(t(Enums.FolderTypes.User),this,"beforeChange"),this.trashFolder.subscribe(t(Enums.FolderTypes.User),this,"beforeChange"),this.inboxFolder.subscribe(t(Enums.FolderTypes.Inbox)),this.sentFolder.subscribe(t(Enums.FolderTypes.Sent)),this.draftsFolder.subscribe(t(Enums.FolderTypes.Drafts)),this.spamFolder.subscribe(t(Enums.FolderTypes.Spam)),this.trashFolder.subscribe(t(Enums.FolderTypes.Trash)),this.inboxFolderFullName=n.computed(i(this.inboxFolder)),this.sentFolderFullName=n.computed(i(this.sentFolder)),this.draftsFolderFullName=n.computed(i(this.draftsFolder)),this.spamFolderFullName=n.computed(i(this.spamFolder)),this.trashFolderFullName=n.computed(i(this.trashFolder)),this.currentFolderFullName=n.computed(i(this.currentFolder)),this.currentFolderType=n.computed((function(){return this.currentFolder()?this.currentFolder().type():Enums.FolderTypes.User}),this),this.sDelimiter=""}c.prototype.requireMailCache=function(){null===l&&(l=i("4+IO"))},c.prototype.getFoldersCount=function(){return this.aLinedCollection.length},c.prototype.getTotalMessageCount=function(){var e=0;return s.each(this.oNamedCollection,(function(t){e+=t.messageCount()}),this),e},c.prototype.getFoldersWithoutCountInfo=function(){return s.compact(s.map(this.oNamedCollection,(function(e,t){return e.canBeSelected()&&!e.hasExtendedInfo()?t:null})))},c.prototype.getNamesOfFoldersToRefresh=function(){var e=[this.inboxFolderFullName(),this.spamFolderFullName(),this.currentFolderFullName()];return s.each(this.oNamedCollection,(function(t){t.isAlwaysRefresh()&&e.push(t.fullName())})),s.uniq(e)},c.prototype.setCurrentFolder=function(e,t){this.requireMailCache();var i=this.getFolderByFullName(e);null!==i&&i.canBeSelected()||(i=this.inboxFolder()),null!==i&&(this.currentFolder()&&(this.currentFolder().selected(!1),this.oStarredFolder&&this.oStarredFolder.selected(!1)),e===l.oUnifiedInbox.fullName()?this.currentFolder(null):(this.currentFolder(i),t===Enums.FolderFilter.Flagged?this.oStarredFolder&&this.oStarredFolder.selected(!0):this.currentFolder().selected(!0)))},c.prototype.getFolderByFullName=function(e){var t=this.oNamedCollection[e];return t||null},c.prototype.renameFolder=function(e,t,i){var s=this.oNamedCollection[e];s.fullName(t),s.fullNameHash(i),this.oNamedCollection[t]=s,delete this.oNamedCollection[e]},c.prototype.changeTemplateFolder=function(e,t){h.AllowTemplateFolders&&(t?this.aTemplateFolders.push(e):this.aTemplateFolders=s.without(this.aTemplateFolders,e))},c.prototype.parse=function(e,t,i){var s=o.pString(t.Namespace),n=t.Folders["@Collection"];s.length>0&&(this.sNamespaceFolder=s.substring(0,s.length-1)),this.iAccountId=e,this.initialized(!0),this.bExpandFolders=h.FoldersExpandedByDefault&&!a.hasData("folderAccordion"),a.hasData("folderAccordion")||a.setData("folderAccordion",[]),this.oNamedCollection={},this.aLinedCollection=[],this.collection(this.parseRecursively(n,i))},c.prototype.destroyFolders=function(){for(var e in r.destroyObjectWithObservables(this,"oStarredFolder"),this.collection.removeAll(),this.aLinedCollection=[],this.oNamedCollection)r.destroyObjectWithObservables(this.oNamedCollection,e)},c.prototype.parseRecursively=function(e,t,i,n){var r=[],l=0,h=0,c=null,d="",p=null,m=[];if(n=n||"",void 0===i&&(i=-1),i++,s.isArray(e)){for(h=e.length;l<h;l++){switch(p=(c=t[d=o.pString(e[l].FullNameRaw)]||new u(this.iAccountId)).parse(e[l],n,this.sNamespaceFolder),delete t[d],this.bExpandFolders&&null!==p&&(c.expanded(!0),this.expandNames().push(o.pString(e[l].Name))),c.setDisplayedLevel(i),c.type()){case Enums.FolderTypes.Inbox:this.inboxFolder(c),this.sDelimiter=c.sDelimiter;break;case Enums.FolderTypes.Sent:this.sentFolder(c);break;case Enums.FolderTypes.Drafts:this.draftsFolder(c);break;case Enums.FolderTypes.Trash:this.trashFolder(c);break;case Enums.FolderTypes.Spam:this.spamFolder(c);break;case Enums.FolderTypes.Template:this.aTemplateFolders.push(c.fullName())}this.oNamedCollection[c.fullName()]=c,this.aLinedCollection.push(c),r.push(c),null===p&&c.type()===Enums.FolderTypes.Inbox?(this.createStarredFolder(c.fullName(),i),this.oStarredFolder&&r.push(this.oStarredFolder)):null!==p&&(m=c.bNamespace&&c.type()===Enums.FolderTypes.Inbox?this.parseRecursively(p["@Collection"],t,i-1,c.fullName()):this.parseRecursively(p["@Collection"],t,i,c.fullName()),c.type()===Enums.FolderTypes.Inbox&&(this.createStarredFolder(c.fullName(),i),c.bNamespace?this.oStarredFolder&&m.unshift(this.oStarredFolder):this.oStarredFolder&&r.push(this.oStarredFolder)),c.subfolders(m))}this.bExpandFolders&&a.setData("folderAccordion",this.expandNames())}return r},c.prototype.createStarredFolder=function(e,t){this.oStarredFolder=new u(this.iAccountId),this.oStarredFolder.initStarredFolder(t,e)},c.prototype.repopulateLinedCollection=function(){var e=this;return this.aLinedCollection=[],function t(i){s.each(i,(function(i){e.aLinedCollection.push(i),i.subfolders().length>0&&t(i.subfolders())}))}(this.collection()),this.aLinedCollection},c.prototype.getOptions=function(e,t,i,n,o){t=!!t,i=!!i,n=!!n,o=!!o;var r=[];return s.each(this.aLinedCollection,(function(e){if(e&&!e.bVirtual&&(!i||Enums.FolderTypes.Inbox!==e.type())&&(!o||e.subscribed())){var s=new Array(e.getDisplayedLevel()+1).join("    ");r.push({name:e.name(),fullName:e.fullName(),displayName:s+e.name(),translatedDisplayName:s+e.displayName(),disable:!t&&e.isSystem()||!n&&!e.canBeSelected()})}})),""!==e&&r.unshift({name:e,fullName:"",displayName:e,translatedDisplayName:e,disable:!1}),r},e.exports=c},"5hOJ":function(e,t,i){"use strict";var s=i("wd/R"),n=i("RN+F"),o=i("Yjhd"),r=i("hPb3");function a(){this.iTimeStampInUTC=0,this.oMoment=null}a.prototype.parse=function(e){this.iTimeStampInUTC=e,this.oMoment=s.unix(this.iTimeStampInUTC)},a.prototype.setDate=function(e,t,i){this.oMoment=s([e,t,i])},a.prototype.getTimeFormat=function(){return r.timeFormat()===window.Enums.TimeFormat.F24?"HH:mm":"hh:mm A"},a.prototype.getFullDate=function(){return this.getDate()+" "+this.getTime()},a.prototype.getMidDate=function(){return this.getShortDate(!0)},a.prototype.getShortDate=function(e){var t="",i=null;return this.oMoment&&((i=s()).format("L")===this.oMoment.format("L")?t=this.oMoment.format(this.getTimeFormat()):(t=i.clone().subtract(1,"days").format("L")===this.oMoment.format("L")?n.i18n("COREWEBCLIENT/LABEL_YESTERDAY"):r.UserSelectsDateFormat?this.oMoment.format(o.getDateFormatForMoment(r.dateFormat())):i.year()===this.oMoment.year()?this.oMoment.format("MMM D"):this.oMoment.format("MMM D, YYYY"),e&&(t+=", "+this.oMoment.format(this.getTimeFormat())))),t},a.prototype.getDate=function(){var e="ddd, MMM D, YYYY";return r.UserSelectsDateFormat&&(e="ddd, "+o.getDateFormatForMoment(r.dateFormat())),this.oMoment?this.oMoment.format(e):""},a.prototype.getTime=function(){return this.oMoment?this.oMoment.format(this.getTimeFormat()):""},a.prototype.getTimeStampInUTC=function(){return this.iTimeStampInUTC},e.exports=a},"61ci":function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("AFLV"),l=i("ZP6a");e.exports={ServerModuleName:"Core",HashModuleName:"admin",EntitiesPerPage:20,TabsOrder:["licensing","admin-security","admin-db","logs-viewer","system","common","modules"],EntitiesOrder:[],EnableMultiTenant:!1,startError:o.observable(""),init:function(e){var t=e.AdminPanelWebclient,i=e.Core;s.isEmpty(t)||(this.EntitiesPerPage=a.pPositiveInt(t.EntitiesPerPage,this.EntitiesPerPage),this.TabsOrder=a.pArray(t.TabsOrder,this.TabsOrder),this.EntitiesOrder=a.pArray(t.EntitiesOrder,this.EntitiesOrder)),s.isEmpty(i)||(this.EnableMultiTenant=a.pBool(i.EnableMultiTenant,this.EnableMultiTenant)),this.setStartError()},setStartError:function(){n.ajax({url:l.getAppPath()+"data/settings/config.json",type:"GET",async:!0,dataType:"json",complete:function(e,t){"success"===t&&this.startError(r.i18n("ADMINPANELWEBCLIENT/ERROR_DATA_FOLDER_ACCESSIBLE_FROM_WEB"))}.bind(this),timeout:5e4})},getStartError:function(){return this.startError}}},"6ZXr":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV");e.exports={ServerModuleName:"Dropbox",HashModuleName:"dropbox",Connected:!1,EnableModule:!1,Id:"",Secret:"",Scopes:[],init:function(e){var t=e.Dropbox;s.isEmpty(t)||(this.Connected=o.pBool(t.Connected,this.Connected),this.EnableModule=o.pBool(t.EnableModule,this.EnableModule),this.Id=o.pString(t.Id,this.Id),this.Secret=o.pString(t.Secret,this.Secret),this.Scopes=o.pArray(t.Scopes,this.Scopes))},getScopesCopy:function(){var e=[];return s.each(this.Scopes,(function(t){e.push({Description:t.Description,Name:t.Name,Value:n.observable(t.Value)})})),e},updateScopes:function(e,t){var i=[];s.each(t,(function(e){i.push({Description:e.Description,Name:e.Name,Value:e.Value()})})),this.Connected=e,this.Scopes=i},updateAdmin:function(e,t,i,s){this.EnableModule=e,this.Id=t,this.Secret=i,this.Scopes=s}}},"6yFS":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),r=i("DllP");function a(){o.call(this,r.ServerModuleName),this.masterPassword=n.observable("")}s.extendOwn(a.prototype,o.prototype),a.prototype.ViewTemplate="MailMasterPassword_MailMasterPasswordAdminSettingsView",a.prototype.getParametersForSave=function(){return{MasterPassword:this.masterPassword()}},a.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new a},"7Lti":function(e,t,i){"use strict";(function(t){var s=i("0h2I"),n=i("F/us"),o=i("RN+F"),r=i("AFLV"),a=i("IAk5"),l=i("SQrT");e.exports={ServerModuleName:"TwoFactorAuth",HashModuleName:"two-factor-auth",AuthenticatorAppEnabled:!1,ShowRecommendationToConfigure:!0,AllowBackupCodes:!1,BackupCodesCount:!1,AllowSecurityKeys:!1,AllowAuthenticatorApp:!1,SecurityKeys:[],AllowUsedDevices:!1,TrustDevicesForDays:0,AllowTrustedDevices:!1,init:function(e){var t=n.extend({},e[this.ServerModuleName]||{},e.TwoFactorAuth||{});n.isEmpty(t)||(this.ShowRecommendationToConfigure=r.pBool(t.ShowRecommendationToConfigure,this.ShowRecommendationToConfigure),this.AllowBackupCodes=r.pBool(t.AllowBackupCodes,this.AllowBackupCodes),this.BackupCodesCount=r.pInt(t.BackupCodesCount,this.BackupCodesCount),this.AllowSecurityKeys=r.pBool(t.AllowSecurityKeys,this.AllowSecurityKeys),this.AllowAuthenticatorApp=r.pBool(t.AllowAuthenticatorApp,this.AllowAuthenticatorApp),this.AuthenticatorAppEnabled=this.AllowAuthenticatorApp&&r.pBool(t.AuthenticatorAppEnabled,this.AuthenticatorAppEnabled),this.AllowUsedDevices=r.pBool(t.AllowUsedDevices,this.AllowUsedDevices),this.TrustDevicesForDays=r.pInt(t.TrustDevicesForDays,this.TrustDevicesForDays),this.AllowTrustedDevices=this.TrustDevicesForDays>0,this.SecurityKeys=[],r.isNonEmptyArray(t.WebAuthKeysInfo)&&n.each(t.WebAuthKeysInfo,function(e){r.isNonEmptyArray(e,2)&&this.SecurityKeys.push({Id:e[0],keyName:s.observable(e[1])})}.bind(this)),this.checkIfEnabled())},updateShowRecommendation:function(e){this.ShowRecommendationToConfigure=e},updateBackupCodesCount:function(e){this.BackupCodesCount=e},updateAuthenticatorApp:function(e){this.AuthenticatorAppEnabled=!!e},checkIfEnabled:function(){if(!a.isMobile()&&a.isUserNormalOrTenant()&&this.ShowRecommendationToConfigure){var e="settings/two-factor-auth"===window.location.hash||"#settings/two-factor-auth"===window.location.hash;this.AuthenticatorAppEnabled||e||setTimeout((function(){l.showLoading(o.i18n("TWOFACTORAUTH/CONFIRM_MODULE_NOT_ENABLED")),t(".report_panel.loading a").on("click",(function(){l.hideLoading()})),setTimeout((function(){l.hideLoading()}),1e4)}),100)}}}}).call(this,i("EVdn"))},"9nLz":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("OgeD"),a=i("SQrT"),l=r.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("vF2m");function u(){l.call(this,h.ServerModuleName),this.enable=n.observable(h.EnableModule),this.id=n.observable(h.Id),this.secret=n.observable(h.Secret),this.key=n.observable(h.Key),this.scopes=n.observable(h.getScopesCopy())}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="Google_AdminSettingsView",u.prototype.getCurrentValues=function(){var e=s.map(this.scopes(),(function(e){return e.Name+e.Value()}));return[this.enable(),this.id(),this.secret(),this.key(),e]},u.prototype.revertGlobalValues=function(){this.enable(h.EnableModule),this.id(h.Id),this.secret(h.Secret),this.key(h.Key),this.scopes(h.getScopesCopy())},u.prototype.validateBeforeSave=function(){return!this.enable()||""!==this.id()&&""!==this.secret()&&""!==this.key()||(a.showError(o.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY")),!1)},u.prototype.getParametersForSave=function(){return{EnableModule:this.enable(),Id:this.id(),Secret:this.secret(),Key:this.key(),Scopes:s.map(this.scopes(),(function(e){return{Name:e.Name,Description:e.Description,Value:e.Value()}}))}},u.prototype.applySavedValues=function(e){h.updateAdmin(e.EnableModule,e.Id,e.Secret,e.Key,e.Scopes)},u.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new u},Aqrs:function(e,t,i){"use strict";var s=i("0h2I"),n=i("AFLV");function o(e){this.iAccountId=e,this.enable=s.observable(!0).extend({reversible:!0}),this.field=s.observable("").extend({reversible:!0}),this.condition=s.observable("").extend({reversible:!0}),this.filter=s.observable("").extend({reversible:!0}),this.action=s.observable("").extend({reversible:!0}),this.folder=s.observable("").extend({reversible:!0}),this.email=s.observable("").extend({reversible:!0})}o.prototype.parse=function(e){this.enable(!!e.Enable),this.field(n.pInt(e.Field)),this.condition(n.pInt(e.Condition)),this.filter(n.pString(e.Filter)),this.action(n.pInt(e.Action)),this.folder(n.pString(e.FolderFullName)),this.email(n.pString(e.Email)),this.commit()},o.prototype.revert=function(){this.enable.revert(),this.field.revert(),this.condition.revert(),this.filter.revert(),this.action.revert(),this.folder.revert(),this.email.revert()},o.prototype.commit=function(){this.enable.commit(),this.field.commit(),this.condition.commit(),this.filter.commit(),this.action.commit(),this.folder.commit(),this.email.commit()},o.prototype.toString=function(){return[this.enable(),this.field(),this.condition(),this.filter(),this.action(),this.folder(),this.email()].join(":")},e.exports=o},B9Yq:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},BRgg:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("SQrT"),l=i("hPb3"),h=i("mrHt"),u=i("yYIs"),c=i("76Kh"),d=i("1grR"),p=i("20Ah");function m(){u.call(this,l.ServerModuleName),this.sFakePass="xxxxxxxxxx",this.dbLogin=o.observable(l.DbLogin),this.dbPassword=o.observable(this.sFakePass),this.dbName=o.observable(l.DbName),this.dbHost=o.observable(l.DbHost),this.isCreating=o.observable(!1),this.startError=o.observable(""),this.setStartError()}s.extendOwn(m.prototype,u.prototype),m.prototype.ViewTemplate="AdminPanelWebclient_DbAdminSettingsView",m.prototype.setStartError=function(){this.startError(""===l.DbLogin||""===l.DbName||""===l.DbHost?r.i18n("ADMINPANELWEBCLIENT/ERROR_DB_ACCESS"):"")},m.prototype.getStartError=function(){return this.startError},m.prototype.getCurrentValues=function(){return[this.dbLogin(),this.dbPassword(),this.dbName(),this.dbHost()]},m.prototype.revertGlobalValues=function(){this.dbLogin(l.DbLogin),this.dbPassword(this.sFakePass),this.dbName(l.DbName),this.dbHost(l.DbHost)},m.prototype.getParametersForSave=function(){return this.dbPassword()===this.sFakePass?{DbLogin:n.trim(this.dbLogin()),DbName:n.trim(this.dbName()),DbHost:n.trim(this.dbHost())}:{DbLogin:n.trim(this.dbLogin()),DbPassword:n.trim(this.dbPassword()),DbName:n.trim(this.dbName()),DbHost:n.trim(this.dbHost())}},m.prototype.applySavedValues=function(e){l.StoreAuthTokenInDB&&c.showPopup(d,[r.i18n("ADMINPANELWEBCLIENT/INFO_AUTHTOKEN_DB_STORED")]),l.updateDb(e.DbLogin,e.DbName,e.DbHost),this.setStartError()},m.prototype.setAccessLevel=function(e,t){this.visible(""===e)},m.prototype.testConnection=function(){h.send("TestDbConnection",this.getParametersForSave(),(function(e){e.Result?a.showReport(r.i18n("ADMINPANELWEBCLIENT/REPORT_DB_CONNECT_SUCCESSFUL")):a.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_DB_CONNECT_FAILED"))}),this)},m.prototype.createTables=function(){var e=this,t=function(){e.isCreating(!0),h.send("CreateTables",null,(function(t){t.Result?a.showReport(r.i18n("ADMINPANELWEBCLIENT/REPORT_CREATE_TABLES_SUCCESSFUL")):a.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_CREATE_TABLES_FAILED")),e.isCreating(!1)}))};this.sSavedState!==this.getCurrentState()?c.showPopup(p,[r.i18n("ADMINPANELWEBCLIENT/CONFIRM_SAVE_CHANGES_BEFORE_CREATE_TABLES"),s.bind((function(e){if(e){var i=this.isSaving.subscribe((function(e){e||(t(),i.dispose())}),this);this.save()}}),this)]):t()},m.prototype.updateConfig=function(){h.send("UpdateConfig",null,(function(e){e.Result?a.showReport(r.i18n("ADMINPANELWEBCLIENT/REPORT_UPDATE_CONFIG_SUCCESSFUL")):a.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_UPDATE_CONFIG_FAILED"))}))},e.exports=new m},BnpE:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("o0Bx"),a=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),l=i("DlrD");function h(){a.call(this,l.ServerModuleName),this.isSuperAdmin=n.observable(!1),this.iTenantId=0,this.accessKey=n.observable(l.AccessKey),this.secretKey=n.observable(l.SecretKey),this.region=n.observable(l.Region),this.host=n.observable(l.Host),this.bucketPrefix=n.observable(l.BucketPrefix)}s.extendOwn(h.prototype,a.prototype),h.prototype.ViewTemplate="S3Filestorage_S3AdminSettingsView",h.prototype.getCurrentValues=function(){return[this.accessKey(),this.secretKey(),this.region(),this.host(),this.bucketPrefix()]},h.prototype.revertGlobalValues=function(){this.accessKey(l.AccessKey),this.secretKey(l.SecretKey),this.region(l.Region),this.host(l.Host),this.bucketPrefix(l.BucketPrefix)},h.prototype.clearFields=function(){this.accessKey(""),this.secretKey(""),this.region(""),this.host(""),this.bucketPrefix("")},h.prototype.save=function(){s.isFunction(this.validateBeforeSave)&&!this.validateBeforeSave()||(this.isSaving(!0),r.send(this.sServerModule,"UpdateS3Settings",this.getParametersForSave(),this.onResponse,this))},h.prototype.getParametersForSave=function(){var e={AccessKey:this.accessKey(),SecretKey:this.secretKey(),Region:this.region(),Host:this.host(),BucketPrefix:this.bucketPrefix()};return o.isPositiveNumber(this.iTenantId)&&(e.TenantId=this.iTenantId),e},h.prototype.applySavedValues=function(e){this.isSuperAdmin()&&l.update(e.AccessKey,e.SecretKey,e.Region,e.Host,e.BucketPrefix)},h.prototype.setAccessLevel=function(e,t){this.iTenantId="Tenant"===e?t:0,this.visible(""===e||"Tenant"===e),this.isSuperAdmin(""===e)},h.prototype.onRouteChild=function(e){this.requestPerTenantSettings()},h.prototype.requestPerTenantSettings=function(){o.isPositiveNumber(this.iTenantId)?(this.clearFields(),r.send(l.ServerModuleName,"GetSettings",{TenantId:this.iTenantId},(function(e){e.Result&&(this.region(e.Result.Region),this.updateSavedState())}),this)):this.revertGlobalValues()},e.exports=new h},"Cq+9":function(e,t,i){"use strict";(function(t){var s=i("F/us"),n=i("RN+F"),o=i("AFLV"),r=i("JFZZ"),a=i("IAk5"),l=i("QaF5"),h=i("SQrT"),u=i("cyfa"),c=i("KARm"),d=i("zu1m"),p=i("jonm"),m=i("UN2P"),g=i("4+IO"),f=i("p2hp"),b=a.isNewTab()&&window.opener&&window.opener.MainTabMailMethods,v={sReplyText:"",sReplyDraftUid:"",oPostponedMailData:null};function y(e,t,i,s){var o=n.i18n("MAILWEBCLIENT/TEXT_REPLY_MESSAGE",{DATE:e.oDateModel.getDate(),TIME:e.oDateModel.getTime(),SENDER:n.encodeHtml(e.oFrom.getFull())});return"<br /><br />"+this.getSignatureText(t,i,s)+'<br /><br /><div data-anchor="reply-title">'+o+"</div><blockquote>"+e.getConvertedHtml()+"</blockquote>"}v.setReplyData=function(e,t){this.sReplyText=e,this.sReplyDraftUid=t},v.send=function(e,t,i,s,r,a,u){u="boolean"!=typeof u||u;var c=t.AccountID,d=p.getAccount(c),f=g.oFolderListItems[c],v="",y=f?f.sentFolderFullName():"",E=f?f.draftsFolderFullName():"",S=d?d.email():"",A=t.To.indexOf(S)>-1||t.Cc.indexOf(S)>-1||t.Bcc.indexOf(S)>-1;switch(d.bSaveRepliesToCurrFolder&&!A&&o.isNonEmptyArray(t.DraftInfo,3)&&(y=t.DraftInfo[2]),t.Method=e,t.ShowReport=i,e){case"SendMessage":v=n.i18n("COREWEBCLIENT/INFO_SENDING"),u?(o.isNonEmptyString(t.SentFolder)||(t.SentFolder=y),""!==t.DraftUid&&(t.DraftFolder=E,b?(b.removeOneMessageFromCacheForFolder(t.AccountID,t.DraftFolder,t.DraftUid),b.replaceHashWithoutMessageUid(t.DraftUid)):(g.removeOneMessageFromCacheForFolder(t.AccountID,t.DraftFolder,t.DraftUid),l.replaceHashWithoutMessageUid(t.DraftUid)))):(delete t.SentFolder,delete t.DraftUid,delete t.DraftFolder);break;case"SaveMessage":v=n.i18n("MAILWEBCLIENT/INFO_SAVING"),void 0===t.DraftFolder&&(t.DraftFolder=E),g.savingDraftUid(t.DraftUid),b?(b.startMessagesLoadingWhenDraftSaving(t.AccountID,t.DraftFolder),b.replaceHashWithoutMessageUid(t.DraftUid)):(g.startMessagesLoadingWhenDraftSaving(t.AccountID,t.DraftFolder),l.replaceHashWithoutMessageUid(t.DraftUid))}i&&h.showLoading(v),a?this.postponedMailData={Parameters:t,SendMessageResponseHandler:s,SendMessageResponseContext:r}:m.send(e,t,s,r)},v.sendPostponedMail=function(e){var t=this.postponedMailData,i=t.Parameters,s=i.AccountID,n=g.oFolderListItems[s],o=n?n.draftsFolderFullName():"";""!==e&&(i.DraftUid=e,i.DraftFolder=o,b?(b.removeOneMessageFromCacheForFolder(i.AccountID,i.DraftFolder,i.DraftUid),b.replaceHashWithoutMessageUid(i.DraftUid)):(g.removeOneMessageFromCacheForFolder(i.AccountID,i.DraftFolder,i.DraftUid),l.replaceHashWithoutMessageUid(i.DraftUid))),this.postponedMailData&&(m.send(i.Method,i,t.SendMessageResponseHandler,t.SendMessageResponseContext),this.postponedMailData=null)},v.sendReplyMessage=function(e,t,i,s,n,o){var r=null,a=g.currentMessage(),l=[],h=null;a&&(l=a.oTo.aCollection.concat(a.oCc.aCollection),h=this.getFirstFetcherOrIdentityByRecipientsOrDefault(l,a.accountId()),(r=this.getReplyDataFromMessage(a,Enums.ReplyType.ReplyAll,a.accountId(),h,!1,t,i)).AccountID=a.accountId(),h&&(r.IdentityID=h&&h.IDENTITY?h.id():"",r.AliasID=h&&h.ALIAS?h.id():"",r.FetcherID=h&&h.FETCHER?h.id():""),r.Bcc="",r.Importance=Enums.Importance.Normal,r.SendReadingConfirmation=!1,r.IsQuickReply=!0,r.IsHtml=!0,r.Attachments=this.convertAttachmentsForSending(r.Attachments),this.send(e,r,!1,s,n,o))},v.convertAttachmentsForSending=function(e){var t={};return s.each(e,(function(e){t[e.tempName()]=[e.fileName(),e.linked()?e.cid():"",e.inline()?"1":"0",e.linked()?"1":"0",e.contentLocation()]})),t},v.onSendOrSaveMessageResponse=function(e,i,o){var a,l,u,c=i.Parameters,d=!!e.Result;switch(o||h.hideLoading(),i.Method){case"SaveMessage":g.savingDraftUid(""),d?(c.ShowReport&&!o&&(-1!==t.inArray(i.Parameters.DraftFolder,g.getCurrentTemplateFolders())?h.showReport(n.i18n("MAILWEBCLIENT/REPORT_TEMPLATE_SAVED")):h.showReport(n.i18n("MAILWEBCLIENT/REPORT_MESSAGE_SAVED"))),e.Result.NewUid||(f.AllowAutosaveInDrafts=!1)):c.ShowReport&&(-1!==t.inArray(i.Parameters.DraftFolder,g.getCurrentTemplateFolders())?r.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_TEMPLATE_SAVING")):r.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_MESSAGE_SAVING")));break;case"SendMessage":d?(c.IsQuickReply?h.showReport(n.i18n("MAILWEBCLIENT/REPORT_MESSAGE_SENT")):b?b.showReport(n.i18n("MAILWEBCLIENT/REPORT_MESSAGE_SENT")):h.showReport(n.i18n("MAILWEBCLIENT/REPORT_MESSAGE_SENT")),s.isArray(c.DraftInfo)&&3===c.DraftInfo.length&&(u=c.DraftInfo[0],l=c.DraftInfo[1],a=c.DraftInfo[2],g.markMessageReplied(c.AccountID,a,l,u))):r.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_MESSAGE_SENDING")),c.SentFolder&&(b?b.removeMessagesFromCacheForFolder(c.AccountID,c.SentFolder):g.removeMessagesFromCacheForFolder(c.AccountID,c.SentFolder))}return c.DraftFolder&&!o&&(b?b.removeMessagesFromCacheForFolder(c.AccountID,c.DraftFolder):g.removeMessagesFromCacheForFolder(c.AccountID,c.DraftFolder)),{Method:i.Method,Result:d,NewUid:e.Result?e.Result.NewUid:""}},v.getReplytoAddresses=function(e){var t=e.oReplyTo;return(""===t.getFull()||e.oFrom.getFirstEmail()===t.getFirstEmail()&&""===t.getFirstName())&&(t=e.oFrom),t},v.getReplyDataFromMessage=function(e,t,i,n,o,r,a){var l={DraftInfo:[],DraftUid:"",To:"",Cc:"",Bcc:"",Subject:"",Attachments:[],InReplyTo:e.messageId(),References:this.getReplyReferences(e)},h=[],u=this.getReplytoAddresses(e).getFull();switch(r&&""!==r||(r=this.sReplyText,this.sReplyText=""),"forward"===t?l.Text=r+this.getForwardMessageBody(e,i,n):"resend"===t?(l.Text=e.getConvertedHtml(),l.Cc=e.cc(),l.Bcc=e.bcc()):l.Text=r+y.call(this,e,i,n,o),a?l.DraftUid=a:(l.DraftUid=this.sReplyDraftUid,this.sReplyDraftUid=""),t){case Enums.ReplyType.Reply:l.DraftInfo=[Enums.ReplyType.Reply,e.uid(),e.folder()],l.To=u,l.Subject=this.getReplySubject(e.subject(),!0),h=s.filter(e.attachments(),(function(e){return e.linked()}));break;case Enums.ReplyType.ReplyAll:l.DraftInfo=[Enums.ReplyType.ReplyAll,e.uid(),e.folder()],l.To=u,l.Cc=this.getReplyAllCcAddr(e,i,n),l.Subject=this.getReplySubject(e.subject(),!0),h=s.filter(e.attachments(),(function(e){return e.linked()}));break;case Enums.ReplyType.Resend:l.DraftInfo=[Enums.ReplyType.Resend,e.uid(),e.folder(),e.cc(),e.bcc()],l.To=e.oTo.getFull(),l.Subject=e.subject(),h=e.attachments();break;case Enums.ReplyType.ForwardAsAttach:case Enums.ReplyType.Forward:l.DraftInfo=[Enums.ReplyType.Forward,e.uid(),e.folder()],l.Subject=this.getReplySubject(e.subject(),!1),h=e.attachments()}return s.each(h,(function(e){if(e.getCopy){var t=e.getCopy();l.Attachments.push(t)}})),l},v.getReplyReferences=function(e){var t=e.references(),i=e.messageId();return-1===t.indexOf(i)&&(t+=" "+i),t},v.getClearSignature=function(e,t){var i=p.getAccount(e),s="";return t&&t.accountId()===e&&t.useSignature()?s=t.signature():i&&i.useSignature()&&(s=i.signature()),s},v.getSignatureText=function(e,t,i){var s=this.getClearSignature(e,t);return i?'<div data-anchor="signature">'+s+"</div>":"<div>"+s+"</div>"},v.getFirstFetcherOrIdentityByRecipientsOrDefault=function(e,t){var i=p.getAccount(t),n=this.getAccountFetchersIdentitiesList(i),o=[],r=null;return s.each(e,(function(e){if(!r)switch((o=s.filter(n,(function(t){return e.sEmail===t.email}))).length){case 0:break;case 1:r=o[0];break;default:(r=s.find(o,(function(t){return e.sEmail===t.email&&e.sName===t.name})))||(r=s.find(o,(function(e){return e.isDefault})))||(r=o[0])}})),r||(r=s.find(n,(function(e){return e.isDefault}))),r&&r.result},v.getAccountFetchersIdentitiesList=function(e){var t=[];return e&&(s.each(e.fetchers(),(function(e){t.push({email:e.email(),name:e.userName(),isDefault:!1,result:e})})),s.each(e.identities(),(function(e){t.push({email:e.email(),name:e.friendlyName(),isDefault:e.isDefault(),result:e})})),s.each(e.aliases(),(function(e){t.push({email:e.email(),name:e.friendlyName(),isDefault:!1,result:e})}))),t},v.getForwardMessageBody=function(e,t,i){var s=n.encodeHtml(e.oCc.getFull()),o=""!==s?n.i18n("MAILWEBCLIENT/TEXT_FORWARD_MESSAGE_CCPART",{CCADDR:s}):"",r=n.i18n("MAILWEBCLIENT/TEXT_FORWARD_MESSAGE",{FROMADDR:n.encodeHtml(e.oFrom.getFull()),TOADDR:n.encodeHtml(e.oTo.getFull()),CCPART:o,FULLDATE:e.oDateModel.getFullDate(),SUBJECT:n.encodeHtml(e.subject())});return"<br /><br />"+this.getSignatureText(t,i,!0)+'<br /><br /><div data-anchor="reply-title">'+r+"</div><br /><br />"+e.getConvertedHtml()},v.hasReplyAllCcAddrs=function(e){var t=e.accountId(),i=e.oTo.aCollection.concat(e.oCc.aCollection),s=this.getFirstFetcherOrIdentityByRecipientsOrDefault(i,e.accountId());return""!==this.getReplyAllCcAddr(e,t,s)},v.getReplyAllCcAddr=function(e,t,i){var n=new c,o=s.union(e.oTo.aCollection,e.oCc.aCollection,e.oBcc.aCollection),r=s.find(p.collection(),(function(e){return e.id()===t}),this),a=new u,l=new u,h=this.getReplytoAddresses(e);return a.sEmail=r.email(),l.sEmail=i?i.email():"",n.addCollection(o),n.excludeCollection(s.union(h.aCollection,[a,l])),n.getFull()},v.getReplySubject=function(e,t){var i=n.i18n("MAILWEBCLIENT/TEXT_REPLY_PREFIX"),s=n.i18n("MAILWEBCLIENT/TEXT_FORWARD_PREFIX"),o=(t?i:s)+": "+e;return f.JoinReplyPrefixes&&(o=d.joinReplyPrefixesInSubject(o,i,s)),o},v.getHtmlFromText=function(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\r/g,"").replace(/\n/g,"<br />")},e.exports=v}).call(this,i("EVdn"))},DM8i:function(e,t,i){"use strict";var s=i("EVdn"),n=i("0h2I"),o=i("F/us"),r=i("AFLV");function a(e,t,i,o,a){this.server=n.observable(""),this.server.focused=n.observable(!1),this.label=o,this.defaultPort=n.observable(e),this.defaultSslPort=n.observable(t),this.port=n.observable(e),this.port.focused=n.observable(!1),this.ssl=n.observable(!1),this.isEnabled=n.observable(!0),this.id=i,s.isFunction(a)&&a.focused.subscribe((function(){a.focused()||""!==this.server()||this.server(a())}),this),this.ssl.subscribe((function(){var e=r.pInt(this.port());this.ssl()?e===this.defaultPort()&&this.port(this.defaultSslPort()):e===this.defaultSslPort()&&this.port(this.defaultPort())}),this)}a.prototype.set=function(e,t,i){this.server(e),this.ssl(i),this.port(t)},a.prototype.clear=function(){this.server(""),this.ssl(!1),this.port(this.defaultPort())},a.prototype.getIntPort=function(){return r.pInt(this.port())},a.prototype.parentSave=function(e,t){e.focused&&e.focused(!1);var i=o.find(t,(function(e){return o.isFunction(e.save)}));i&&i.save()},e.exports=a},DllP:function(e,t,i){"use strict";i("F/us"),i("AFLV");e.exports={ServerModuleName:"MailMasterPassword",HashModuleName:"mailmasterpassword",init:function(e){}}},DlrD:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"S3Filestorage",HashModuleName:"s3-filestorage",AccessKey:"",SecretKey:"",Region:"",Host:"",BucketPrefix:"",init:function(e){var t=e[this.ServerModuleName];s.isEmpty(t)||(this.AccessKey=n.pString(t.AccessKey,this.AccessKey),this.SecretKey=n.pString(t.SecretKey,this.SecretKey),this.Region=n.pString(t.Region,this.Region),this.Host=n.pString(t.Host,this.Host),this.BucketPrefix=n.pString(t.BucketPrefix,this.BucketPrefix))},update:function(e,t,i,s,n){this.AccessKey=e,this.SecretKey=t,this.Region=i,this.Host=s,this.BucketPrefix=n}}},DnLV:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("o0Bx"),a=i("JFZZ"),l=i("IAk5"),h=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),u=i("Jq2H");function c(){h.call(this,u.ServerModuleName),this.sEntityType="",this.iEntityId=0,this.isNoEntity=n.observable(!1),this.isTenantEntity=n.observable(!1),this.isUserEntity=n.observable(!1),this.allowEditUserSpaceLimitMb=n.observable(!0),this.allowEditTenantSpaceLimitMb=n.observable(!0),this.allocatedSpace=n.observable(0),this.visibleCorporate=n.computed((function(){return u.ShowCorporateFilesAdminSection&&!this.isUserEntity()}),this),this.enableUploadSizeLimit=n.observable(u.EnableUploadSizeLimit),this.uploadSizeLimitMb=n.observable(u.UploadSizeLimitMb),this.userSpaceLimitMb=n.observable(u.UserSpaceLimitMb),this.tenantSpaceLimitMb=n.observable(u.TenantSpaceLimitMb),this.corporateSpaceLimitMb=n.observable(u.CorporateSpaceLimitMb),this.isPersonalSaving=n.observable(!1),this.isCorporateSaving=n.observable(!1)}s.extendOwn(c.prototype,h.prototype),c.prototype.ViewTemplate="FilesWebclient_FilesAdminSettingsView",c.prototype.getCurrentValues=function(){return[this.enableUploadSizeLimit(),this.uploadSizeLimitMb(),this.tenantSpaceLimitMb(),this.userSpaceLimitMb(),this.corporateSpaceLimitMb()]},c.prototype.revertGlobalValues=function(){this.enableUploadSizeLimit(u.EnableUploadSizeLimit),this.uploadSizeLimitMb(u.UploadSizeLimitMb),this.userSpaceLimitMb(u.UserSpaceLimitMb),this.tenantSpaceLimitMb(u.TenantSpaceLimitMb),this.corporateSpaceLimitMb(u.CorporateSpaceLimitMb)},c.prototype.getParametersForSave=function(){return{EnableUploadSizeLimit:this.enableUploadSizeLimit(),UploadSizeLimitMb:o.pInt(this.uploadSizeLimitMb()),UserSpaceLimitMb:o.pInt(this.userSpaceLimitMb())}},c.prototype.applySavedValues=function(e){u.updateAdmin(e.EnableUploadSizeLimit,e.UploadSizeLimitMb)},c.prototype.setAccessLevel=function(e,t){this.sEntityType=e,this.iEntityId="User"===e||"Tenant"===e?t:0,this.visible(""===e||"Tenant"===e||"User"===e),this.isNoEntity(""===e),this.isTenantEntity("Tenant"===e),this.isUserEntity("User"===e)},c.prototype.onRouteChild=function(e){"Tenant"!==this.sEntityType&&"User"!==this.sEntityType||(this.requestPerEntitytSettings(),this.allowEditTenantSpaceLimitMb(l.getUserRole()===Enums.UserRole.SuperAdmin))},c.prototype.requestPerEntitytSettings=function(){o.isPositiveNumber(this.iEntityId)?r.send(u.ServerModuleName,"GetSettingsForEntity",{EntityType:this.sEntityType,EntityId:this.iEntityId},(function(e){e.Result?(this.userSpaceLimitMb(o.pInt(e.Result.UserSpaceLimitMb)),this.tenantSpaceLimitMb(o.pInt(e.Result.TenantSpaceLimitMb)),void 0!==e.Result.AllowEditUserSpaceLimitMb&&this.allowEditUserSpaceLimitMb(o.pBool(e.Result.AllowEditUserSpaceLimitMb)),void 0!==e.Result.AllocatedSpace&&this.allocatedSpace(o.pInt(e.Result.AllocatedSpace)),this.updateSavedState()):(this.revertGlobalValues(),this.allocatedSpace(0),a.showErrorByCode(e))}),this):(this.revertGlobalValues(),this.allocatedSpace(0))},c.prototype.savePersonal=function(){if(!s.isFunction(this.validateBeforeSave)||this.validateBeforeSave()){var e={EntityType:this.sEntityType,EntityId:o.pInt(this.iEntityId),UserSpaceLimitMb:o.pInt(this.userSpaceLimitMb()),TenantSpaceLimitMb:o.pInt(this.tenantSpaceLimitMb())};"Tenant"===this.sEntityType&&(e.TenantId=e.EntityId),this.isPersonalSaving(!0),r.send(this.sServerModule,"UpdateSettingsForEntity",e,(function(e,t){this.isPersonalSaving(!1),this.onResponse(e,t)}),this)}},c.prototype.saveCorporate=function(){var e={SpaceLimitMb:o.pInt(this.corporateSpaceLimitMb())};"Tenant"===this.sEntityType&&(e.TenantId=o.pInt(this.iEntityId)),this.isCorporateSaving(!0),r.send("CorporateFiles","UpdateSettings",e,(function(e,t){this.isCorporateSaving(!1),this.onResponse(e,t)}),this)},c.prototype.applySavedValues=function(e){void 0!==e.EntityType&&""===e.EntityType&&void 0!==e.UserSpaceLimitMb&&void 0!==e.TenantSpaceLimitMb&&(u.UserSpaceLimitMb=e.UserSpaceLimitMb,u.TenantSpaceLimitMb=e.TenantSpaceLimitMb)},e.exports=new c},GdT1:function(e,t,i){"use strict";(function(t){var s=i("F/us"),n=i("0h2I"),o=i("Ol7c"),r=i("RN+F"),a=i("OgeD"),l=i("76Kh"),h=i("20Ah"),u=i("Cq+9");function c(){this.recipientsInfo=n.observable({}),this.autoEncryptSignMessage=n.observable(!1)}c.prototype.setAutoEncryptSubscribes=function(){this.hasRecipientsWithKey=n.computed((function(){return!!s.find(this.recipientsInfo(),function(e){return e.hasKey&&(e.encryptMessage||e.signMessage)&&-1!==s.indexOf(this.recipientEmails(),e.email)}.bind(this))}),this).extend({throttle:10}),this.allowAtoEncryptSignMessage=n.computed((function(){return this.hasRecipientsWithKey()&&!this.messageSignedOrEncrypted()}),this),this.allowAtoEncryptSignMessage.subscribe((function(){this.autoEncryptSignMessage(this.allowAtoEncryptSignMessage())}),this),this.recipientEmails.subscribe((function(){var e=s.keys(this.recipientsInfo()),i=s.difference(this.recipientEmails(),e);i.length>0&&a.run("ContactsWebclient","getContactsByEmails",[i,function(e){s.each(s.values(e),function(e){e&&(this.recipientsInfo()[e.email()]={email:e.email(),encryptMessage:e.pgpEncryptMessages(),hasKey:"string"==typeof e.publicPgpKey()&&""!==e.publicPgpKey(),id:e.uuid(),label:e.email(),name:e.displayName(),sharedToAll:e.sharedToAll(),signMessage:e.pgpSignMessages(),storage:e.storage(),team:e.team(),value:e.email()})}.bind(this)),t(this.toAddrDom()).inputosaurus("refresh"),t(this.ccAddrDom()).inputosaurus("refresh"),t(this.bccAddrDom()).inputosaurus("refresh"),this.recipientsInfo.valueHasMutated()}.bind(this)])}),this)},c.prototype.getInputosaurusMethods=function(){return{addRecipientInfo:function(e){var t=o.getEmailParts(e.value);this.recipientsInfo()[t.email]=e,this.recipientsInfo.valueHasMutated()}.bind(this),getRecipientPgpKeyHtml:function(e){var t=o.getEmailParts(e),i=this.recipientsInfo()[t.email],s="";return!!i&&!!i.hasKey&&(s+='<span class="address_capsule_key address_capsule_key_unset"></span>',i.encryptMessage?s+='<span class="address_capsule_key address_capsule_key_encrypt" title="'+r.i18n("MAILWEBCLIENT/HINT_MESSAGE_ENCRYPT_WITH_KEY")+'"></span>':s+='<span class="address_capsule_key address_capsule_key_not_encrypt"></span>',i.signMessage&&(s+='<span class="address_capsule_key address_capsule_key_sign" title="'+r.i18n("MAILWEBCLIENT/HINT_MESSAGE_SIGN_WITH_KEY")+'"></span>')),s}.bind(this)}},c.prototype.groupAllRecipients=function(e){var t=[],i=[],n=[],o=[],r=0;return s.each(e,function(e){var s=this.recipientsInfo()[e];s&&s.hasKey?s.encryptMessage?s.signMessage?o.push(e):i.push(e):s.signMessage?n.push(e):t.push(e):t.push(e)}.bind(this)),t.length>0&&r++,i.length>0&&r++,n.length>0&&r++,o.length>0&&r++,{simple:t,encrypt:i,sign:n,signEncrypt:o,simpleCount:t.length,encryptCount:i.length,signCount:n.length,signEncryptCount:o.length,groupCount:r}},c.prototype.confirmNotAllRecipientsEncryptSign=function(e,t){var i=null;e.simpleCount>0?e.encryptCount>0||e.signEncryptCount>0?i=r.i18n("MAILWEBCLIENT/CONFIRM_ENCRYPT_NOT_ALL_RECIPIENTS"):e.signCount>0&&(i=r.i18n("MAILWEBCLIENT/CONFIRM_SIGN_NOT_ALL_RECIPIENTS")):e.signCount>0&&(e.encryptCount>0||e.signEncryptCount>0)?i=r.i18n("MAILWEBCLIENT/CONFIRM_ENCRYPT_NOT_ALL_RECIPIENTS"):0===e.signCount&&e.encryptCount>0&&e.signEncryptCount>0&&(i=r.i18n("MAILWEBCLIENT/CONFIRM_SIGN_NOT_ALL_RECIPIENTS")),null!==i?l.showPopup(h,[i,t,"",r.i18n("MAILWEBCLIENT/ACTION_PROCEED_SENDING")]):t(!0)},c.prototype.proceedEncryptSignAndSend=function(e,t,i){var n=this.oHtmlEditor.getPlainText(),o=this.getSendSaveParameters(!0),r=[],l=function(e,t,i,n){var r=s.clone(o);r.Text=i,r.IsHtml=!1,r.Recipients=e,h(r,t)},h=s.bind((function(t,i){r.push({oSendParameters:t,bAddToSentFolder:i}),r.length===e.groupCount&&(this.sending(!0),this.requiresPostponedSending(!this.allowStartSending()),this.backToListOnSendOrSave(!0),s.each(r,function(e){u.send("SendMessage",e.oSendParameters,!0,this.onSendOrSaveMessageResponse,this,this.requiresPostponedSending(),e.bAddToSentFolder)}.bind(this)))}),this);if(e.simpleCount>0){var c=s.clone(o);c.Recipients=e.simple,h(c,0===e.signCount&&0===e.encryptCount&&0===e.signEncryptCount)}e.signCount>0&&a.run("OpenPgpWebclient","encryptSign",[!1,!0,n,e.sign,l.bind(this,e.sign,0===e.encryptCount&&0===e.signEncryptCount),t,i]),e.encryptCount>0&&a.run("OpenPgpWebclient","encryptSign",[!0,!1,n,e.encrypt,l.bind(this,e.encrypt,0===e.signEncryptCount),t]),e.signEncryptCount>0&&a.run("OpenPgpWebclient","encryptSign",[!0,!0,n,e.signEncrypt,l.bind(this,e.signEncrypt,!0),t,i])},c.prototype.encryptSignAndSend=function(){var e=this.selectedFetcherOrIdentity().email(),t=this.recipientEmails(),i=this.groupAllRecipients(t);this.confirmNotAllRecipientsEncryptSign(i,function(t){t&&(i.signCount>0||i.signEncryptCount>0?a.run("OpenPgpWebclient","getPrivateKeyPassword",[e,function(t){this.proceedEncryptSignAndSend(i,e,t)}.bind(this)]):this.proceedEncryptSignAndSend(i,e))}.bind(this))},e.exports=c}).call(this,i("EVdn"))},GmMD:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("AFLV"),a=i("o0Bx"),l=i("JFZZ"),h=i("SQrT"),u=i("OgeD"),c=i("hPb3"),d=i("lRcT"),p=u.run("AdminPanelWebclient","getAbstractSettingsFormViewClass");function m(){p.call(this,d.ServerModuleName),this.licenseKey=n.observable(d.LicenseKey),this.usersNumber=n.observable(0),this.licenseType=n.observable(""),this.sTrialKeyHint=d.TrialKeyLink?o.i18n("LICENSINGWEBCLIENT/LABEL_LICENSING_TRIAL_KEY_HINT",{LINK:d.TrialKeyLink}):"",this.sPermanentKeyHint=d.PermanentKeyLink?o.i18n("LICENSINGWEBCLIENT/LABEL_LICENSING_PERMANENT_KEY_HINT",{LINK:d.PermanentKeyLink}):"",this.showTrialKeyHint=n.observable(""===d.LicenseKey&&""!==this.sTrialKeyHint)}s.extendOwn(m.prototype,p.prototype),m.prototype.ViewTemplate="LicensingWebclient_LicensingAdminSettingsView",m.prototype.onRouteChild=function(e){""===c.DbLogin||""===c.DbName||""===c.DbHost||a.send("Core","GetTotalUsersCount",{},(function(e){e&&r.isNumber(e.Result)&&e.Result>=0?this.usersNumber(e.Result):l.showErrorByCode(e)}),this),this.getLicenseInfo()},m.prototype.getLicenseInfo=function(){a.send(d.ServerModuleName,"GetLicenseInfo",{},(function(e){var t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_INVALID"),i=e&&e.Result;if(i){switch(i.Type){case 0:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_UNLIM");break;case 1:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_PERMANENT_PLURAL",{COUNT:i.Count},null,i.Count);break;case 2:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_DOMAINS_PLURAL",{COUNT:i.Count},null,i.Count);break;case 4:i.ExpiresIn<1&&(t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_OUTDATED_INFO"));break;case 3:case 10:t=3===i.Type?o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_ANNUAL_PLURAL",{COUNT:i.Count},null,i.Count):o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_TRIAL"),"*"!==i.ExpiresIn&&(i.ExpiresIn>0?t+=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_EXPIRES_IN_PLURAL",{DAYS:i.ExpiresIn},null,i.ExpiresIn):t+=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_EXPIRED")+" "+o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_OUTDATED_INFO"))}this.showTrialKeyHint(!1)}else""===d.LicenseKey&&(t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_NOT_SET")),this.showTrialKeyHint(""!==this.sTrialKeyHint);this.licenseType(t)}),this)},m.prototype.getCurrentValues=function(){return[this.licenseKey()]},m.prototype.revertGlobalValues=function(){this.licenseKey(d.LicenseKey)},m.prototype.getParametersForSave=function(){return{LicenseKey:this.licenseKey()}},m.prototype.applySavedValues=function(e){this.getLicenseInfo(),d.update(e.LicenseKey)},m.prototype.setAccessLevel=function(e,t){this.visible(""===e)},m.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var i=t.Parameters;if(this.updateSavedState(),this.applySavedValues(i),e.SubscriptionsResult&&Object.keys(e.SubscriptionsResult).length>0){var n=s.map(e.SubscriptionsResult,(function(e){return e.ErrorMessage}));h.showError(o.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS")+"["+n.join(", ")+"]")}else h.showReport(o.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))}else l.showErrorByCode(e,o.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},e.exports=new m},Jjhw:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("JFZZ"),a=i("IAk5"),l=i("fIp0"),h=i("OgeD"),u=i("SQrT"),c=h.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),d=i("76Kh"),p=i("20Ah"),m=i("4M/5"),g=i("UN2P"),f=i("NV9q"),b=i("p2hp");function v(){c.call(this,b.ServerModuleName),this.visible=n.observable(!0),this.visibleSearch=n.observable(!1),this.iServersPerPage=10,this.oServerPairPropertiesView=new f("server_edit",!0,this.iServersPerPage),this.totalServersCount=this.oServerPairPropertiesView.totalServersCount,this.tenants=h.run("AdminPanelWebclient","getTenantsObservable"),this.tenantOptions=n.computed((function(){return s.union([{Name:"system-wide",Id:0}],this.tenants())}),this),this.selectedTenantId=n.observable(this.getSelectedTenantId()),this.servers=this.oServerPairPropertiesView.servers,this.servers.subscribe((function(){s.each(this.servers(),function(e){if(0!==e.iTenantId&&b.EnableMultiTenant){var t=s.find(this.tenants(),(function(t){return t.Id===e.iTenantId}));e.sTenantHint=t?" "+o.i18n("MAILWEBCLIENT/LABEL_HINT_SERVERS_TENANTNAME",{TENANTNAME:t.Name}):""}else e.sTenantHint=""}.bind(this)),this.editedServer()||this.routeServerList(),this.serversRetrieved()||this.revert()}),this),this.serversRetrieved=this.oServerPairPropertiesView.serversRetrieved,this.createMode=n.observable(!1),this.editedServerId=n.observable(0),this.editedServer=n.computed((function(){return s.find(this.servers(),s.bind((function(e){return e.iId===this.editedServerId()}),this))}),this),this.oPageSwitcher=new l(0,this.iServersPerPage),this.oPageSwitcher.currentPage.subscribe((function(){this.routeServerList()}),this),this.iCurrentPage=0,this.totalServersCount.subscribe((function(){this.oPageSwitcher.setCount(this.totalServersCount()),""===this.searchValue()&&this.visibleSearch(this.totalServersCount()>this.iServersPerPage)}),this),this.isSearchFocused=n.observable(!1),this.newSearchValue=n.observable(""),this.searchValue=n.observable(""),this.updateSavedState()}s.extendOwn(v.prototype,c.prototype),v.prototype.ViewTemplate="MailWebclient_Settings_ServersAdminSettingsPaneView",v.prototype.getSelectedTenantId=function(){if(this.tenants().length<2)return 0;var e=h.run("AdminPanelWebclient","getKoSelectedTenantId");return s.isFunction(e)?e():0},v.prototype.routeSearch=function(){var e=["p1",this.newSearchValue()];h.run("AdminPanelWebclient","setAddHash",[e])},v.prototype.routeCreateServer=function(){h.run("AdminPanelWebclient","setAddHash",[["create"]])},v.prototype.routeEditServer=function(e){var t=[],i=this.oPageSwitcher.currentPage();(i>1||""!==this.searchValue())&&t.push("p"+i),""!==this.searchValue()&&t.push(this.searchValue()),t.push("s"+e),h.run("AdminPanelWebclient","setAddHash",[t])},v.prototype.routeServerList=function(){var e=[],t=this.oPageSwitcher.currentPage();(t>1||""!==this.searchValue())&&e.push("p"+t),""!==this.searchValue()&&e.push(this.searchValue()),h.run("AdminPanelWebclient","setAddHash",[e])},v.prototype.onRouteChild=function(e){var t=m.parseMailServers(e);this.newSearchValue(t.Search),this.createMode(t.Create),this.editedServerId(t.EditServerId),this.oServerPairPropertiesView.serverInit(t.Create),t.Create||(t.Page!==this.oPageSwitcher.currentPage()&&this.oPageSwitcher.setPage(t.Page,this.iServersPerPage),this.oPageSwitcher.currentPage()===this.iCurrentPage&&this.newSearchValue()===this.searchValue()||(this.iCurrentPage=this.oPageSwitcher.currentPage(),this.searchValue(this.newSearchValue()),this.oServerPairPropertiesView.requestServers((this.oPageSwitcher.currentPage()-1)*this.iServersPerPage,this.searchValue()))),this.revert()},v.prototype.onShow=function(){this.iCurrentPage=0,this.selectedTenantId(this.getSelectedTenantId())},v.prototype.deleteServer=function(e){var t=s.bind((function(t){t&&g.send("DeleteServer",{ServerId:e,TenantId:i.iTenantId,DeletionConfirmedByAdmin:!0},(function(t){t.Result||r.showErrorByCode(t,o.i18n("MAILWEBCLIENT/ERROR_DELETE_MAIL_SERVER")),e===this.editedServerId()&&this.routeServerList(),this.oServerPairPropertiesView.requestServers((this.oPageSwitcher.currentPage()-1)*this.iServersPerPage,this.searchValue())}),this)}),this),i=s.find(this.servers(),s.bind((function(t){return t.iId===e}),this)),n={Type:"Server",Count:1,ConfirmText:o.i18n("MAILWEBCLIENT/CONFIRM_REMOVE_SERVER")};i&&i.bAllowToDelete&&(a.broadcastEvent("ConfirmDeleteEntity::before",n),d.showPopup(p,[n.ConfirmText,t,i.sName]))},v.prototype.save=function(){if(this.oServerPairPropertiesView.validateBeforeSave()){var e=this.createMode()?"CreateServer":"UpdateServer";this.isSaving(!0),g.send(e,this.getParametersForSave(),(function(e){this.isSaving(!1),this.oServerPairPropertiesView.requestServers((this.oPageSwitcher.currentPage()-1)*this.iServersPerPage,this.searchValue()),this.createMode()?this.routeServerList():e.Result?u.showReport(o.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS")):r.showErrorByCode(e,o.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))}),this)}},v.prototype.getCurrentValues=function(){return this.oServerPairPropertiesView.getCurrentValues()},v.prototype.revertGlobalValues=function(){this.oServerPairPropertiesView.setServerId(this.editedServerId())},v.prototype.getParametersForSave=function(){var e=this.oServerPairPropertiesView.getParametersForSave();return this.createMode()?e.TenantId=this.selectedTenantId():e.TenantId=this.editedServer().iTenantId,e},v.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new v},Jq2H:function(e,t,i){"use strict";i("0h2I");var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"Files",CorporateServerModuleName:"CorporateFiles",PersonalServerModuleName:"PersonalFiles",HashModuleName:"files",CustomTabTitle:"",Storages:[],EnableUploadSizeLimit:!1,PublicFolderName:"",PublicHash:"",UploadSizeLimitMb:0,UserSpaceLimitMb:0,TenantSpaceLimitMb:0,CorporateSpaceLimitMb:0,EditFileNameWithoutExtension:!1,ShowCommonSettings:!0,ShowFilesApps:!0,BottomLeftCornerLinks:[],ShowPersonalFilesAdminSection:!1,ShowCorporateFilesAdminSection:!1,PublicLinksEnabled:!0,init:function(e){var t=e[this.ServerModuleName],i=e[this.CorporateServerModuleName],o=e.FilesWebclient;s.isEmpty(t)||(this.CustomTabTitle=n.pString(t.CustomTabTitle,this.CustomTabTitle),this.Storages=n.pArray(t.Storages,this.Storages),this.EnableUploadSizeLimit=n.pBool(t.EnableUploadSizeLimit,this.EnableUploadSizeLimit),this.PublicFolderName=n.pString(t.PublicFolderName,this.PublicFolderName),this.PublicHash=n.pString(t.PublicHash,this.PublicHash),this.UploadSizeLimitMb=n.pNonNegativeInt(t.UploadSizeLimitMb,this.UploadSizeLimitMb),this.UserSpaceLimitMb=n.pNonNegativeInt(t.UserSpaceLimitMb,this.UserSpaceLimitMb),this.TenantSpaceLimitMb=n.pNonNegativeInt(t.TenantSpaceLimitMb,this.TenantSpaceLimitMb)),this.ShowPersonalFilesAdminSection=!0,s.isEmpty(i)||(this.ShowCorporateFilesAdminSection=!0,this.CorporateSpaceLimitMb=n.pNonNegativeInt(i.SpaceLimitMb,this.CorporateSpaceLimitMb)),s.isEmpty(o)||(this.EditFileNameWithoutExtension=n.pBool(o.EditFileNameWithoutExtension,this.EditFileNameWithoutExtension),this.ShowCommonSettings=n.pBool(o.ShowCommonSettings,this.ShowCommonSettings),this.ShowFilesApps=n.pBool(o.ShowFilesApps,this.ShowFilesApps),this.BottomLeftCornerLinks=n.pArray(o.BottomLeftCornerLinks,this.BottomLeftCornerLinks),this.PublicLinksEnabled=n.pBool(o.PublicLinksEnabled,this.PublicLinksEnabled))},updateAdmin:function(e,t){this.EnableUploadSizeLimit=e,this.UploadSizeLimitMb=t},updateAdminPersonal:function(e){this.PersonalSpaceLimitMb=e},updateAdminCorporate:function(e){this.CorporateSpaceLimitMb=e}}},"K+UY":function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"MailChangePasswordPoppassdPlugin",HashModuleName:"mail-poppassd-plugin",SupportedServers:"",Host:"",Port:0,init:function(e){var t=e.MailChangePasswordPoppassdPlugin;s.isEmpty(t)||(this.SupportedServers=n.pString(t.SupportedServers,this.SupportedServers),this.Host=n.pString(t.Host,this.Host),this.Port=n.pNonNegativeInt(t.Port,this.Port))},updateAdmin:function(e,t,i){this.SupportedServers=n.pString(e,this.SupportedServers),this.Host=n.pString(t,this.Host),this.Port=n.pNonNegativeInt(i,this.Port)}}},KA8O:function(e,t,i){"use strict";var s=i("o0Bx"),n=i("tqo6");s.registerAbortRequestHandler(n.ServerModuleName,(function(e,t){switch(e.Method){case"UpdateEvent":var i=e.Parameters,s=t.Parameters;return"UpdateEvent"===t.Method&&s.calendarId===i.calendarId&&s.uid===i.uid;case"GetCalendars":return"GetCalendars"===t.Method;case"GetEvents":return"GetEvents"===t.Method}return!1})),e.exports={send:function(e,t,i,o,r){s.send(r||n.ServerModuleName,e,t,i,o)}}},KARm:function(e,t,i){"use strict";var s=i("F/us"),n=i("cyfa");function o(){this.aCollection=[]}o.prototype.parse=function(e){var t=e?e["@Collection"]:[];this.aCollection=[],s.isArray(t)&&(this.aCollection=s.map(t,(function(e){var t=new n;return t.parse(e),t})))},o.prototype.addCollection=function(e){s.each(e,(function(e){s.find(this.aCollection,(function(t){return e.sEmail===t.sEmail}))||this.aCollection.push(e)}),this)},o.prototype.excludeCollection=function(e){s.each(e,(function(e){this.aCollection=s.filter(this.aCollection,(function(t){return e.sEmail.toLowerCase()!==t.sEmail.toLowerCase()}))}),this)},o.prototype.getFirstEmail=function(){return this.aCollection.length>0?this.aCollection[0].getEmail():""},o.prototype.getFirstName=function(){return this.aCollection.length>0?this.aCollection[0].getName():""},o.prototype.getFirstDisplay=function(){return this.aCollection.length>0?this.aCollection[0].getDisplay():""},o.prototype.getDisplay=function(e,t){return s.map(this.aCollection,(function(i){return e&&t===i.sEmail?e:i.getDisplay(e)})).join(", ")},o.prototype.getFull=function(){return s.map(this.aCollection,(function(e){return e.getFull()})).join(", ")},o.prototype.getEmails=function(){return s.map(this.aCollection,(function(e){return e.getEmail()}))},e.exports=o},"KSC/":function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("9oTK"),a=i("RN+F"),l=i("AFLV"),h=i("IAk5"),u=i("SQrT"),c=i("QaF5"),d=i("xcwT"),p=i("YUUU"),m=i("pvQt"),g=i("TAkd"),f=i("61ci"),b=i("o0Wm");function v(){d.call(this,"AdminPanelWebclient"),this.tenants=m.tenants,this.selectedTenant=m.selectedTenant,this.currentEntityType=o.observable(""),this.currentEntitiesId=o.observable({}),this.lastSavedEntitiesId=o.observable({}),this.showTenantsSelector=o.computed((function(){return f.EnableMultiTenant&&this.tenants().length>1}),this),this.bShowLogout=h.getUserRole()===Enums.UserRole.SuperAdmin,this.aScreens=[],h.getUserRole()===Enums.UserRole.SuperAdmin&&this.aScreens.push({linkHash:o.observable(c.buildHashFromArray(p.get(""))),sLinkText:a.i18n("ADMINPANELWEBCLIENT/HEADING_SYSTEM_SETTINGS_TABNAME"),sType:"",oView:null}),s.each(g.getData(),s.bind((function(e){var t=new b(e.Type),i=s.bind((function(e,t,i){if("create"===i)this.openCreateEntity();else if(e===this.currentEntityType())this.changeEntity(e,t,i||"");else{var n=s.clone(this.currentEntitiesId());l.isNumber(t)?e&&(n[e]=t,delete n[this.currentEntityType()]):n[e]&&delete n[e],c.replaceHash(p.get(this.currentEntityType(),n,""))}}),this);t.setChangeEntityHandler(i),this.aScreens.push({linkHash:o.computed((function(){var t=s.clone(this.lastSavedEntitiesId());return s.extend(t,this.currentEntitiesId()),c.buildHashFromArray(p.get(e.Type,t))}),this),sLinkText:a.i18n(e.LinkTextKey),sType:e.Type,oView:t})}),this)),this.currentEntitiesView=o.computed((function(){var e=this.currentEntityType(),t=s.find(this.aScreens,(function(t){return t.sType===e}));return t?t.oView:null}),this),this.currentEntitiesView.subscribe((function(){this.currentEntitiesView()&&this.currentEntitiesView().onHide()}),this,"beforeChange"),this.currentEntitiesView.subscribe((function(){this.currentEntitiesView()&&this.currentEntitiesView().onShow()}),this),this.tabs=o.observableArray([]),this.visibleTabsCount=o.computed((function(){var e=0;return s.each(this.tabs(),(function(t){t.view&&(void 0===t.view.visible||t.view.visible())&&e++})),e}),this),this.showModulesTabs=o.computed((function(){return""===this.currentEntityType()||this.currentEntitiesView().hasSelectedEntity()}),this),this.currentTab=o.observable(null),this.aStartErrors=[],h.subscribeEvent("SendAjaxRequest::before",this.onAjaxSend.bind(this)),h.broadcastEvent("AdminPanelWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}s.extendOwn(v.prototype,d.prototype),v.prototype.ViewTemplate="AdminPanelWebclient_SettingsView",v.prototype.ViewConstructorName="CSettingsView",v.prototype.onAjaxSend=function(e){""===this.currentEntityType()||e.Parameters.TenantId||(e.Parameters.TenantId=m.selectedTenantId())},v.prototype.selectTenant=function(e){if(!this.currentEntitiesView()||"Tenant"!==this.currentEntitiesView().sType||this.currentEntitiesView().hasEntity(e)){var t=s.clone(this.currentEntitiesId());t.Tenant=e,c.setHash(p.get(this.currentEntityType(),t))}else{var i=s.findIndex(m.tenants(),(function(t){return t.Id===e})),n=Math.ceil((i+1)/f.EntitiesPerPage);this.currentEntitiesView().setPageAndEntity(n,e)}},v.prototype.registerTab=function(e,t,i){if(s.isFunction(e)){var n=this.tabs;return new r(e).then((function(e){n.push({view:e,name:t,title:i})}),(function(e){console.log("failed to load settings tab",e)}))}return!1},v.prototype.sortRegisterTabs=function(){this.tabs(s.sortBy(this.tabs(),(function(e){var t=s.indexOf(f.TabsOrder,e.name);return-1!==t?t:f.TabsOrder.length})))},v.prototype.registerTabSection=function(e,t){var i=s.findWhere(this.tabs(),{name:t}),n=e();i&&i.view.addSettingsSection(n)},v.prototype.cancelCreatingEntity=function(){c.setHash(p.get(this.currentEntityType(),this.currentEntitiesId(),""))},v.prototype.openCreateEntity=function(){if(g.getEntityData(this.currentEntityType()).CreateRequest){var e=s.clone(this.currentEntitiesId());delete e[this.currentEntityType()],"Tenant"!==this.currentEntityType()&&!e.Tenant&&m.selectedTenantId()&&(e.Tenant=m.selectedTenantId()),c.setHash(p.get(this.currentEntityType(),e,"create"))}},v.prototype.changeEntity=function(e,t,i){var n=s.clone(this.currentEntitiesId()),o=!!s.find(this.tabs(),(function(e){return e.name===i})),r=this.currentTab()?this.currentTab().name:"";e&&(n[e]=t),"Tenant"!==e&&m.selectedTenantId()&&(n.Tenant=m.selectedTenantId()),c.setHash(p.get(e,n,o?i:r))},v.prototype.onBind=function(){if(s.each(this.tabs(),s.bind((function(e){if(e.view&&s.isFunction(e.view.getStartError)){var t=e.view.getStartError();s.isFunction(t)&&(t.subscribe((function(){this.showStartError()}),this),this.aStartErrors.push(t))}}),this)),f&&s.isFunction(f.getStartError)){var e=f.getStartError();s.isFunction(e)&&(e.subscribe((function(){this.showStartError()}),this),this.aStartErrors.push(e))}this.showStartError()},v.prototype.showStartError=function(){var e=[];s.each(this.aStartErrors,(function(t){var i=t();""!==i&&e.push(i)})),u.showError(e.join("<br /><br />"),!0)},v.prototype.onRoute=function(e){var t=p.parse(e);if(!s.find(this.aScreens,(function(e){return e.sType===t.CurrentType}))&&this.aScreens.length>0)c.replaceHash(p.get(this.aScreens[0].sType,[],""));else{var i=e.slice(1),o=this.currentEntityType()===t.CurrentType,r=this.currentEntitiesId()[t.CurrentType]===t.Entities[t.CurrentType],a=this.currentTab()&&this.currentTab().name===t.Last,l=JSON.stringify(this.currentEntitiesId())===JSON.stringify(t.Entities),h=this.currentTab(),u=s.bind((function(){this.showNewScreenView(t),this.showNewTabView(t.Last,i)}),this),d=s.bind((function(){h&&(c.stopListening(),c.setPreviousHash(),c.startListening())}),this);o&&r&&a&&l?h&&h.view.onRoute(i,this.currentEntitiesId()):h&&n.isFunction(h.view.hide)?h.view.hide(u,d):u()}},v.prototype.showNewScreenView=function(e){var t=s.find(this.aScreens,(function(t){return t.sType===e.CurrentType}));if(this.currentEntityType(e.CurrentType),this.currentEntitiesId(e.Entities),s.isEmpty(e.Entities)||this.lastSavedEntitiesId(e.Entities),m.setSelectedTenant(e.Entities.Tenant),t&&t.oView){var i=t.oView.oEntityData?t.oView.oEntityData.CreateRequest:"";"create"===e.Last&&l.isNonEmptyString(i)?t.oView.openCreateForm():t.oView.cancelCreatingEntity(),t.oView.changeEntity(e.Entities[e.CurrentType],e.Entities)}},v.prototype.showNewTabView=function(e,t){s.each(this.tabs(),s.bind((function(e){e.view&&s.isFunction(e.view.setAccessLevel)&&(e.view.setAccessLevel(this.currentEntityType(),this.currentEntitiesId()[this.currentEntityType()]),s.each(e.view.aSettingsSections,(function(e){s.isFunction(e.setAccessLevel)&&e.setAccessLevel(this.currentEntityType(),this.currentEntitiesId()[this.currentEntityType()])}),this))}),this));var i=s.find(this.tabs(),(function(t){return t.name===e}));i&&i.view&&i.view.visible()||(i=s.find(this.tabs(),(function(e){return e.view&&e.view.visible()}))),i&&(n.isFunction(i.view.onRoute)&&i.view.onRoute(t,this.currentEntitiesId()),this.currentTab(i))},v.prototype.changeTab=function(e){var t=this.currentEntityType()?this.currentEntitiesId():{};c.setHash(p.get(this.currentEntityType(),t,e))},v.prototype.logout=function(){h.logout()},v.prototype.deleteCurrentEntity=function(){this.currentEntitiesView()&&this.currentEntitiesView().deleteCurrentEntity()},v.prototype.setAddHash=function(e){c.setHash(s.union([f.HashModuleName,this.currentTab()?this.currentTab().name:""],e))},e.exports=new v},MHRZ:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("HLSX"),l=i("76Kh"),h=i("czxF"),u=i("5H03"),c=i("NTez");function d(){h.call(this),c.call(this),this.minimized=o.observable(!1),this.fPreventBackspace=function(e){var t=e.which===n.ui.keyCode.BACKSPACE,i="INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName,s="DIV"===e.target.tagName&&"true"===n(e.target).attr("contenteditable");!t||i||s||(e.preventDefault(),e.stopPropagation())},this.minimized.subscribe((function(){this.minimized()?this.preventBackspaceOff():this.shown()&&this.preventBackspaceOn()}),this),this.minimizedTitle=o.computed((function(){return this.subject()||r.i18n("MAILWEBCLIENT/HEADING_MINIMIZED_NEW_MESSAGE")}),this)}s.extendOwn(d.prototype,h.prototype),s.extendOwn(d.prototype,c.prototype),d.prototype.PopupTemplate="MailWebclient_ComposePopup",d.prototype.preventBackspaceOn=function(){n(document).on("keydown",this.fPreventBackspace)},d.prototype.preventBackspaceOff=function(){n(document).off("keydown",this.fPreventBackspace)},d.prototype.onClose=function(){this.preventBackspaceOff()},d.prototype.onOpen=function(e){if(1===(e=e||[]).length&&"close"===e[0])this.closePopup();else{var t=3===e.length&&"drafts"===e[0]&&e[2]===this.draftUid(),i=this.minimized();this.maximize(),this.shown()||i?(e.length>0&&!t?this.hasUnsavedChanges()?(this.disableAutosave(!0),l.showPopup(u,[s.bind((function(t){switch(t){case Enums.AnotherMessageComposedAnswer.Discard:this.onRoute(e);break;case Enums.AnotherMessageComposedAnswer.SaveAsDraft:this.hasUnsavedChanges()&&this.executeSave(!0,!1),this.onRoute(e);break;case Enums.AnotherMessageComposedAnswer.Cancel:}this.disableAutosave(!1)}),this)])):this.onRoute(e):i||this.onRoute(e),this.oHtmlEditor.clearUndoRedo()):this.onRoute(e),this.preventBackspaceOn()}},d.prototype.minimize=function(){this.minimized(!0),this.$popupDom&&this.$popupDom.addClass("minimized")},d.prototype.maximize=function(){this.minimized(!1),this.$popupDom&&this.$popupDom.removeClass("minimized")},d.prototype.saveAndClose=function(){this.hasUnsavedChanges()&&this.saveCommand(),setTimeout(this.closePopup.bind(this),0)},d.prototype.cancelPopup=function(){this.hasUnsavedChanges()?this.minimize():this.closePopup()},d.prototype.onEscHandler=function(e){var t=this.oHtmlEditor.hasOpenedPopup(),i=!a.ie&&e.target&&"input"===e.target.tagName.toLowerCase()&&"file"===e.target.type.toLowerCase();i&&e.target.blur(),!l.hasOnlyOneOpenedPopup()||t||i||this.minimize(),t&&this.oHtmlEditor.closeAllPopups()},e.exports=new d},NTez:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("Ol7c"),a=i("QFUI"),l=i("RN+F"),h=i("AFLV"),u=i("Yjhd"),c=i("IAk5"),d=i("HLSX"),p=i("mjrp"),m=i("OgeD"),g=i("QaF5"),f=i("SQrT"),b=i("hPb3"),v=i("ZCBP"),y=i("xcwT"),E=i("76Kh"),S=i("1grR"),A=m.run("FilesWebclient","getSelectFilesPopup"),I=i("4M/5"),T=i("Cq+9"),C=i("jonm"),F=i("o0Bx"),L=i("UN2P"),M=i("4+IO"),w=i("dKfC"),N=i("UvKh"),R=i("p2hp"),D=i("Nfk5"),P=i("XTZw"),U=i("GdT1"),O=i("a28q"),x=c.isNewTab()&&window.opener&&window.opener.MainTabMailMethods,B=n("html");function _(){y.call(this,"MailWebclient"),U.call(this),this.browserTitle=o.computed((function(){return C.getEmail()+" - "+l.i18n("MAILWEBCLIENT/HEADING_COMPOSE_BROWSER_TAB")}));var e=this;this.toAddrDom=o.observable(),this.toAddrDom.subscribe((function(){this.initInputosaurus(this.toAddrDom,this.toAddr,this.lockToAddr,"to")}),this),this.ccAddrDom=o.observable(),this.ccAddrDom.subscribe((function(){this.initInputosaurus(this.ccAddrDom,this.ccAddr,this.lockCcAddr,"cc")}),this),this.bccAddrDom=o.observable(),this.bccAddrDom.subscribe((function(){this.initInputosaurus(this.bccAddrDom,this.bccAddr,this.lockBccAddr,"bcc")}),this),this.folderList=M.folderList,this.folderList.subscribe((function(){this.getMessageOnRoute()}),this),this.bNewTab=c.isNewTab(),this.bDemo=b.IsDemo,this.sending=o.observable(!1),this.saving=o.observable(!1),this.oHtmlEditor=new O(!1,this),this.visibleBcc=o.observable(!1),this.visibleBcc.subscribe((function(){B.toggleClass("screen-compose-bcc",this.visibleCc()),s.defer(s.bind((function(){n(this.bccAddrDom()).inputosaurus("resizeInput")}),this))}),this),this.visibleCc=o.observable(!1),this.visibleCc.subscribe((function(){B.toggleClass("screen-compose-cc",this.visibleCc()),s.defer(s.bind((function(){n(this.ccAddrDom()).inputosaurus("resizeInput")}),this))}),this),this.sendReadingConfirmation=o.observable(!1).extend({reversible:!0}),this.composeUploaderButton=o.observable(null),this.composeUploaderButton.subscribe((function(){this.initUploader()}),this),this.composeUploaderDropPlace=o.observable(null),this.composeUploaderBodyDragOver=o.observable(!1),this.composeUploaderDragOver=o.observable(!1),this.allowDragNDrop=o.observable(!1),this.uploaderBodyDragOver=o.computed((function(){return this.allowDragNDrop()&&this.composeUploaderBodyDragOver()}),this),this.uploaderDragOver=o.computed((function(){return this.allowDragNDrop()&&this.composeUploaderDragOver()}),this),this.selectedImportance=o.observable(Enums.Importance.Normal).extend({reversible:!0}),this.senderAccountId=N.senderAccountId,this.senderList=N.senderList,this.visibleFrom=o.computed((function(){return c.isNewTab()||this.senderList().length>1||this.senderAccountId()!==M.currentAccountId()}),this),this.selectedSender=N.selectedSender,this.selectedFetcherOrIdentity=N.selectedFetcherOrIdentity,this.selectedFetcherOrIdentity.subscribe((function(){this.oHtmlEditor.isEditing()||(this.oHtmlEditor.clearUndoRedo(),this.oHtmlEditor.commit())}),this),this.signature=o.observable(""),this.prevSignature=o.observable(null),o.computed((function(){var e=T.getClearSignature(this.senderAccountId(),this.selectedFetcherOrIdentity());null===this.prevSignature()?(this.prevSignature(e),this.signature(e)):(this.prevSignature(this.signature()),this.signature(e),this.oHtmlEditor.changeSignatureContent(this.signature(),this.prevSignature()))}),this),this.lockToAddr=o.observable(!1),this.toAddr=o.observable("").extend({reversible:!0}),this.toAddr.subscribe((function(){this.lockToAddr()||(n(this.toAddrDom()).val(this.toAddr()),n(this.toAddrDom()).inputosaurus("refresh"))}),this),this.lockCcAddr=o.observable(!1),this.ccAddr=o.observable("").extend({reversible:!0}),this.ccAddr.subscribe((function(){this.lockCcAddr()||(n(this.ccAddrDom()).val(this.ccAddr()),n(this.ccAddrDom()).inputosaurus("refresh"))}),this),this.lockBccAddr=o.observable(!1),this.bccAddr=o.observable("").extend({reversible:!0}),this.bccAddr.subscribe((function(){this.lockBccAddr()||(n(this.bccAddrDom()).val(this.bccAddr()),n(this.bccAddrDom()).inputosaurus("refresh"))}),this),this.recipientEmails=o.computed((function(){var e=[this.toAddr(),this.ccAddr(),this.bccAddr()].join(",").split(","),t=[];return s.each(e,(function(e){var i=n.trim(e),s=null;""!==i&&(s=r.getEmailParts(i)).email&&t.push(s.email)})),t}),this),this.subject=o.observable("").extend({reversible:!0}),this.plainText=o.observable(!1),this.textBody=o.observable(""),this.textBody.subscribe((function(e){this.oHtmlEditor.setText(this.textBody(),this.plainText()),this.oHtmlEditor.commit()}),this),this.focusedField=o.observable(),this.oHtmlEditor.textFocused.subscribe((function(e){this.oHtmlEditor.textFocused()&&this.focusedField("text")}),this),this.subjectFocused=o.observable(!1),this.subjectFocused.subscribe((function(){this.subjectFocused()&&this.focusedField("subject")}),this),this.templateUid=o.observable(""),this.templateFolderName=o.observable(M.getTemplateFolder()),this.draftUid=o.observable(""),this.draftUid.subscribe((function(){M.editedDraftUid(this.draftUid())}),this),this.draftInfo=o.observableArray([]),this.routeType=o.observable(""),this.routeParams=o.observableArray([]),this.inReplyTo=o.observable(""),this.references=o.observable(""),this.bUploadStatus=!1,this.iUploadAttachmentsTimer=0,this.messageUploadAttachmentsStarted=o.observable(!1),this.messageUploadAttachmentsStarted.subscribe((function(t){window.clearTimeout(e.iUploadAttachmentsTimer),t?e.iUploadAttachmentsTimer=window.setTimeout((function(){e.bUploadStatus=!0,f.showLoading(l.i18n("MAILWEBCLIENT/INFO_ATTACHMENTS_LOADING"))}),4e3):e.bUploadStatus?e.iUploadAttachmentsTimer=window.setTimeout((function(){e.bUploadStatus=!1,f.hideLoading()}),1e3):f.hideLoading()}),this),this.attachments=o.observableArray([]),this.attachmentsChanged=o.observable(!1),this.attachments.subscribe((function(){this.attachmentsChanged(!0)}),this),this.notUploadedAttachments=o.computed((function(){return s.filter(this.attachments(),(function(e){return!e.uploaded()}))}),this),this.allAttachmentsUploaded=o.computed((function(){return 0===this.notUploadedAttachments().length&&!this.messageUploadAttachmentsStarted()}),this),this.notInlineAttachments=o.computed((function(){return s.filter(this.attachments(),(function(e){return!e.linked()}))}),this),this.notInlineAttachments.subscribe((function(){B.toggleClass("screen-compose-attachments",this.notInlineAttachments().length>0)}),this),this.allowStartSending=o.computed((function(){return!this.saving()}),this),this.allowStartSending.subscribe((function(){this.allowStartSending()&&this.requiresPostponedSending()&&(T.sendPostponedMail(this.draftUid()),this.requiresPostponedSending(!1))}),this),this.requiresPostponedSending=o.observable(!1),this.oJua=null,this.isDraftsCleared=o.observable(!1),this.backToListOnSendOrSave=o.observable(!1),this.composeShown=o.computed((function(){return!!this.opened&&this.opened()||!!this.shown&&this.shown()}),this),this.toolbarControllers=o.observableArray([]),this.disableHeadersEdit=o.computed((function(){var e=!1;return s.each(this.toolbarControllers(),(function(t){e=e||!!t.disableHeadersEdit&&t.disableHeadersEdit()})),e}),this),this.disableFromEdit=o.computed((function(){var e=!1;return s.each(this.toolbarControllers(),(function(t){e=e||!!t.disableFromEdit&&t.disableFromEdit()})),e}),this),this.messageSignedOrEncrypted=o.computed((function(){var e=!1;return s.each(this.toolbarControllers(),(function(t){s.isFunction(t.pgpEncrypted)&&s.isFunction(t.pgpSecured)&&(e=e||t.pgpEncrypted()||t.pgpSecured())})),e}),this),o.computed((function(){var e=!1;s.each(this.toolbarControllers(),(function(t){e=e||!!t.disableBodyEdit&&t.disableBodyEdit()})),this.oHtmlEditor.setDisableEdit(e)}),this),this.draftFolderIsAvailable=o.computed((function(){return!!M.folderList().draftsFolder()}),this),this.disableAutosave=o.observable(!1),R.AllowAutosaveInDrafts&&R.AutoSaveIntervalSeconds>0&&(this.iAutosaveInterval=-1,o.computed((function(){var e=this.draftFolderIsAvailable()&&this.composeShown()&&!this.sending()&&!this.saving()&&!this.disableAutosave()&&!M.disableComposeAutosave();s.each(this.toolbarControllers(),(function(t){e=e&&!(t.disableAutosave&&t.disableAutosave())})),window.clearInterval(this.iAutosaveInterval),e&&(this.iAutosaveInterval=window.setInterval(s.bind(this.executeSave,this,!0),1e3*R.AutoSaveIntervalSeconds))}),this)),this.backToListCommand=u.createCommand(this,this.executeBackToList),this.sendCommand=u.createCommand(this,this.executeSend,this.isEnableSending),this.saveCommand=u.createCommand(this,this.executeSaveCommand,this.isEnableSaving),this.visibleSaveTemplateControl=o.observable(!1),this.saveTemplateCommand=u.createCommand(this,this.executeTemplateSaveCommand,this.isEnableSaving),this.messageFields=o.observable(null),this.bottomPanel=o.observable(null),this.sHotkeysHintsViewTemplate=d.mobileDevice?"":"MailWebclient_Compose_HotkeysHintsView",this.sPopupButtonsViewTemplate=c.isNewTab()?"":"MailWebclient_Compose_PopupButtonsView",this.aHotkeys=[{value:"Ctrl+S",action:l.i18n("MAILWEBCLIENT/LABEL_SAVE_HOTKEY"),visible:this.draftFolderIsAvailable},{value:"Ctrl+Z",action:l.i18n("MAILWEBCLIENT/LABEL_UNDO_HOTKEY"),visible:o.observable(!0)},{value:"Ctrl+Y",action:l.i18n("MAILWEBCLIENT/LABEL_REDO_HOTKEY"),visible:o.observable(!0)},{value:"Ctrl+K",action:l.i18n("MAILWEBCLIENT/LABEL_LINK_HOTKEY"),visible:o.observable(!0)},{value:"Ctrl+B",action:l.i18n("MAILWEBCLIENT/LABEL_BOLD_HOTKEY"),visible:o.observable(!0)},{value:"Ctrl+I",action:l.i18n("MAILWEBCLIENT/LABEL_ITALIC_HOTKEY"),visible:o.observable(!0)},{value:"Ctrl+U",action:l.i18n("MAILWEBCLIENT/LABEL_UNDERLINE_HOTKEY"),visible:o.observable(!0)}],R.AllowQuickSendOnCompose&&this.aHotkeys.unshift({value:"Ctrl+Enter",action:l.i18n("MAILWEBCLIENT/LABEL_SEND_HOTKEY"),visible:o.observable(!0)}),this.bAllowFiles=!!A,this.ignoreHasUnsavedChanges=o.observable(!1),this.changedInPreviousWindow=o.observable(!1),this.hasUnsavedChanges=o.computed((function(){return!this.ignoreHasUnsavedChanges()&&this.isChanged()&&this.isEnableSaving()}),this),this.saveAndCloseTooltip=o.computed((function(){return this.draftFolderIsAvailable()&&this.hasUnsavedChanges()?l.i18n("MAILWEBCLIENT/ACTION_SAVE_CLOSE"):l.i18n("MAILWEBCLIENT/ACTION_CLOSE")}),this),this.splitterDom=o.observable(),this.headersCompressed=o.observable(!1),this.allowCcBccSwitchers=o.computed((function(){return!this.disableHeadersEdit()&&!this.headersCompressed()}),this),this.registerOwnToolbarControllers(),this.setAutoEncryptSubscribes(),c.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}s.extendOwn(_.prototype,y.prototype),s.extendOwn(_.prototype,U.prototype),_.prototype.ViewTemplate=c.isNewTab()?"MailWebclient_ComposeScreenView":"MailWebclient_ComposeView",_.prototype.ViewConstructorName="CComposeView",_.prototype.isEnableSending=function(){var e=0===this.toAddr().length&&0===this.ccAddr().length&&0===this.bccAddr().length;return this.folderList()&&0!==this.folderList().iAccountId&&!this.sending()&&!e&&this.allAttachmentsUploaded()},_.prototype.isEnableSaving=function(){var e=this.folderList()&&0!==this.folderList().iAccountId;return this.composeShown()&&e&&!this.sending()&&!this.saving()},_.prototype.initInputosaurus=function(e,t,i,o){if(e()&&n(e()).length>0){var r={width:"auto",parseOnBlur:!0,autoCompleteSource:m.run("ContactsWebclient","getSuggestionsAutocompleteCallback",["all","",!0])||function(){},autoCompleteDeleteItem:m.run("ContactsWebclient","getSuggestionsAutocompleteDeleteHandler")||function(){},autoCompleteAppendTo:n(e()).closest("td"),change:s.bind((function(e){i(!0),this.setRecipient(t,e.target.value),i(!1)}),this),copy:s.bind((function(e){this.inputosaurusBuffer=e}),this),paste:s.bind((function(){var e=this.inputosaurusBuffer||"";return this.inputosaurusBuffer="",e}),this),focus:s.bind(this.focusedField,this,o),mobileDevice:d.mobileDevice};n(e()).inputosaurus(s.extendOwn(r,this.getInputosaurusMethods()))}},_.prototype.changeHeadersCompressed=function(){this.headersCompressed(!this.headersCompressed())},_.prototype.onBind=function(){m.run("SessionTimeoutWeblient","registerFunction",[s.bind(this.executeSave,this,!1)]),c.isMobile()||this.hotKeysBind()},_.prototype.hotKeysBind=function(){(this.$popupDom||this.$viewDom).on("keydown",n.proxy((function(e){if(e&&e.ctrlKey&&!e.altKey&&!e.shiftKey){var t=e.keyCode,i=this.composeShown()&&(!this.minimized||!this.minimized())&&e&&e.ctrlKey;i&&t===Enums.Key.s?(e.preventDefault(),e.returnValue=!1,this.isEnableSaving()&&this.saveCommand()):R.AllowQuickSendOnCompose&&i&&t===Enums.Key.Enter&&""!==this.toAddr()&&this.sendCommand()}}),this))},_.prototype.getMessageOnRoute=function(){var e=I.parseCompose(this.routeParams()),t=C.getAccountByHash(e.AccountHash);t&&""!==this.routeType()&&e.MessageFolderName&&e.MessageUid&&M.getMessage(t.id(),e.MessageFolderName,e.MessageUid,this.onMessageResponse,this)},_.prototype.onShow=function(){this.reset();var e=this.focusedField();n(this.splitterDom()).trigger("resize"),n(this.bottomPanel()).trigger("resize"),this.oHtmlEditor.init(this.textBody(),this.plainText(),"7"),this.oHtmlEditor.commit(),this.initUploader(),this.backToListOnSendOrSave(!1),this.focusedField(e),B.addClass("screen-compose"),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0),this.visibleSaveTemplateControl(M.getCurrentTemplateFolders().length>0)},_.prototype.reset=function(){this.plainText(!1),this.textBody(""),this.bUploadStatus=!1,window.clearTimeout(this.iUploadAttachmentsTimer),this.messageUploadAttachmentsStarted(!1),this.templateUid(""),this.templateFolderName(M.getTemplateFolder()),this.draftUid(""),this.draftInfo.removeAll(),this.setDataFromMessage(new D),this.isDraftsCleared(!1),this.ignoreHasUnsavedChanges(!1)},_.prototype.onRoute=function(e){this.setDataFromMessage(new D);var t=I.parseCompose(e);switch(c.isNewTab()&&C.changeCurrentAccountByHash(t.AccountHash),this.routeType(t.RouteType),this.routeType()){case Enums.ReplyType.ForwardAsAttach:this.routeParams(e),this.fillDefault(t);case Enums.ReplyType.Reply:case Enums.ReplyType.ReplyAll:case Enums.ReplyType.Resend:case Enums.ReplyType.Forward:case"drafts":this.routeParams(e),0!==this.folderList().iAccountId&&this.getMessageOnRoute();break;case"data":var i=t.Object;if(i){i.to&&this.setRecipient(this.toAddr,i.to),i.subject&&this.subject(i.subject),i.isHtml||this.plainText(!0),i.selectedSenderId&&this.selectedSender(i.selectedSenderId);var s="<div></div>";if(i.body&&(s=i.isHtml?"<div>"+i.body+"</div>":i.body,this.textBody(s)),i.replyToMessage){var n=T.getReplyDataFromMessage(i.replyToMessage,Enums.ReplyType.Reply,c.currentAccountId(),null,!0);this.plainText(!1),this.draftInfo(n.DraftInfo),this.draftUid(n.DraftUid),this.setRecipient(this.toAddr,n.To),this.setRecipient(this.ccAddr,n.Cc),this.setRecipient(this.bccAddr,n.Bcc),this.subject(n.Subject),this.textBody(n.Text),this.attachments(n.Attachments),this.inReplyTo(n.InReplyTo),this.references(n.References),this.requestAttachmentsTempName()}i.attachments&&this.addAttachments(i.attachments),this.triggerToolbarControllersAfterPopulatingMessage(!0,!i.isHtml,s),this.commit(!0)}break;default:this.routeParams(e),this.fillDefault(t)}},_.prototype.fillDefault=function(e){var t=T.getSignatureText(this.senderAccountId(),this.selectedFetcherOrIdentity(),!0),i=x?x.getComposedMessage(window.name):null,n=e.ToAddr;i?(this.setMessageDataInNewTab(i),this.changedInPreviousWindow()&&s.defer(s.bind(this.executeSave,this,!0))):""!==t&&this.textBody("<br /><br />"+t+"<br />"),n&&(this.setRecipient(this.toAddr,n.to),n.hasMailto&&(this.subject(n.subject),this.setRecipient(this.ccAddr,n.cc),this.setRecipient(this.bccAddr,n.bcc),""!==n.body&&this.textBody("<div>"+n.body+"</div>"))),this.routeType()===Enums.ReplyType.ForwardAsAttach&&e.Object&&this.addMessageAsAttachment(e.Object),"attachments"===this.routeType()&&e.Object&&this.addAttachments(e.Object),s.defer(s.bind((function(){this.focusAfterFilling()}),this)),this.visibleCc(""!==this.ccAddr()),this.visibleBcc(""!==this.bccAddr()),this.commit(!0)},_.prototype.focusToAddr=function(){n(this.toAddrDom()).inputosaurus("focus")},_.prototype.focusCcAddr=function(){n(this.ccAddrDom()).inputosaurus("focus")},_.prototype.focusBccAddr=function(){n(this.bccAddrDom()).inputosaurus("focus")},_.prototype.focusAfterFilling=function(){switch(this.focusedField()){case"to":this.focusToAddr();break;case"cc":this.visibleCc(!0),this.focusCcAddr();break;case"bcc":this.visibleBcc(!0),this.focusBccAddr();break;case"subject":this.subjectFocused(!0);break;case"text":this.oHtmlEditor.setFocus();break;default:0===this.toAddr().length?this.focusToAddr():0===this.subject().length?this.subjectFocused(!0):this.oHtmlEditor.setFocus()}},_.prototype.onHide=function(){!s.isFunction(this.closePopup)&&this.hasUnsavedChanges()&&this.executeSave(!0),this.headersCompressed(!1),this.routeParams([]),this.subjectFocused(!1),this.focusedField(""),this.messageUploadAttachmentsStarted(!1),B.removeClass("screen-compose").removeClass("screen-compose-cc").removeClass("screen-compose-bcc").removeClass("screen-compose-attachments"),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1),this.recipientsInfo({}),this.recipientsInfo.valueHasMutated()},_.prototype.setRecipient=function(e,t){e()===t?e.valueHasMutated():e(t)},_.prototype.onMessageResponse=function(e){var t=null;if(null===e)this.setDataFromMessage(new D);else{switch(this.routeType()){case Enums.ReplyType.Reply:case Enums.ReplyType.ReplyAll:N.setFetcherOrIdentityByReplyMessage(e),t=T.getReplyDataFromMessage(e,this.routeType(),this.senderAccountId(),this.selectedFetcherOrIdentity(),!0),this.draftInfo(t.DraftInfo),this.draftUid(t.DraftUid),this.setRecipient(this.toAddr,t.To),this.setRecipient(this.ccAddr,t.Cc),this.setRecipient(this.bccAddr,t.Bcc),this.subject(t.Subject),this.textBody(t.Text),this.attachments(t.Attachments),this.inReplyTo(t.InReplyTo),this.references(t.References);break;case Enums.ReplyType.ForwardAsAttach:t=T.getReplyDataFromMessage(e,this.routeType(),this.senderAccountId(),this.selectedFetcherOrIdentity(),!0),this.draftInfo(t.DraftInfo),this.draftUid(t.DraftUid),this.inReplyTo(t.InReplyTo),this.references(t.References);break;case Enums.ReplyType.Forward:N.setFetcherOrIdentityByReplyMessage(e),t=T.getReplyDataFromMessage(e,this.routeType(),this.senderAccountId(),this.selectedFetcherOrIdentity(),!0),this.draftInfo(t.DraftInfo),this.draftUid(t.DraftUid),this.setRecipient(this.toAddr,t.To),this.setRecipient(this.ccAddr,t.Cc),this.subject(t.Subject),this.textBody(t.Text),this.attachments(t.Attachments),this.inReplyTo(t.InReplyTo),this.references(t.References);break;case Enums.ReplyType.Resend:this.setDataFromMessage(e);break;case"drafts":if(-1!==n.inArray(e.folder(),M.getCurrentTemplateFolders()))this.templateUid(e.uid()),this.templateFolderName(e.folder());else{var i=M.oFolderListItems[e.accountId()];(i?i.draftsFolderFullName():"")===e.folder()&&this.draftUid(e.uid())}this.setDataFromMessage(e)}this.routeType()!==Enums.ReplyType.ForwardAsAttach&&this.attachments().length>0&&this.requestAttachmentsTempName(),this.routeType("")}if(this.visibleCc(""!==this.ccAddr()),this.visibleBcc(""!==this.bccAddr()),this.commit(!0),s.defer(s.bind((function(){this.focusAfterFilling()}),this)),e){var o={AccountId:e.accountId(),FolderFullName:e.folder(),MessageUid:e.uid(),Compose:this};if(this.allAttachmentsUploaded())c.broadcastEvent("MailWebclient::ComposeMessageLoaded",o);else var r=this.allAttachmentsUploaded.subscribe((function(){this.allAttachmentsUploaded()&&c.broadcastEvent("MailWebclient::ComposeMessageLoaded",o),r.dispose()}),this)}},_.prototype.setDataFromMessage=function(e){var t="",i=T.getFirstFetcherOrIdentityByRecipientsOrDefault(e.oFrom.aCollection,e.accountId());N.changeSenderAccountId(e.accountId(),i),t=e.isPlain()?e.textRaw():e.getConvertedHtml(),this.draftInfo(e.draftInfo()),this.inReplyTo(e.inReplyTo()),this.references(e.references()),this.setRecipient(this.toAddr,e.oTo.getFull()),this.setRecipient(this.ccAddr,e.oCc.getFull()),this.setRecipient(this.bccAddr,e.oBcc.getFull()),this.subject(e.subject()),this.attachments(e.attachments()),this.plainText(e.isPlain()),this.textBody(t),this.selectedImportance(e.importance()),this.sendReadingConfirmation(""!==e.readingConfirmationAddressee());var s=!!e.folderObject()&&e.folderObject().type()===Enums.FolderTypes.Drafts;this.triggerToolbarControllersAfterPopulatingMessage(s,e.isPlain(),e.textRaw(),e.sensitivity())},_.prototype.triggerToolbarControllersAfterPopulatingMessage=function(e,t,i,n){s.each(this.toolbarControllers(),function(o){s.isFunction(o.doAfterPopulatingMessage)&&o.doAfterPopulatingMessage({bDraft:e,bPlain:t,sRawText:i,iSensitivity:n})}.bind(this))},_.prototype.onDataAsAttachmentUpload=function(e,t){var i=t.Parameters,n=e.Result,o=i.Hash,r=s.find(this.attachments(),(function(e){return e.hash()===o}));this.messageUploadAttachmentsStarted(!1),r&&(n&&n.Attachment?r.parseFromUpload(n.Attachment):r.errorFromUpload())},_.prototype.addAttachments=function(e){s.each(e,s.bind((function(e){var t=new P(this.senderAccountId());t.parseFromUpload(e),this.attachments.push(t)}),this))},_.prototype.addFilesAsAttachment=function(e){var t=null,i=[];s.each(e,(function(e){(t=new P(this.senderAccountId())).fileName(e.fileName()),t.hash(e.hash()),t.thumbUrlInQueue(e.thumbUrlInQueue()),t.uploadStarted(!0),this.attachments.push(t),i.push(e.hash())}),this),i.length>0&&(this.messageUploadAttachmentsStarted(!0),F.send("Files","GetFilesForUpload",{Hashes:i},this.onFilesUpload,this))},_.prototype.onFilesUpload=function(e,t){var i=t.Parameters,n=e.Result,o=i.Hashes;this.messageUploadAttachmentsStarted(!1),s.isArray(n)?s.each(n,(function(e){var t=s.find(this.attachments(),(function(t){return t.hash()===e.Hash}));t&&(t.parseFromUpload(e),t.hash(e.NewHash))}),this):s.each(o,(function(e){var t=s.find(this.attachments(),(function(t){return t.hash()===e}));t&&t.errorFromUpload()}),this)},_.prototype.addMessageAsAttachment=function(e){var t=new P(e.accountId()),i=null;e&&(t.fileName(e.subject()+".eml"),t.uploadStarted(!0),this.attachments.push(t),i={AccountID:e.accountId(),MessageFolder:e.folder(),MessageUid:e.uid(),FileName:t.fileName()},this.messageUploadAttachmentsStarted(!0),L.send("SaveMessageAsTempFile",i,this.onSaveMessageAsTempFile,this))},_.prototype.onSaveMessageAsTempFile=function(e,t){var i=e.Result,n=t.Parameters.FileName,o=null;this.messageUploadAttachmentsStarted(!1),i?(o=s.find(this.attachments(),(function(e){return e.fileName()===n&&e.uploadStarted()})))&&o.parseFromUpload(i,t.Parameters.MessageFolder,t.Parameters.MessageUid):(o=s.find(this.attachments(),(function(e){return e.fileName()===n&&e.uploadStarted()})))&&o.errorFromUpload()},_.prototype.onContactVCardUpload=function(e,t){var i=t.Parameters,n=e.Result,o=null;this.messageUploadAttachmentsStarted(!1),n?(o=s.find(this.attachments(),(function(e){return e.fileName()===n.Name&&e.uploadStarted()})))&&o.parseFromUpload(n):(o=s.find(this.attachments(),(function(e){return e.fileName()===i.Name&&e.uploadStarted()})))&&o.errorFromUpload()},_.prototype.requestAttachmentsTempName=function(){var e=s.map(this.attachments(),(function(e){return e.uploadUid(e.hash()),e.uploadStarted(!0),e.hash()}));e.length>0&&(this.messageUploadAttachmentsStarted(!0),L.send("SaveAttachmentsAsTempFiles",{AccountID:this.senderAccountId(),Attachments:e},this.onMessageUploadAttachmentsResponse,this))},_.prototype.onMessageUploadAttachmentsResponse=function(e,t){var i=t.Parameters.Attachments;this.messageUploadAttachmentsStarted(!1),e.Result?s.each(e.Result,s.bind(this.setAttachTempNameByHash,this)):(s.each(i,(function(e){var t=s.find(this.attachments(),(function(t){return t.hash()===e}));t&&t.errorFromUpload()}),this),f.showError(l.i18n("MAILWEBCLIENT/ERROR_UPLOAD_FORWARD_ATTACHMENTS")))},_.prototype.setAttachTempNameByHash=function(e,t){s.each(this.attachments(),(function(i){i.hash()===e&&(i.tempName(t),i.uploadStarted(!1))}))},_.prototype.setMessageDataInNewTab=function(e){this.templateUid(e.templateUid),this.templateFolderName(e.templateFolderName),this.draftInfo(e.draftInfo),this.draftUid(e.draftUid),this.inReplyTo(e.inReplyTo),this.references(e.references),this.setRecipient(this.toAddr,e.toAddr),this.setRecipient(this.ccAddr,e.ccAddr),this.setRecipient(this.bccAddr,e.bccAddr),this.subject(e.subject),this.attachments(s.map(e.attachments,(function(t){var i=new P(e.senderAccountId);return i.parse(t),i}),this)),this.plainText(e.plainText),this.textBody(e.textBody),this.selectedImportance(e.selectedImportance),this.sendReadingConfirmation(e.sendReadingConfirmation),this.changedInPreviousWindow(e.changedInPreviousWindow),s.each(this.toolbarControllers(),(function(t){s.isFunction(t.doAfterApplyingMainTabParameters)&&t.doAfterApplyingMainTabParameters(e)})),N.changeSenderAccountId(e.senderAccountId,e.selectedFetcherOrIdentity),this.focusedField(e.focusedField)},_.prototype.commit=function(e){this.toAddr.commit(),this.ccAddr.commit(),this.bccAddr.commit(),this.subject.commit(),this.selectedImportance.commit(),this.sendReadingConfirmation.commit(),s.each(this.toolbarControllers(),(function(e){s.isFunction(e.commit)&&e.commit()})),this.oHtmlEditor.commit(),this.attachmentsChanged(!1),e||this.changedInPreviousWindow(!1)},_.prototype.isChanged=function(){var e=this.toAddr.changed(),t=this.ccAddr.changed(),i=this.bccAddr.changed(),n=this.subject.changed(),o=this.selectedImportance.changed(),r=this.sendReadingConfirmation.changed(),a=!1,l=this.oHtmlEditor.textChanged(),h=this.attachmentsChanged(),u=this.changedInPreviousWindow();return s.each(this.toolbarControllers(),(function(e){s.isFunction(e.isChanged)&&(a=a||e.isChanged())})),e||t||i||n||o||r||a||l||h||u},_.prototype.executeBackToList=function(){c.isNewTab()?window.close():this.shown&&this.shown()&&g.setPreviousHash(),this.backToListOnSendOrSave(!1)},_.prototype.onFileUploadSelect=function(e,t){var i;return!a.showErrorIfAttachmentSizeLimit(t.FileName,h.pInt(t.Size))&&((i=new P(this.senderAccountId())).onUploadSelect(e,t),this.attachments.push(i),!0)},_.prototype.getAttachmentByUid=function(e){return s.find(this.attachments(),(function(t){return t.uploadUid()===e}))},_.prototype.onFileUploadStart=function(e){var t=this.getAttachmentByUid(e);t&&t.onUploadStart()},_.prototype.onFileUploadProgress=function(e,t,i){var s=this.getAttachmentByUid(e);s&&s.onUploadProgress(t,i)},_.prototype.onFileUploadComplete=function(e,t,i){var s=this.getAttachmentByUid(e);s&&s.onUploadComplete(e,t,i)},_.prototype.onFileRemove=function(e){var t=this.getAttachmentByUid(e);this.oJua&&this.oJua.cancel(e),this.attachments.remove(t)},_.prototype.initUploader=function(){this.composeShown()&&this.composeUploaderButton()&&(this.oJua=new p({action:"?/Api/",name:"jua-uploader",queueSize:2,clickElement:this.composeUploaderButton(),hiddenElementsPosition:b.IsRTL?"right":"left",dragAndDropElement:this.composeUploaderDropPlace(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:s.extendOwn({Module:R.ServerModuleName,Method:"UploadAttachment",Parameters:function(){return JSON.stringify({AccountID:M.currentAccountId()})}},c.getCommonRequestParameters())}),this.oJua.on("onDragEnter",s.bind(this.composeUploaderDragOver,this,!0)).on("onDragLeave",s.bind(this.composeUploaderDragOver,this,!1)).on("onBodyDragEnter",s.bind(this.composeUploaderBodyDragOver,this,!0)).on("onBodyDragLeave",s.bind(this.composeUploaderBodyDragOver,this,!1)).on("onProgress",s.bind(this.onFileUploadProgress,this)).on("onSelect",s.bind(this.onFileUploadSelect,this)).on("onStart",s.bind(this.onFileUploadStart,this)).on("onComplete",s.bind(this.onFileUploadComplete,this)),this.allowDragNDrop(this.oJua.isDragAndDropSupported()))},_.prototype.getSendSaveParameters=function(e,t){var i=T.convertAttachmentsForSending(this.attachments()),n=null;return s.each(this.oHtmlEditor.getUploadedImagesData(),(function(e){i[e.TempName]=[e.Name,e.CID,"1","1"]})),n={AccountID:this.senderAccountId(),IdentityID:this.selectedFetcherOrIdentity()&&this.selectedFetcherOrIdentity().IDENTITY?this.selectedFetcherOrIdentity().id():"",AliasID:this.selectedFetcherOrIdentity()&&this.selectedFetcherOrIdentity().ALIAS?this.selectedFetcherOrIdentity().id():"",FetcherID:this.selectedFetcherOrIdentity()&&this.selectedFetcherOrIdentity().FETCHER?this.selectedFetcherOrIdentity().id():"",DraftInfo:this.draftInfo(),DraftUid:this.draftUid(),To:this.toAddr(),Cc:this.ccAddr(),Bcc:this.bccAddr(),Subject:this.subject(),Text:this.plainText()?this.oHtmlEditor.getPlainText():this.oHtmlEditor.getText(e),IsHtml:!this.plainText(),Importance:this.selectedImportance(),SendReadingConfirmation:this.sendReadingConfirmation(),Attachments:i,InReplyTo:this.inReplyTo(),References:this.references()},s.each(this.toolbarControllers(),(function(e){s.isFunction(e.doAfterPreparingSendMessageParameters)&&e.doAfterPreparingSendMessageParameters(n)})),""!==this.templateFolderName()&&t&&(n.DraftFolder=this.templateFolderName(),n.DraftUid=this.templateUid()),n},_.prototype.onSendOrSaveMessageResponse=function(e,t){var i=T.onSendOrSaveMessageResponse(e,t,this.requiresPostponedSending()),n=t.Parameters;switch(this.commit(),i.Method){case"SaveMessage":i.Result&&n.DraftUid===this.templateUid()&&n.DraftFolder===this.templateFolderName()?(this.templateUid(h.pString(i.NewUid)),this.composeShown()&&this instanceof _&&g.replaceHashDirectly(I.getComposeFromMessage("drafts",M.currentAccountId(),n.DraftFolder,this.templateUid()))):i.Result&&n.DraftUid===this.draftUid()&&(this.draftUid(h.pString(i.NewUid)),this.composeShown()&&this instanceof _&&g.replaceHashDirectly(I.getComposeFromMessage("drafts",M.currentAccountId(),n.DraftFolder,this.draftUid()))),this.saving(!1);break;case"SendMessage":i.Result&&this.backToListOnSendOrSave()&&(s.isFunction(this.closePopup)?this.closePopup():this.executeBackToList()),this.sending(!1)}},_.prototype.verifyDataForSending=function(){var e=r.getIncorrectEmailsFromAddressString(this.toAddr()),t=r.getIncorrectEmailsFromAddressString(this.ccAddr()),i=r.getIncorrectEmailsFromAddressString(this.bccAddr()),n=s.union(e,t,i),o=s.map(n,(function(e){return l.encodeHtml(e)})),a=l.i18n("MAILWEBCLIENT/ERROR_INPUT_CORRECT_EMAILS")+o.join(", ");return!(n.length>0)||(E.showPopup(S,[a]),!1)},_.prototype.executeSend=function(e){var t=!1,i=s.bind((function(){this.sending(!0),this.requiresPostponedSending(!this.allowStartSending()),T.send("SendMessage",this.getSendSaveParameters(!0),!0,this.onSendOrSaveMessageResponse,this,this.requiresPostponedSending()),this.backToListOnSendOrSave(!0)}),this);this.autoEncryptSignMessage()?this.encryptSignAndSend():this.isEnableSending()&&this.verifyDataForSending()&&(s.each(this.toolbarControllers(),(function(e){s.isFunction(e.doBeforeSend)&&(t=t||e.doBeforeSend(i))})),t||i())},_.prototype.executeSaveCommand=function(){this.draftFolderIsAvailable()&&this.executeSave(!1)},_.prototype.executeTemplateSaveCommand=function(){this.executeSave(!1,!0,!0)},_.prototype.executeSave=function(e,t,i){e=!!e,i=!!i;var n=(t=void 0===t||t)?this.onSendOrSaveMessageResponse:T.onSendOrSaveMessageResponse,o=t?this:T,r=s.bind((function(s){s&&(this.saving(t),T.send("SaveMessage",this.getSendSaveParameters(!1,i),!e,n,o))}),this),a=!1;this.isEnableSaving()&&(e&&!this.isChanged()||(e||s.each(this.toolbarControllers(),(function(e){s.isFunction(e.doBeforeSave)&&(a=a||e.doBeforeSave(r))}),this),a||r(!0)),this.backToListOnSendOrSave(!0))},_.prototype.changeBccVisibility=function(){this.visibleBcc(!this.visibleBcc()),this.visibleBcc()?this.focusBccAddr():this.focusToAddr()},_.prototype.changeCcVisibility=function(){this.visibleCc(!this.visibleCc()),this.visibleCc()?this.focusCcAddr():this.focusToAddr()},_.prototype.getMessageDataForNewTab=function(){var e,t=s.map(this.attachments(),(function(e){return{"@Object":"Object/Aurora\\Modules\\Mail\\Classes\\Attachment",FileName:e.fileName(),TempName:e.tempName(),MimeType:e.mimeType(),MimePartIndex:e.mimePartIndex(),EstimatedSize:e.size(),CID:e.cid(),ContentLocation:e.contentLocation(),IsInline:e.inline(),IsLinked:e.linked(),Hash:e.hash()}}));return e={accountId:this.senderAccountId(),templateUid:this.templateUid(),templateFolderName:this.templateFolderName(),draftInfo:this.draftInfo(),draftUid:this.draftUid(),inReplyTo:this.inReplyTo(),references:this.references(),senderAccountId:this.senderAccountId(),selectedFetcherOrIdentity:this.selectedFetcherOrIdentity(),toAddr:this.toAddr(),ccAddr:this.ccAddr(),bccAddr:this.bccAddr(),subject:this.subject(),attachments:t,plainText:this.plainText(),textBody:this.plainText()?this.oHtmlEditor.getPlainText():this.oHtmlEditor.getText(),selectedImportance:this.selectedImportance(),sendReadingConfirmation:this.sendReadingConfirmation(),changedInPreviousWindow:this.isChanged(),focusedField:this.focusedField()},s.each(this.toolbarControllers(),(function(t){s.isFunction(t.doAfterPreparingMainTabParameters)&&t.doAfterPreparingMainTabParameters(e)})),e},_.prototype.openInNewWindow=function(){var e,t="id"+Math.random().toString(),i=g.buildHashFromArray(I.getCompose());this.ignoreHasUnsavedChanges(!0),e=this.getMessageDataForNewTab(),this.draftUid().length>0&&!this.isChanged()?(i=g.buildHashFromArray(I.getComposeFromMessage("drafts",M.currentAccountId(),M.folderList().draftsFolderFullName(),this.draftUid(),!0)),v.openTab("?message-newtab"+i)):this.templateUid().length>0&&!this.isChanged()?(i=g.buildHashFromArray(I.getComposeFromMessage("drafts",M.currentAccountId(),this.templateFolderName(),this.templateUid(),!0)),v.openTab("?message-newtab"+i)):this.isChanged()?(w.passComposedMessage(t,e),v.openTab("?message-newtab"+i,t)):(this.routeParams().length>0&&(i=g.buildHashFromArray(s.union([R.HashModuleName+"-compose"],this.routeParams()))),v.openTab("?message-newtab"+i)),this.commit(),s.isFunction(this.closePopup)?this.closePopup():this.executeBackToList()},_.prototype.onShowFilesPopupClick=function(){this.bAllowFiles&&E.showPopup(A,[s.bind(this.addFilesAsAttachment,this)])},_.prototype.registerOwnToolbarControllers=function(){this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_BackButtonView",sId:"back",bOnlyMobile:!0,backToListCommand:this.backToListCommand}),this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_SendButtonView",sId:"send",bAllowMobile:!0,sendCommand:this.sendCommand,toolbarControllers:o.computed((function(){return s.filter(this.toolbarControllers(),(function(e){return e.bSendButton}))}),this)}),this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_SaveButtonView",sId:"save",bAllowMobile:!0,visible:this.draftFolderIsAvailable,saveCommand:this.saveCommand}),this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_SaveTemplateButtonView",sId:"save-template",bAllowMobile:!1,visible:this.visibleSaveTemplateControl,saveTemplateCommand:this.saveTemplateCommand}),this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_ImportanceDropdownView",sId:"importance",selectedImportance:this.selectedImportance}),this.registerToolbarController({ViewTemplate:"MailWebclient_Compose_ConfirmationCheckboxView",sId:"confirmation",sendReadingConfirmation:this.sendReadingConfirmation})},_.prototype.registerToolbarController=function(e){var t=c.isMobile()?e.bAllowMobile:!e.bOnlyMobile,i=R.ComposeToolbarOrder.length;t&&(e.bSendButton=!!e.bSendButton,this.toolbarControllers.push(e),this.toolbarControllers(s.sortBy(this.toolbarControllers(),(function(e){var t=s.indexOf(R.ComposeToolbarOrder,e.sId);return-1!==t?t:i}))),s.isFunction(e.assignComposeExtInterface)&&e.assignComposeExtInterface(this.getExtInterface()))},_.prototype.getExtInterface=function(){return{isHtml:s.bind((function(){return!this.plainText()}),this),hasAttachments:s.bind((function(){return this.notInlineAttachments().length>0}),this),getPlainText:s.bind(this.oHtmlEditor.getPlainText,this.oHtmlEditor),koTextChange:this.oHtmlEditor.textChanged,getFromEmail:s.bind((function(){return this.selectedFetcherOrIdentity()?this.selectedFetcherOrIdentity().email():C.getEmail()}),this),getRecipientEmails:s.bind((function(){return this.recipientEmails()}),this),getSelectedSender:s.bind(this.selectedSender,this),saveSilently:s.bind(this.executeSave,this,!0),setPlainTextMode:s.bind(this.plainText,this,!0),setPlainText:s.bind((function(e){this.textBody(e)}),this),setHtmlTextMode:s.bind(this.plainText,this,!1),setHtmlText:s.bind((function(e){this.textBody(e)}),this),undoHtml:s.bind(this.oHtmlEditor.undoAndClearRedo,this.oHtmlEditor),getSubject:s.bind((function(){return this.subject()}),this),getAutoEncryptSignMessage:function(){return this.autoEncryptSignMessage()}.bind(this),getRecipientsEmpty:function(){return 0===this.toAddr().length&&0===this.ccAddr().length&&0===this.bccAddr().length}.bind(this),getSendSaveParameters:function(){return this.getSendSaveParameters()}.bind(this),isEnableSending:function(){return this.isEnableSending()}.bind(this),isEnableSaving:function(){return this.isEnableSaving()}.bind(this),getDraftFolderFullName:function(e){var t=M.oFolderListItems[e];return t?t.draftsFolderFullName():""},koAllAttachmentsUploaded:this.allAttachmentsUploaded,clearFolderCache:function(e,t){x?x.removeMessagesFromCacheForFolder(e,t):M.removeMessagesFromCacheForFolder(e,t)},commitAndClose:function(){this.commit(),s.isFunction(this.closePopup)?this.closePopup():this.executeBackToList()}.bind(this)}},e.exports=_},NV9q:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("AFLV"),l=i("3Y+r"),h=i("JFZZ"),u=i("IAk5"),c=i("UN2P"),d=i("p2hp"),p=i("gAbd"),m=i("DM8i");function g(e,t,i){var n={aOauthConnectorsData:[]};u.broadcastEvent("MailWebclient::GetOauthConnectorsData",n),this.bVisibleOauthSettings=t&&a.isNonEmptyArray(n.aOauthConnectorsData),this.aOauthConnectorsData=a.pArray(n.aOauthConnectorsData),this.oauthSelectedConnector=o.observable(""),this.iServersPerPage=a.pInt(i,0),this.totalServersCount=o.observable(0),this.servers=o.observableArray([]),this.serversRetrieved=o.observable(!1),this.serverOptions=o.observableArray([{Name:r.i18n("MAILWEBCLIENT/LABEL_CONFIGURE_SERVER_MANUALLY"),Id:0}]),this.selectedServerId=o.observable(0),this.oLastEditableServer=new p,this.iEditedServerId=0,this.selectedServerId.subscribe((function(){var e=this.selectedServerId(),t=s.find(this.servers(),(function(t){return t.iId===e}));t?(this.oIncoming.isEnabled()&&(this.oLastEditableServer=new p(this.getParametersForSave())),this.setExternalAccessServers(t.bSetExternalAccessServers),this.externalAccessImapServer(t.sExternalAccessImapServer),this.externalAccessImapPort(t.iExternalAccessImapPort),this.externalAccessSmtpServer(t.sExternalAccessSmtpServer),this.externalAccessSmtpPort(t.iExternalAccessSmtpPort),this.oauthSelectedConnector(t.bOauthEnable?t.sOauthType:""),this.tenantId(t.iTenantId),this.name(t.sName),this.oIncoming.set(t.sIncomingServer,t.iIncomingPort,t.bIncomingUseSsl),this.oIncoming.isEnabled(this.bAdminEdit),this.oOutgoing.set(t.sOutgoingServer,t.iOutgoingPort,t.bOutgoingUseSsl),this.oOutgoing.isEnabled(this.bAdminEdit),this.outgoingUseAuth(t.sSmtpAuthType===window.Enums.SmtpAuthType.UseUserCredentials),this.outgoingUseAuth.enable(this.bAdminEdit),this.domains(t.sDomains),this.smtpAuthType(t.sSmtpAuthType),this.smtpLogin(t.sSmtpLogin),this.smtpPassword(t.sSmtpPassword),this.enableSieve(t.bEnableSieve),this.sievePort(t.iSievePort),this.enableThreading(t.bEnableThreading),this.useFullEmailAddressAsLogin(t.bUseFullEmailAddressAsLogin)):(this.setExternalAccessServers(this.oLastEditableServer.bSetExternalAccessServers),this.externalAccessImapServer(this.oLastEditableServer.sExternalAccessImapServer),this.externalAccessImapPort(this.oLastEditableServer.iExternalAccessImapPort),this.externalAccessSmtpServer(this.oLastEditableServer.sExternalAccessSmtpServer),this.externalAccessSmtpPort(this.oLastEditableServer.iExternalAccessSmtpPort),this.oauthSelectedConnector(this.oLastEditableServer.bOauthEnable?this.oLastEditableServer.sOauthType:""),this.tenantId(0),this.name(this.oLastEditableServer.sName),this.oIncoming.set(this.oLastEditableServer.sIncomingServer,this.oLastEditableServer.iIncomingPort,this.oLastEditableServer.bIncomingUseSsl),this.oIncoming.isEnabled(!0),this.oOutgoing.set(this.oLastEditableServer.sOutgoingServer,this.oLastEditableServer.iOutgoingPort,this.oLastEditableServer.bOutgoingUseSsl),this.oOutgoing.isEnabled(!0),this.outgoingUseAuth(this.oLastEditableServer.sSmtpAuthType===window.Enums.SmtpAuthType.UseUserCredentials),this.outgoingUseAuth.enable(!0),this.domains(""),this.smtpAuthType(window.Enums.SmtpAuthType.UseUserCredentials),this.smtpLogin(""),this.smtpPassword(""),this.enableSieve(!1),this.sievePort(4190),this.enableThreading(!0),this.useFullEmailAddressAsLogin(!0)),this.setCurrentValues()}),this),this.tenantId=o.observable(0),this.name=o.observable(""),this.name.focused=o.observable(!1),this.bAdminEdit=t,this.oIncoming=new m(143,993,e+"_incoming",r.i18n("MAILWEBCLIENT/LABEL_IMAP_SERVER"),null),this.oOutgoing=new m(25,465,e+"_outgoing",r.i18n("MAILWEBCLIENT/LABEL_SMTP_SERVER"),this.oIncoming.server),this.outgoingUseAuth=o.observable(!0),this.outgoingUseAuth.enable=o.observable(!0),this.domains=o.observable(""),this.bAllowEditDomains=d.AllowEditDomainsInServer,this.smtpAuthType=o.observable(window.Enums.SmtpAuthType.UseUserCredentials),this.smtpLogin=o.observable(""),this.smtpPassword=o.observable(""),this.enableSieve=o.observable(!1),this.sievePort=o.observable(4190),this.enableThreading=o.observable(!0),this.useFullEmailAddressAsLogin=o.observable(!0),this.currentValues=o.observable(""),this.aRequiredFields=[this.oIncoming.server,this.oIncoming.port,this.oOutgoing.server,this.oOutgoing.port],t&&this.aRequiredFields.unshift(this.name),this.setExternalAccessServers=o.observable(!1),this.externalAccessImapServer=o.observable(this.oIncoming.server()),this.externalAccessImapPort=o.observable(this.oIncoming.port()),this.externalAccessSmtpServer=o.observable(this.oOutgoing.server()),this.externalAccessSmtpPort=o.observable(this.oOutgoing.port()),o.computed((function(){this.setExternalAccessServers()||(this.externalAccessImapServer(this.oIncoming.server()),this.externalAccessImapPort(this.oIncoming.port()),this.externalAccessSmtpServer(this.oOutgoing.server()),this.externalAccessSmtpPort(this.oOutgoing.port()))}),this)}g.prototype.ViewTemplate="MailWebclient_Settings_ServerPairPropertiesView",g.prototype.serverInit=function(e){this.setServer(e?new p:this.oLastEditableServer)},g.prototype.fullInit=function(){this.setServer(this.oLastEditableServer),this.serversRetrieved()||this.requestServers()},g.prototype.setServer=function(e){this.oLastEditableServer=e,this.setServerId(e.iId)},g.prototype.setServerId=function(e){if(this.serversRetrieved()||0===e){var t=0===this.selectedServerId();this.selectedServerId(0),this.selectedServerId(e),t&&0===e&&this.selectedServerId.valueHasMutated()}else this.iEditedServerId=e},g.prototype.requestServers=function(e,t){var i=s.isFunction(u.getTenantId)?u.getTenantId():0;this.serversRetrieved(!1),c.send("GetServers",{TenantId:i,Offset:a.pInt(e,0),Limit:this.iServersPerPage,Search:a.pString(t,"")},(function(e){if(s.isArray(e&&e.Result&&e.Result.Items)){var t=[{Name:r.i18n("MAILWEBCLIENT/LABEL_CONFIGURE_SERVER_MANUALLY"),Id:0}];s.each(e.Result.Items,(function(e){t.push({Name:e.Name,Id:a.pInt(e.EntityId)})})),this.servers(s.map(e.Result.Items,(function(e){return new p(e)}))),this.totalServersCount(e.Result.Count),this.serverOptions(t),this.serversRetrieved(!0),this.iEditedServerId&&(this.setServerId(this.iEditedServerId),this.iEditedServerId=0)}else h.showErrorByCode(e)}),this)},g.prototype.clear=function(){this.oIncoming.clear(),this.oOutgoing.clear(),this.outgoingUseAuth(!0)},g.prototype.setCurrentValues=function(){var e=this.bAdminEdit?[this.selectedServerId(),this.name()]:[],t=[this.oIncoming.port(),this.oIncoming.server(),this.oIncoming.ssl(),this.oOutgoing.port(),this.oOutgoing.server(),this.oOutgoing.ssl(),this.outgoingUseAuth(),this.domains(),this.smtpAuthType(),this.smtpLogin(),this.smtpPassword(),this.enableSieve(),this.sievePort(),this.enableThreading(),this.useFullEmailAddressAsLogin(),this.setExternalAccessServers(),this.externalAccessImapServer(),this.externalAccessImapPort(),this.externalAccessSmtpServer(),this.externalAccessSmtpPort(),this.oauthSelectedConnector()];this.currentValues(e.concat(t).join(":"))},g.prototype.getCurrentValues=function(){return this.setCurrentValues(),[this.currentValues()]},g.prototype.getSmtpAuthType=function(){return this.bAdminEdit||this.smtpAuthType()===window.Enums.SmtpAuthType.UseSpecifiedCredentials?this.smtpAuthType():this.outgoingUseAuth()?window.Enums.SmtpAuthType.UseUserCredentials:window.Enums.SmtpAuthType.NoAuthentication},g.prototype.getParametersForSave=function(){var e=this.selectedServerId(),t=this.oLastEditableServer.iId,i=this.getSmtpAuthType(),o={};0!==e||s.find(this.servers(),(function(e){return t===e.iId}))||(e=t),o={ServerId:e,Name:this.bAdminEdit?this.name():this.oIncoming.server(),IncomingServer:this.oIncoming.server(),IncomingPort:this.oIncoming.getIntPort(),IncomingUseSsl:this.oIncoming.ssl(),OutgoingServer:this.oOutgoing.server(),OutgoingPort:this.oOutgoing.getIntPort(),OutgoingUseSsl:this.oOutgoing.ssl(),Domains:this.domains(),SmtpAuthType:i,SmtpLogin:i===window.Enums.SmtpAuthType.UseSpecifiedCredentials?n.trim(this.smtpLogin()):"",SmtpPassword:i===window.Enums.SmtpAuthType.UseSpecifiedCredentials?n.trim(this.smtpPassword()):"",EnableSieve:this.enableSieve(),SievePort:this.sievePort(),EnableThreading:this.enableThreading(),UseFullEmailAddressAsLogin:this.useFullEmailAddressAsLogin(),SetExternalAccessServers:this.setExternalAccessServers()},this.setExternalAccessServers()&&(o.ExternalAccessImapServer=this.externalAccessImapServer(),o.ExternalAccessImapPort=this.externalAccessImapPort(),o.ExternalAccessSmtpServer=this.externalAccessSmtpServer(),o.ExternalAccessSmtpPort=this.externalAccessSmtpPort());var r=s.find(this.aOauthConnectorsData,(function(e){return e.Type===this.oauthSelectedConnector()}),this);return o.OAuthEnable=!!r,r&&(o.OAuthName=r.Name,o.OAuthType=r.Type,o.OAuthIconUrl=r.IconUrl),o},g.prototype.validateBeforeSave=function(){return l.checkIfFieldsEmpty(this.aRequiredFields,r.i18n("MAILWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"))},g.prototype.onDomainsClick=function(){this.bAllowEditDomains||(n(".tabsbar .item.admin.domain").removeClass("recivedAnim"),setTimeout((function(){n(".tabsbar .item.admin.domain").addClass("recivedAnim")})))},e.exports=g},Nfk5:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("wd/R"),a=i("RN+F"),l=i("AFLV"),h=i("ZP6a"),u=i("IAk5"),c=i("SQrT"),d=i("KARm"),p=i("5hOJ"),m=i("zu1m"),g=i("jonm"),f=null,b=i("xzvH"),v=i("p2hp"),y=i("XTZw");function E(){this.accountId=o.observable(g.currentId()),this.accountEmail=o.computed((function(){var e=g.getAccount(this.accountId());return e?e.email():""}),this),this.showUnifiedMailboxLabel=o.observable(""),this.unifiedMailboxLabelText=o.observable(""),this.unifiedMailboxLabelColor=o.observable(""),o.computed((function(){var e=this.accountId?g.getAccount(this.accountId()):null;e&&(this.showUnifiedMailboxLabel(e.showUnifiedMailboxLabel()),this.unifiedMailboxLabelText(e.unifiedMailboxLabelText()||e.email()),this.unifiedMailboxLabelColor(e.unifiedMailboxLabelColor()))}),this),this.folder=o.observable(""),this.uid=o.observable(""),this.unifiedUid=o.observable(""),this.sUniq="",this.subject=o.observable(""),this.emptySubject=o.computed((function(){return""===n.trim(this.subject())}),this),this.subjectForDisplay=o.computed((function(){return this.emptySubject()?a.i18n("MAILWEBCLIENT/LABEL_NO_SUBJECT"):this.subject()}),this),this.messageId=o.observable(""),this.size=o.observable(0),this.friendlySize=o.computed((function(){return a.getFriendlySize(this.size())}),this),this.textSize=o.observable(0),this.oDateModel=new p,this.fullDate=o.observable(""),this.oFrom=new d,this.fullFrom=o.observable(""),this.oTo=new d,this.to=o.observable(""),this.fromOrToText=o.observable(""),this.oCc=new d,this.cc=o.observable(""),this.oBcc=new d,this.bcc=o.observable(""),this.oReplyTo=new d,this.seen=o.observable(!1),this.flagged=o.observable(!1),this.partialFlagged=o.observable(!1),this.answered=o.observable(!1),this.forwarded=o.observable(!1),this.hasAttachments=o.observable(!1),this.hasIcalAttachment=o.observable(!1),this.hasVcardAttachment=o.observable(!1),this.folderObject=o.computed((function(){return this.requireMailCache(),f.getFolderByFullName(this.accountId(),this.folder())}),this),this.threadsAllowed=o.computed((function(){var e=g.getAccount(this.accountId()),t=this.folderObject(),i=t&&(t.type()===Enums.FolderTypes.Drafts||t.type()===Enums.FolderTypes.Spam||t.type()===Enums.FolderTypes.Trash);return e&&e.threadingIsAvailable()&&!i}),this),this.otherSendersAllowed=o.computed((function(){var e=this.folderObject();return e&&e.type()!==Enums.FolderTypes.Drafts&&e.type()!==Enums.FolderTypes.Sent}),this),this.threadPart=o.observable(!1),this.threadPart.subscribe((function(){this.threadPart()&&this.partialFlagged(!1)}),this),this.threadParentUid=o.observable(""),this.threadUids=o.observableArray([]),this.threadCount=o.computed((function(){return this.threadUids().length}),this),this.threadUnreadCount=o.observable(0),this.threadOpened=o.observable(!1),this.threadLoading=o.observable(!1),this.threadLoadingVisible=o.computed((function(){return this.threadsAllowed()&&this.threadOpened()&&this.threadLoading()}),this),this.threadCountVisible=o.computed((function(){return this.threadsAllowed()&&this.threadCount()>0&&!this.threadLoading()}),this),this.threadCountHint=o.computed((function(){return this.threadCount()>0?this.threadOpened()?a.i18n("MAILWEBCLIENT/ACTION_FOLD_THREAD"):this.threadUnreadCount()>0?a.i18n("MAILWEBCLIENT/ACTION_UNFOLD_THREAD_WITH_UNREAD",{},null,this.threadUnreadCount()):a.i18n("MAILWEBCLIENT/ACTION_UNFOLD_THREAD"):""}),this),this.threadCountForLoad=o.observable(5),this.threadNextLoadingVisible=o.observable(!1),this.threadNextLoadingLinkVisible=o.observable(!1),this.threadFunctionLoadNext=null,this.threadShowAnimation=o.observable(!1),this.threadHideAnimation=o.observable(!1),this.importance=o.observable(Enums.Importance.Normal),this.draftInfo=o.observableArray([]),this.hash=o.observable(""),this.sDownloadAsEmlUrl="",this.completelyFilled=o.observable(!1),this.iLastAccessTime=0,this.updateLastAccessTime(),this.checked=o.observable(!1),this.checked.subscribe((function(e){if(this.requireMailCache(),!this.threadOpened()&&f.useThreadingInCurrentList()){var t=f.getFolderByFullName(this.accountId(),this.folder());s.each(this.threadUids(),(function(i){var s=b.get([t.iAccountId,t.fullName(),i]);s&&s.checked(e)}))}}),this),this.selected=o.observable(!1),this.deleted=o.observable(!1),this.truncated=o.observable(!1),this.inReplyTo=o.observable(""),this.references=o.observable(""),this.readingConfirmationAddressee=o.observable(""),this.sensitivity=o.observable(Enums.Sensitivity.Nothing),this.isPlain=o.observable(!1),this.text=o.observable(""),this.textBodyForNewWindow=o.observable(""),this.$text=null,this.rtl=o.observable(!1),this.hasExternals=o.observable(!1),this.isExternalsShown=o.observable(!1),this.isExternalsAlwaysShown=o.observable(!1),this.foundCids=o.observableArray([]),this.attachments=o.observableArray([]),this.safety=o.observable(!1),this.sourceHeaders=o.observable(""),this.date=o.observable(""),this.textRaw=o.observable(""),this.domMessageForPrint=o.observable(null),this.notInlineAttachments=o.computed((function(){return s.filter(this.attachments(),(function(e){return!e.linked()}))}),this),this.Custom={},this.customLabelText=o.observable(""),this.customLabelClass=o.observable("")}E.prototype.setCustomLabel=function(e,t){this.customLabelText(e||""),this.customLabelClass(t||"")},E.prototype.requireMailCache=function(){null===f&&(f=i("4+IO"))},E.prototype.updateLastAccessTime=function(){this.iLastAccessTime=r().unix(),s.each(this.threadUids(),(function(e){var t=b.get([this.accountId(),this.folder(),e]);t&&t.updateLastAccessTime()}),this)},E.prototype.viewMessage=function(e){var t,i=this.getDomText(h.getAppPath());this.textBodyForNewWindow(i.html()),t=n(this.domMessageForPrint()).html(),e&&(n(e.document.body).html(t),e.focus(),s.each(this.attachments(),(function(t){var i=n(e.document.body).find("[data-hash='download-"+t.hash()+"']");t.hasAction("download")?i.on("click",s.bind(t.executeAction,t,"download")):i.hide(),i=n(e.document.body).find("[data-hash='view-"+t.hash()+"']"),t.hasAction("view")?i.on("click",s.bind(t.executeAction,t,"view")):i.hide()}),this))},E.prototype.fillFromOrToText=function(){this.requireMailCache();var e=f.getFolderByFullName(this.accountId(),this.folder());if(!e||e.type()!==Enums.FolderTypes.Drafts&&e.type()!==Enums.FolderTypes.Sent){var t=v.UseMeRecipientForMessages?a.i18n("MAILWEBCLIENT/LABEL_ME_SENDER"):null;this.fromOrToText(this.oFrom.getDisplay(t,this.accountEmail()))}else{var i=v.UseMeRecipientForMessages?a.i18n("MAILWEBCLIENT/LABEL_ME_RECIPIENT"):null,s=this.oTo.getDisplay(i,this.accountEmail()),n=this.oCc.getDisplay(i,this.accountEmail()),o=this.oBcc.getDisplay(i,this.accountEmail()),r=[];l.isNonEmptyString(s)&&r.push(s),l.isNonEmptyString(n)&&r.push(n),l.isNonEmptyString(o)&&r.push(o),this.fromOrToText(r)}},E.prototype.changeThreadUids=function(e,t){this.threadUids(e),this.threadLoading(t<Math.min(this.threadUids().length,this.threadCountForLoad()))},E.prototype.showNextLoadingLink=function(e){this.threadNextLoadingLinkVisible()&&(this.threadNextLoadingVisible(!0),this.threadFunctionLoadNext=e)},E.prototype.increaseThreadCountForLoad=function(){this.threadCountForLoad(this.threadCountForLoad()+5),this.requireMailCache(),f.showOpenedThreads(this.folder())},E.prototype.loadNextMessages=function(){this.threadFunctionLoadNext&&(this.threadFunctionLoadNext(),this.threadNextLoadingLinkVisible(!1),this.threadFunctionLoadNext=null)},E.prototype.markAsThreadPart=function(e,t){var i=this;this.threadPart(!0),this.threadParentUid(t),this.threadUids([]),this.threadNextLoadingVisible(!1),this.threadNextLoadingLinkVisible(!0),this.threadFunctionLoadNext=null,this.threadHideAnimation(!1),setTimeout((function(){i.threadShowAnimation(!0)}),e)},E.prototype.parse=function(e,t,i,n){var o="",r="";if(n&&this.threadPart(i),this.threadPart()||this.threadParentUid(""),"Object/MessageListItem"===e["@Object"]&&(this.seen(!!e.IsSeen),this.flagged(!!e.IsFlagged),this.answered(!!e.IsAnswered),this.forwarded(!!e.IsForwarded),e.Custom&&(this.Custom=e.Custom)),"Object/Message"===e["@Object"]||"Object/MessageListItem"===e["@Object"]){if(this.Custom.Sensitivity=e.Sensitivity,this.accountId(t),this.folder(e.Folder),this.uid(l.pString(e.Uid)),l.isNonEmptyString(e.UnifiedUid)&&this.unifiedUid(e.UnifiedUid),l.isNonEmptyString(e.UnifiedUid)){var a=e.UnifiedUid.split(":");this.accountId(l.pInt(a[0]))}this.sUniq=this.accountId()+this.folder()+this.uid(),this.subject(l.pString(e.Subject)),this.messageId(l.pString(e.MessageId)),this.size(e.Size),this.textSize(e.TextSize),this.oDateModel.parse(e.TimeStampInUTC),this.oFrom.parse(e.From),this.oTo.parse(e.To),this.oCc.parse(e.Cc),this.oBcc.parse(e.Bcc),this.oReplyTo.parse(e.ReplyTo),this.fillFromOrToText(),this.fullDate(this.oDateModel.getFullDate()),this.fullFrom(this.oFrom.getFull()),this.to(this.oTo.getFull()),this.cc(this.oCc.getFull()),this.bcc(this.oBcc.getFull()),this.hasAttachments(!!e.HasAttachments),this.hasIcalAttachment(!!e.HasIcalAttachment),this.hasVcardAttachment(!!e.HasVcardAttachment),"Object/MessageListItem"===e["@Object"]&&n&&this.threadUids(s.map(e.Threads,(function(e){return e.toString()}),this)),this.importance(l.pInt(e.Importance)),Enums.has("Importance",this.importance())||this.importance(Enums.Importance.Normal),this.sensitivity(l.pInt(e.Sensitivity)),Enums.has("Sensitivity",this.sensitivity())||this.sensitivity(Enums.Sensitivity.Nothing),s.isArray(e.DraftInfo)&&this.draftInfo(e.DraftInfo),this.hash(l.pString(e.Hash)),this.sDownloadAsEmlUrl=l.pString(e.DownloadAsEmlUrl),"Object/Message"===e["@Object"]?(this.truncated(e.Truncated),this.inReplyTo(e.InReplyTo),this.references(e.References),this.readingConfirmationAddressee(l.pString(e.ReadingConfirmationAddressee)),o=l.pString(e.Html),r=l.pString(e.Plain),""!==o?(this.textRaw(e.HtmlRaw),this.text(o),this.isPlain(!1)):(this.textRaw(e.PlainRaw),this.text(""!==r?"<div>"+r+"</div>":""),this.isPlain(!0)),this.$text=null,this.isExternalsShown(!1),this.rtl(e.Rtl),this.hasExternals(!!e.HasExternals),this.foundCids(e.FoundedCIDs),this.parseAttachments(e.Attachments,t),this.safety(e.Safety),this.sourceHeaders(e.Headers),this.aExtend=e.Extend,this.completelyFilled(!0),u.broadcastEvent("MailWebclient::ParseMessage::after",{msg:this})):u.broadcastEvent("MailWebclient::ParseMessageListItem::after",{msg:this}),this.updateMomentDate()}},E.prototype.changeText=function(e){this.text(e),this.$text=null},E.prototype.updateMomentDate=function(){this.date(this.oDateModel.getShortDate(r().clone().subtract(1,"days").format("L")===r.unix(this.oDateModel.getTimeStampInUTC()).format("L")))},E.prototype.getDomText=function(e,t){var i=this.$text;return e=e||"",null!==this.$text&&""===e||(this.completelyFilled()?(this.$text=n(this.text()),this.showInlinePictures(e),!0===this.safety()?this.alwaysShowExternalPicturesForSender():(t&&this.isExternalsShown()||this.isExternalsAlwaysShown())&&this.showExternalPictures(),i=this.$text):i=n("")),i.clone()},E.prototype.getConvertedHtml=function(e,t){var i=this.getDomText(e,t);return i.length>0?i.wrap("<p>").parent().html():""},E.prototype.parseAttachments=function(e,t){var i=e?e["@Collection"]:[];this.attachments([]),l.isNonEmptyArray(i)&&this.attachments(s.map(i,(function(e){var i=new y(t);return i.setMessageData(this.folder(),this.uid()),i.parse(e,this.folder(),this.uid()),i}),this))},E.prototype.parseAddressArray=function(e){var t=[];return s.isArray(e)&&(t=s.map(e,(function(e){var t=new CAddressModel;return t.parse(e),t}))),t},E.prototype.showInlinePictures=function(e){var t=s.map(this.attachments(),(function(e){return{CID:e.cid(),ContentLocation:e.contentLocation(),ViewLink:e.getActionUrl("view")}}));m.showInlinePictures(this.$text,t,this.foundCids(),e)},E.prototype.showExternalPictures=function(){m.showExternalPictures(this.$text),this.isExternalsShown(!0)},E.prototype.alwaysShowExternalPicturesForSender=function(){this.isExternalsAlwaysShown(!0),this.completelyFilled()&&!this.isExternalsShown()&&this.showExternalPictures()},E.prototype.openThread=function(){if(this.threadCountVisible()){var e=this.folder();this.threadOpened(!this.threadOpened()),this.requireMailCache(),this.threadOpened()?f.showOpenedThreads(e):(f.hideThreads(this),setTimeout((function(){f.showOpenedThreads(e)}),500))}},E.prototype.getAttachmentsHashes=function(){var e=s.filter(this.attachments(),(function(e){return!e.linked()}));return s.map(e,(function(e){return e.hash()}))},E.prototype.onSaveAttachmentsToFilesResponse=function(e,t){var i=t.Parameters,n=0,o=i.Attachments.length;e.Result&&s.each(i.Attachments,(function(t){void 0!==e.Result[t]&&n++})),0===n?c.showError(a.i18n("MAILWEBCLIENT/ERROR_CANT_SAVE_ATTACHMENTS_TO_FILES")):n<o?c.showError(a.i18n("MAILWEBCLIENT/ERROR_SOME_ATTACHMENTS_WERE_NOT_SAVED",{SAVED_COUNT:n,TOTAL_COUNT:o})):c.showReport(a.i18n("MAILWEBCLIENT/REPORT_ATTACHMENTS_SAVED_TO_FILES"))},E.prototype.downloadAllAttachmentsSeparately=function(){s.each(this.attachments(),(function(e){e.linked()||e.executeAction("download")}))},E.prototype.toJSON=function(){return{uid:this.uid(),unifiedUid:this.unifiedUid(),accountId:this.accountId(),to:this.to(),subject:this.subject(),threadPart:this.threadPart(),threadUids:this.threadUids(),threadOpened:this.threadOpened()}},E.prototype.getHeaderValue=function(e){var t=new RegExp(e+":s*(.+)(\n|$)","gm").exec(this.sourceHeaders());return n.trim(l.pString(t&&t[1]))},e.exports=E},Olic:function(e,t,i){"use strict";var s=i("QaF5"),n=i("4M/5"),o={composeMessage:function(){s.setHash(n.getCompose())},composeMessageFromDrafts:function(e,t,i){var o=n.getComposeFromMessage("drafts",e,t,i);s.setHash(o)},composeMessageAsReplyOrForward:function(e,t,i,o){var r=n.getComposeFromMessage(e,t,i,o);s.setHash(r)},composeMessageToAddresses:function(e){var t=n.getComposeWithToField(e);s.setHash(t)},composeMessageWithData:function(e){var t=n.getComposeWithData(e);t.shift(),t.shift(),s.goDirectly(n.getCompose(),t)},composeMessageWithEml:function(e){var t=n.getComposeWithEmlObject(e.accountId(),e.folder(),e.uid(),e);t.shift(),t.shift(),s.goDirectly(n.getCompose(),t)},composeMessageWithAttachments:function(e){var t=n.getComposeWithObject("attachments",e);t.shift(),t.shift(),s.goDirectly(n.getCompose(),t)}};e.exports=o},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},PMX0:function(e,t,i){"use strict";var s=i("F/us"),n=i("wd/R"),o={getTimeListStepHalfHour:function(e){return s.map(["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"],(function(t){var i=n(t,"HH:mm").format(e);return{text:i,value:i}}))},getDateFormatForDatePicker:function(e){var t="mm/dd/yy";switch(e){case"MM/DD/YYYY":t="mm/dd/yy";break;case"DD/MM/YYYY":t="dd/mm/yy";break;case"DD Month YYYY":t="dd MM yy"}return t}};e.exports=o},QFUI:function(e,t,i){"use strict";var s,n,o=i("RN+F"),r=i("76Kh"),a=i("1grR"),l=i("hPb3"),h={};h.getDownloadLink=function(e,t,i){return t.length>0?"?/Download/"+e+"/DownloadFile/"+t+"/"+(i?"0/"+i:""):""},h.getIframeWrappwer=function(e,t){return"?/Raw/Iframe/"+e+"/"+window.encodeURIComponent(t)+"/"},h.thumbQueue=(s={},n={},function(e,t,i){t&&i?!(e in n)||n[e]>0?(e in n||(n[e]=2,s[e]=[]),n[e]--,i(t)):s[e].push({imageSrc:t,imageSrcObserver:i,messageUid:e}):s[e]&&s[e].length&&(s[e][0].imageSrcObserver(s[e][0].imageSrc),s[e].shift())}),h.showErrorIfAttachmentSizeLimit=function(e,t){var i=o.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE_DETAILED",{FILENAME:e,MAXSIZE:o.getFriendlySize(l.AttachmentSizeLimit)});return l.AttachmentSizeLimit>0&&t>l.AttachmentSizeLimit&&(r.showPopup(a,[i]),!0)},e.exports=h},QrcW:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("o0Bx"),a=i("IAk5"),l=i("SQrT"),h=i("TAkd"),u=i("yYIs");function c(){u.call(this),this.type=n.observable("User"),this.id=n.observable(0),this.entityCreateView=n.computed((function(){var e=h.getEditView(this.type());return e&&(s.isFunction(e.updateSavedState)||(e.updateSavedState=this.updateSavedState.bind(this)),s.isFunction(e.setRequestEntityDataFunction)&&e.setRequestEntityDataFunction(this.requestEntityData.bind(this))),e}),this),this.entityCreateView.subscribe((function(){this.updateSavedState()}),this),this.entityData=n.computed((function(){return h.getEntityData(this.type())}),this),this.allowSave=n.computed((function(){return!!this.entityData()&&!!this.entityData().UpdateRequest}),this),this.allowDelete=n.computed((function(){var e=this.entityData(),t=this.entityCreateView()&&s.isFunction(this.entityCreateView().id)?this.entityCreateView().id():0,i=!this.entityCreateView()||!s.isFunction(this.entityCreateView().allowDelete)||this.entityCreateView().allowDelete(),n=e?e.Type:"",o="User"===n&&t===a.getUserId()||"Tenant"===n&&t===a.getTenantId();return!(!e||!e.DeleteRequest||o||!i)}),this),this.updateSavedState()}s.extendOwn(c.prototype,u.prototype),c.prototype.ViewTemplate="AdminPanelWebclient_CommonSettingsPaneView",c.prototype.getCurrentValues=function(){return this.entityCreateView()?this.entityCreateView().getCurrentValues():[]},c.prototype.revertGlobalValues=function(){this.entityCreateView()&&this.entityCreateView().clearFields(),this.updateSavedState()},c.prototype.save=function(e){this.entityData().UpdateRequest&&this.entityCreateView()&&o.isPositiveNumber(this.id())&&(!s.isFunction(this.entityCreateView().isValidSaveData)||this.entityCreateView().isValidSaveData())&&r.send(this.entityData().ServerModuleName,this.entityData().UpdateRequest,this.entityCreateView()?this.entityCreateView().getParametersForSave():{},(function(t){t.Result?s.isFunction(this.entityCreateView().showAdvancedReport)?this.entityCreateView().showAdvancedReport(this.entityData().ReportSuccessUpdate,t):l.showReport(this.entityData().ReportSuccessUpdate):l.showError(this.entityData().ErrorUpdate),e&&s.isFunction(e.currentEntitiesView)&&s.isFunction(e.currentEntitiesView().requestEntities)&&e.currentEntitiesView().requestEntities(),this.updateSavedState()}),this)},c.prototype.requestEntityData=function(){o.isPositiveNumber(this.id())&&r.send(this.entityData().ServerModuleName,this.entityData().GetRequest,{Type:this.type(),Id:this.id()},(function(e,t){this.id()===t.Parameters.Id&&(this.entityCreateView()&&(this.entityCreateView().parse(this.id(),e.Result||{}),s.each(this.aSettingsSections,(function(t){s.isFunction(t.parse)&&t.parse(this.id(),e.Result||{})}),this)),this.updateSavedState())}),this)},c.prototype.setAccessLevel=function(e,t){this.visible(""!==e),this.type(e),this.id(o.pInt(t)),o.isPositiveNumber(this.id())?this.requestEntityData():this.updateSavedState()},c.prototype.onRoute=function(e,t){s.isFunction(this.entityCreateView().onRoute)&&this.entityCreateView().onRoute(e,t),a.broadcastEvent("CCommonSettingsPaneView::onRoute::after",{View:this.entityCreateView(),Id:this.id()})},e.exports=new c},RY0A:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("IAk5"),a=i("hPb3"),l=i("OgeD"),h=r.getUserRole()===Enums.UserRole.SuperAdmin?l.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"):l.run("SettingsWebclient","getAbstractSettingsFormViewClass"),u=i("aM42"),c=i("gcGb"),d=i("tqo6");function p(e,t){return s.find(e,(function(e){return e.value===t}))||!e[0]?t:e[0].value}function m(){h.call(this,d.ServerModuleName),this.availableTimes=n.observableArray(u.getTimeListStepHour(a.timeFormat()!==Enums.TimeFormat.F24?"hh:mm A":"HH:mm")),a.timeFormat.subscribe((function(){this.availableTimes(u.getTimeListStepHour(a.timeFormat()!==Enums.TimeFormat.F24?"hh:mm A":"HH:mm"))}),this),this.showWeekends=n.observable(d.HighlightWorkingDays),this.selectedWorkdayStarts=n.observable(p(this.availableTimes(),d.WorkdayStarts)),this.selectedWorkdayEnds=n.observable(p(this.availableTimes(),d.WorkdayEnds)),this.showWorkday=n.observable(d.HighlightWorkingHours),this.weekStartsOn=n.observable(d.WeekStartsOn),this.defaultTab=n.observable(d.DefaultTab)}s.extendOwn(m.prototype,h.prototype),m.prototype.ViewTemplate="CalendarWebclient_CalendarSettingsFormView",m.prototype.getCurrentValues=function(){return[this.showWeekends(),this.selectedWorkdayStarts(),this.selectedWorkdayEnds(),this.showWorkday(),this.weekStartsOn(),this.defaultTab()]},m.prototype.revertGlobalValues=function(){this.showWeekends(d.HighlightWorkingDays),this.selectedWorkdayStarts(p(this.availableTimes(),d.WorkdayStarts)),this.selectedWorkdayEnds(p(this.availableTimes(),d.WorkdayEnds)),this.showWorkday(d.HighlightWorkingHours),this.weekStartsOn(d.WeekStartsOn),this.defaultTab(d.DefaultTab)},m.prototype.getParametersForSave=function(){return{HighlightWorkingDays:this.showWeekends(),HighlightWorkingHours:this.showWorkday(),WorkdayStarts:o.pInt(this.selectedWorkdayStarts()),WorkdayEnds:o.pInt(this.selectedWorkdayEnds()),WeekStartsOn:o.pInt(this.weekStartsOn()),DefaultTab:o.pInt(this.defaultTab())}},m.prototype.applySavedValues=function(e){c.calendarSettingsChanged(!0),d.update(e.HighlightWorkingDays,e.HighlightWorkingHours,e.WorkdayStarts,e.WorkdayEnds,e.WeekStartsOn,e.DefaultTab)},m.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new m},SVRS:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"CpanelIntegrator",HashModuleName:"cpanel",CpanelHost:"",CpanelPort:"",CpanelUser:"",CpanelHasPassword:!1,AllowAliases:!1,AllowCreateDeleteAccountOnCpanel:!1,init:function(e){var t=e[this.ServerModuleName]||{};s.isEmpty(t)||(this.CpanelHost=n.pString(t.CpanelHost,this.CpanelHost),this.CpanelPort=n.pString(t.CpanelPort,this.CpanelPort),this.CpanelUser=n.pString(t.CpanelUser,this.CpanelUser),this.CpanelHasPassword=n.pBool(t.CpanelHasPassword,this.CpanelHasPassword),this.AllowAliases=n.pBool(t.AllowAliases,this.AllowAliases),this.AllowCreateDeleteAccountOnCpanel=n.pBool(t.AllowCreateDeleteAccountOnCpanel,this.AllowCreateDeleteAccountOnCpanel))},updateAdmin:function(e,t,i){this.CpanelHost=e,this.CpanelPort=t,this.CpanelUser=i}}},SbmC:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("Aqrs");function r(){this.iAccountId=0,this.collection=n.observableArray([])}r.prototype.parse=function(e,t){var i=0,n=t.length,r=null;if(this.iAccountId=e,s.isArray(t))for(n=t.length;i<n;i++)(r=new o(e)).parse(t[i]),this.collection.push(r)},e.exports=r},TAkd:function(e,t,i){"use strict";var s=i("F/us"),n=i("RN+F"),o=i("61ci");function r(){this.aData=[],o.EnableMultiTenant&&this.aData.push({Type:"Tenant",ScreenHash:"tenants",LinkTextKey:"ADMINPANELWEBCLIENT/HEADING_TENANTS_SETTINGS_TABNAME",EditView:i("yF5f"),ServerModuleName:o.ServerModuleName,GetListRequest:"GetTenants",GetRequest:"GetTenant",CreateRequest:"CreateTenant",UpdateRequest:"UpdateTenant",DeleteRequest:"DeleteTenants",NoEntitiesFoundText:n.i18n("ADMINPANELWEBCLIENT/INFO_NO_ENTITIES_FOUND_TENANT"),ActionCreateText:n.i18n("ADMINPANELWEBCLIENT/ACTION_CREATE_ENTITY_TENANT"),ReportSuccessCreateText:n.i18n("ADMINPANELWEBCLIENT/REPORT_CREATE_ENTITY_TENANT"),ErrorCreateText:n.i18n("ADMINPANELWEBCLIENT/ERROR_CREATE_ENTITY_TENANT"),CommonSettingsHeadingText:n.i18n("COREWEBCLIENT/HEADING_COMMON_SETTINGS"),ReportSuccessUpdate:n.i18n("ADMINPANELWEBCLIENT/REPORT_UPDATE_ENTITY_TENANT"),ErrorUpdate:n.i18n("ADMINPANELWEBCLIENT/ERROR_UPDATE_ENTITY_TENANT"),ActionDeleteText:n.i18n("ADMINPANELWEBCLIENT/ACTION_DELETE_TENANT"),ConfirmDeleteLangConst:"ADMINPANELWEBCLIENT/CONFIRM_DELETE_TENANT_PLURAL",ReportSuccessDeleteLangConst:"ADMINPANELWEBCLIENT/REPORT_DELETE_ENTITIES_TENANT_PLURAL",ErrorDeleteLangConst:"ADMINPANELWEBCLIENT/ERROR_DELETE_ENTITIES_TENANT_PLURAL"}),this.aData.push({Type:"User",ScreenHash:"users",LinkTextKey:"ADMINPANELWEBCLIENT/HEADING_USERS_SETTINGS_TABNAME",EditView:i("qdYY"),ServerModuleName:o.ServerModuleName,GetListRequest:"GetUsers",GetRequest:"GetUser",CreateRequest:"CreateUser",UpdateRequest:"UpdateUser",DeleteRequest:"DeleteUsers",NoEntitiesFoundText:n.i18n("ADMINPANELWEBCLIENT/INFO_NO_ENTITIES_FOUND_USER"),ActionCreateText:n.i18n("ADMINPANELWEBCLIENT/ACTION_CREATE_ENTITY_USER"),ReportSuccessCreateText:n.i18n("ADMINPANELWEBCLIENT/REPORT_CREATE_ENTITY_USER"),ErrorCreateText:n.i18n("ADMINPANELWEBCLIENT/ERROR_CREATE_ENTITY_USER"),CommonSettingsHeadingText:n.i18n("COREWEBCLIENT/HEADING_COMMON_SETTINGS"),ReportSuccessUpdate:n.i18n("ADMINPANELWEBCLIENT/REPORT_UPDATE_ENTITY_USER"),ErrorUpdate:n.i18n("ADMINPANELWEBCLIENT/ERROR_UPDATE_ENTITY_USER"),ActionDeleteText:n.i18n("ADMINPANELWEBCLIENT/ACTION_DELETE_USER"),ConfirmDeleteLangConst:"ADMINPANELWEBCLIENT/CONFIRM_DELETE_USER_PLURAL",ReportSuccessDeleteLangConst:"ADMINPANELWEBCLIENT/REPORT_DELETE_ENTITIES_USER_PLURAL",ErrorDeleteLangConst:"ADMINPANELWEBCLIENT/ERROR_DELETE_ENTITIES_USER_PLURAL",EntitiesCountText:n.i18n("ADMINPANELWEBCLIENT/LABEL_USERS_COUNT")}),this.sortEntitiesData()}r.prototype.getData=function(){return this.aData},r.prototype.getEntityData=function(e){return s.find(this.aData,(function(t){return t.Type===e}))},r.prototype.getEditView=function(e){var t=this.getEntityData(e);return t?t.EditView:null},r.prototype.registerEntityType=function(e){this.aData.push(e),this.sortEntitiesData()},r.prototype.sortEntitiesData=function(){this.aData=s.sortBy(this.aData,(function(e){var t=s.indexOf(o.EntitiesOrder,e.Type);return-1!==t?t:o.EntitiesOrder.length}))},r.prototype.changeEntityData=function(e){var t=this.getEntityData(e.Type);t&&s.each(e,(function(e,i){"Filters"===i&&s.isArray(t[i])&&s.isArray(e)?t[i]=t[i].concat(e):t[i]=e}))},e.exports=new r},TCxV:function(e,t,i){"use strict";var s=i("76Kh"),n=i("4M/5"),o={};function r(){return i("MHRZ")}o.composeMessage=function(){s.showPopup(r())},o.composeMessageFromDrafts=function(e,t,i){var o=n.getComposeFromMessage("drafts",e,t,i);o.shift(),s.showPopup(r(),[o])},o.composeMessageAsReplyOrForward=function(e,t,i,o){var a=n.getComposeFromMessage(e,t,i,o);a.shift(),s.showPopup(r(),[a])},o.composeMessageToAddresses=function(e){var t=n.getComposeWithToField(e);t.shift(),s.showPopup(r(),[t])},o.composeMessageWithData=function(e){var t=n.getComposeWithData(e);t.shift(),s.showPopup(r(),[t])},o.composeMessageWithEml=function(e){var t=n.getComposeWithEmlObject(e.accountId(),e.folder(),e.uid(),e);t.shift(),s.showPopup(r(),[t])},o.composeMessageWithAttachments=function(e){var t=n.getComposeWithObject("attachments",e);t.shift(),s.showPopup(r(),[t])},o.closeComposePopup=function(e){var t=r();!t.opened()||e&&t.senderAccountId()!==e||s.showPopup(t,[["close"]])},e.exports=o},U4UJ:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("AFLV"),a=i("o0Bx"),l=i("JFZZ"),h=i("IAk5"),u=i("20Ah"),c=i("OgeD"),d=i("76Kh"),p=i("SQrT"),m=c.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),g=i("7Lti");function f(){m.call(this,g.ServerModuleName,"UpdateEntitySpaceLimits"),this.iUserId=0,this.userPublicId=n.observable(""),this.twoFactorAuthEnabled=n.observable(""),h.subscribeEvent("ReceiveAjaxResponse::after",s.bind((function(e){"Core"===e.Request.Module&&"GetUser"===e.Request.Method&&e.Response.Result&&e.Request.Parameters.Id===this.iUserId&&this.userPublicId(e.Response.Result.PublicId)}),this)),this.tfaStatusForUserText=n.computed((function(){return this.twoFactorAuthEnabled()?o.i18n("TWOFACTORAUTH/INFO_TFA_ENABLED_FOR_USER",{USER:this.userPublicId()}):o.i18n("TWOFACTORAUTH/INFO_TFA_DISABLED_FOR_USER",{USER:this.userPublicId()})}),this)}s.extendOwn(f.prototype,m.prototype),f.prototype.ViewTemplate="TwoFactorAuth_TwoFactorAuthAdminSettingsFormView",f.prototype.onRouteChild=function(){this.twoFactorAuthEnabled(!1),this.requestPerUserSettings()},f.prototype.requestPerUserSettings=function(){a.send("TwoFactorAuth","GetUserSettings",{UserId:this.iUserId},(function(e,t){e.Result&&t.Parameters.UserId===this.iUserId&&this.twoFactorAuthEnabled(r.pBool(e.Result.TwoFactorAuthEnabled))}),this)},f.prototype.comfirmDisableUserTfa=function(){d.showPopup(u,[o.i18n("TWOFACTORAUTH/CONFIRM_DISABLE_TFA",{USER:this.userPublicId()}),s.bind((function(e){e&&this.disableUserTfa()}),this),"",o.i18n("TWOFACTORAUTH/ACTION_DISABLE_TFA")])},f.prototype.disableUserTfa=function(){a.send("TwoFactorAuth","DisableUserTwoFactorAuth",{UserId:this.iUserId},(function(e,t){e.Result?(this.twoFactorAuthEnabled(!1),p.showReport(o.i18n("TWOFACTORAUTH/REPORT_DISABLE_USER_TFA",{USER:this.userPublicId()}))):l.showErrorByCode(e,o.i18n("TWOFACTORAUTH/ERROR_DISABLE_USER_TFA",{USER:this.userPublicId()}))}),this)},f.prototype.setAccessLevel=function(e,t){this.visible("User"===e),this.iUserId=t},e.exports=new f},U5fS:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("o0Bx"),a=i("IAk5"),l=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("p2hp");function u(){l.call(this,h.ServerModuleName,"UpdateEntitySpaceLimits"),this.bTenantAdmin=a.getUserRole()===Enums.UserRole.TenantAdmin,this.sEntityType="",this.iEntityId=0,this.tenantSpaceLimitMb=n.observable(""),this.userSpaceLimitMb=n.observable(""),this.allowChangeUserSpaceLimit=n.observable(""),this.allocatedTenantSpaceMb=n.observable("")}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="MailWebclient_Settings_MailQuotaAdminSettingsFormView",u.prototype.onRouteChild=function(){this.tenantSpaceLimitMb(""),this.userSpaceLimitMb(""),this.allowChangeUserSpaceLimit(!1),this.allocatedTenantSpaceMb(""),this.updateSavedState(),this.requestPerTenantSettings(),this.requestPerUserSettings()},u.prototype.requestPerTenantSettings=function(){"Tenant"===this.sEntityType&&o.isPositiveNumber(this.iEntityId)&&r.send(h.ServerModuleName,"GetEntitySpaceLimits",{Type:this.sEntityType,TenantId:this.iEntityId},(function(e,t){e.Result&&t.Parameters.TenantId===this.iEntityId&&(this.tenantSpaceLimitMb(o.pInt(e.Result.TenantSpaceLimitMb)),this.userSpaceLimitMb(o.pInt(e.Result.UserSpaceLimitMb)),this.allowChangeUserSpaceLimit(o.pBool(e.Result.AllowChangeUserSpaceLimit)),this.allocatedTenantSpaceMb(o.pInt(e.Result.AllocatedSpaceMb)),this.updateSavedState())}),this)},u.prototype.requestPerUserSettings=function(){"User"===this.sEntityType&&o.isPositiveNumber(this.iEntityId)&&r.send(h.ServerModuleName,"GetEntitySpaceLimits",{Type:this.sEntityType,UserId:this.iEntityId},(function(e,t){e.Result&&t.Parameters.UserId===this.iEntityId&&(this.userSpaceLimitMb(o.pInt(e.Result.UserSpaceLimitMb)),this.allowChangeUserSpaceLimit(o.pBool(e.Result.AllowChangeUserSpaceLimit)),this.updateSavedState())}),this)},u.prototype.getCurrentValues=function(){return[this.tenantSpaceLimitMb(),this.userSpaceLimitMb()]},u.prototype.getParametersForSave=function(){return"User"===this.sEntityType?{Type:"User",UserId:this.iEntityId,UserSpaceLimitMb:o.pInt(this.userSpaceLimitMb())}:"Tenant"===this.sEntityType?{Type:"Tenant",TenantId:this.iEntityId,TenantSpaceLimitMb:o.pInt(this.tenantSpaceLimitMb()),UserSpaceLimitMb:o.pInt(this.userSpaceLimitMb())}:{}},u.prototype.setAccessLevel=function(e,t){this.visible("User"===e||"Tenant"===e),this.sEntityType=e,this.iEntityId=t},e.exports=new u},UN2P:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV"),o=i("o0Bx"),r=i("p2hp");o.registerAbortRequestHandler(r.ServerModuleName,(function(e,t){var i=e.Parameters,s=t.Parameters;switch(e.Method){case"MoveMessages":case"DeleteMessages":return"GetMessage"===t.Method||"GetMessages"===t.Method&&s.Folder===i.Folder;case"GetMessages":case"SetMessagesSeen":case"SetMessageFlagged":return"GetMessages"===t.Method&&s.Folder===i.Folder;case"SetAllMessagesSeen":return("GetMessages"===t.Method||"GetMessages"===t.Method)&&s.Folder===i.Folder;case"ClearFolder":return"GetRelevantFoldersInformation"===t.Method||"GetUnifiedRelevantFoldersInformation"===t.Method||"GetMessages"===t.Method&&s.Folder===i.Folder;case"GetRelevantFoldersInformation":return"GetRelevantFoldersInformation"===t.Method&&i.AccountID===s.AccountID||"GetUnifiedRelevantFoldersInformation"===t.Method;case"GetMessagesFlags":return"GetMessagesFlags"===t.Method}return!1})),e.exports={getOpenedRequest:function(e){o.getOpenedRequest("Mail",e)},hasOpenedRequests:function(e){return o.hasOpenedRequests("Mail",e||"")},hasInternetConnectionProblem:function(){return o.hasInternetConnectionProblem()},registerOnAllRequestsClosedHandler:o.registerOnAllRequestsClosedHandler,send:function(e,t,a,l){var h=i("4+IO"),u="GetMessagesBodies"===e?1e5:void 0;t&&!t.AccountID&&(t.AccountID=h.currentAccountId()),o.send(r.ServerModuleName,e,t,(function(e,t){if(!e.Result&&4002===e.ErrorCode){var o=i("jonm"),r=n.pInt(t.Parameters.AccountID);o.getAccount(r).passwordMightBeIncorrect(!0)}s.isFunction(a)&&a.apply(l,[e,t])}),null,u)}}},UvKh:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("Cq+9"),a=i("jonm");function l(){this.senderList=n.observableArray([]),this.senderAccountId=n.observable(a.currentId()),this.selectedFetcherOrIdentity=n.observable(null),this.lockSelectedSender=n.observable(!1),this.selectedSender=n.observable(""),this.selectedSender.subscribe((function(){if(!this.lockSelectedSender()){var e=a.getAccount(this.senderAccountId()),t=this.selectedSender(),i=null;o.isNonEmptyString(t)&&(0===t.indexOf("fetcher")?(t=t.replace("fetcher",""),i=s.find(e.fetchers(),(function(e){return e.id()===o.pInt(t)}))):0===t.indexOf("alias")?(t=t.replace("alias",""),i=s.find(e.aliases(),(function(e){return e.id()===o.pInt(t)}))):i=s.find(e.identities(),(function(e){return e.id()===o.pInt(t)}))),i&&this.selectedFetcherOrIdentity(i)}}),this)}l.prototype.changeSelectedSender=function(e){if(e){var t=o.pString(e.id());e.FETCHER?t="fetcher"+t:e.ALIAS&&(t="alias"+t),s.find(this.senderList(),(function(e){return e.id===t}))&&(this.lockSelectedSender(!0),this.selectedSender(t),this.selectedFetcherOrIdentity(e),this.lockSelectedSender(!1))}},l.prototype.changeSenderAccountId=function(e,t){var i=!1;this.senderAccountId()!==e&&(a.hasAccountWithId(e)?(this.senderAccountId(e),i=!0):a.hasAccountWithId(this.senderAccountId())||(this.senderAccountId(a.currentId()),i=!0)),(i||0===this.senderList().length)&&(this.fillSenderList(t),i=!0),!i&&t&&this.changeSelectedSender(t)},l.prototype.fillSenderList=function(e){var t=[],i=a.getAccount(this.senderAccountId());i&&(s.isArray(i.identities())&&s.each(i.identities(),(function(e){t.push({fullEmail:e.fullEmail(),id:o.pString(e.id())})}),this),i.identitiesSubscribtion&&i.identitiesSubscribtion.dispose(),i.identitiesSubscribtion=i.identities.subscribe((function(){this.fillSenderList(e),this.changeSelectedSender(i.getDefaultIdentity())}),this),s.each(i.fetchers(),(function(e){var i=e.fullEmail();e.isEnabled()&&e.isOutgoingEnabled()&&i.length>0&&t.push({fullEmail:i,id:"fetcher"+e.id()})}),this),i.fetchersSubscribtion&&i.fetchersSubscribtion.dispose(),i.fetchersSubscribtion=i.fetchers.subscribe((function(){this.fillSenderList(e)}),this),s.each(i.aliases(),(function(e){var i=e.fullEmail();i.length>0&&t.push({fullEmail:i,id:"alias"+e.id()})}),this)),this.senderList(t),this.changeSelectedSender(e)},l.prototype.setFetcherOrIdentityByReplyMessage=function(e){var t=e.oTo.aCollection.concat(e.oCc.aCollection),i=r.getFirstFetcherOrIdentityByRecipientsOrDefault(t,e.accountId());i&&(i.accountId()!==this.senderAccountId()?this.changeSenderAccountId(i.accountId(),i):this.changeSelectedSender(i))},e.exports=new l},XTZw:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("AFLV"),l=i("IAk5"),h=i("ZCBP"),u=i("cGGv"),c=i("UN2P");function d(e){this.iAccountId=e||l.currentAccountId(),this.folderName=o.observable(""),this.messageUid=o.observable(""),this.cid=o.observable(""),this.contentLocation=o.observable(""),this.inline=o.observable(!1),this.linked=o.observable(!1),this.mimePartIndex=o.observable(""),this.messagePart=o.observable(null),u.call(this),this.content=o.observable(""),this.isMessageType=o.computed((function(){return this.mimeType(),this.mimePartIndex(),"message/rfc822"===this.mimeType()}),this)}s.extendOwn(d.prototype,u.prototype),d.prototype.getNewInstance=function(){return new d(this.iAccountId)},d.prototype.getCopy=function(){var e=new d(this.iAccountId);return e.copyProperties(this),e},d.prototype.copyProperties=function(e){this.folderName(e.folderName()),this.messageUid(e.messageUid()),this.cid(e.cid()),this.contentLocation(e.contentLocation()),this.inline(e.inline()),this.linked(e.linked()),this.mimePartIndex(e.mimePartIndex()),this.messagePart(e.messagePart()),this.content(e.content()),this.fileName(e.fileName()),this.tempName(e.tempName()),this.size(e.size()),this.hash(e.hash()),this.mimeType(e.mimeType()),this.thumbnailSrc(e.thumbnailSrc()),this.thumbnailLoaded(e.thumbnailLoaded()),this.statusText(e.statusText()),this.uploaded(e.uploaded()),this.oActionsData=e.oActionsData,this.actions(e.actions()),this.thumbUrlInQueue(e.thumbUrlInQueue())},d.prototype.additionalParse=function(e){this.content(a.pString(e.Content)),this.mimePartIndex(a.pString(e.MimePartIndex)),this.isMessageType()&&""===this.mimePartIndex()&&this.actions(s.without(this.actions(),"view")),this.cid(a.pString(e.CID)),this.contentLocation(a.pString(e.ContentLocation)),this.inline(!!e.IsInline),this.linked(!!e.IsLinked),l.broadcastEvent("MailWebclient::ParseFile::after",this)},d.prototype.setMessageData=function(e,t){this.folderName(e),this.messageUid(t)},d.prototype.onGetMessageResponse=function(e,t){var s=t.Parameters,n=(e=e.Result,new(i("Nfk5")));e&&this.oNewWindow&&(e.TimeStampInUTC=e.ReceivedOrDateTimeStampInUTC,n.parse(e,s.AccountID,!1,!0),this.messagePart(n),this.messagePart().viewMessage(this.oNewWindow),this.oNewWindow=void 0)},d.prototype.viewFile=function(){this.isMessageType()?this.viewMessageFile():this.viewCommonFile()},d.prototype.viewMessageFile=function(){var e=null,t='<div style="margin: 30px; text-align: center; font: normal 14px Tahoma;">'+r.i18n("COREWEBCLIENT/INFO_LOADING")+"</div>";(e=h.open("",this.fileName()))&&(this.messagePart()?this.messagePart().viewMessage(e):(n(e.document.body).html(t),this.oNewWindow=e,c.send("GetMessage",{AccountID:this.iAccountId,Folder:this.folderName(),Uid:this.messageUid(),Rfc822MimeIndex:this.mimePartIndex()},this.onGetMessageResponse,this)),e.focus())},d.prototype.fillDataAfterUploadComplete=function(e,t){this.cid(a.pString(t)),e&&e.Result&&e.Result.Attachment&&(this.tempName(a.pString(e.Result.Attachment.TempName)),this.mimeType(a.pString(e.Result.Attachment.MimeType)),this.size(a.pInt(e.Result.Attachment.Size)),this.hash(a.pString(e.Result.Attachment.Hash)),this.parseActions(e.Result.Attachment))},d.prototype.parseFromUpload=function(e,t,i){this.setMessageData(t,i),this.fileName(a.pString(e.Name)),this.tempName(e.TempName?a.pString(e.TempName):this.fileName()),this.mimeType(a.pString(e.MimeType)),this.size(a.pInt(e.Size)),this.hash(a.pString(e.Hash)),this.parseActions(e),this.uploadUid(this.hash()),this.uploaded(!0),this.uploadStarted(!1)},d.prototype.parseActions=function(e){this.thumbUrlInQueue(""!==a.pString(e.ThumbnailUrl)?a.pString(e.ThumbnailUrl)+"/"+Math.random():""),this.commonParseActions(e),this.isMessageType()?""!==this.folderName()&&""!==this.messageUid()?(this.hasAction("view")||this.actions.unshift("view"),this.otherTemplates.push({name:"MailWebclient_PrintMessageView",data:this.messagePart})):this.actions(s.without(this.actions(),"view")):this.commonExcludeActions()},d.prototype.errorFromUpload=function(){this.uploaded(!0),this.uploadError(!0),this.uploadStarted(!1),this.statusText(r.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN"))},e.exports=d},XjIm:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"LogsViewerWebclient",HashModuleName:"logs-viewer",EnableLogging:!1,EnableEventLogging:!1,LoggingLevel:0,LogSizeBytes:0,EventLogSizeBytes:0,LogFileName:"",EventLogFileName:"",ViewLastLogSize:0,init:function(e){var t=e.Core,i=e[this.ServerModuleName];s.isEmpty(t)||(this.ViewLastLogSize=i.ViewLastLogSize,this.ELogLevel=n.pObject(t.ELogLevel),this.EnableLogging=n.pBool(t.EnableLogging),this.EnableEventLogging=n.pBool(t.EnableEventLogging),this.LoggingLevel=n.pEnum(t.LoggingLevel,this.ELogLevel,this.LoggingLevel),this.updateLogsData(n.pObject(t.LogFilesData)))},updateLogging:function(e,t,i){this.EnableLogging=!!e,this.EnableEventLogging=!!t,this.LoggingLevel=n.pInt(i)},updateLogsData:function(e){this.LogSizeBytes=n.pInt(e.LogSizeBytes),this.EventLogSizeBytes=n.pInt(e.EventLogSizeBytes),this.LogFileName=n.pString(e.LogFileName),this.EventLogFileName=n.pString(e.EventLogFileName)}}},YUUU:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV"),o=i("TAkd"),r=i("61ci"),a={};a.get=function(e,t,i,a,l){var h=[r.HashModuleName],u=!0;return t=t||[],s.each(o.getData(),(function(i){u&&(n.isPositiveNumber(t[i.Type])?"User"===i.Type&&"MailingList"===e||h.push(i.ScreenHash.substr(0,1)+t[i.Type]):e===i.Type&&h.push(i.ScreenHash),e===i.Type&&(u=!1))})),n.isPositiveNumber(a)&&a>1&&h.push("p."+a),n.isNonEmptyString(l)&&h.push("s."+l),n.isNonEmptyString(i)&&h.push(i),h},a.parse=function(e){var t=0,i={},r="",a=1,l="",h="";return s.each(o.getData(),(function(s){e[t]&&s.ScreenHash===e[t]&&(r=s.Type,t++),e[t]&&s.ScreenHash.substr(0,1)===e[t].substr(0,1)&&n.pInt(e[t].substr(1))>0&&(i[s.Type]=n.pInt(e[t].substr(1)),r=s.Type,t++),e.length>t&&function(e){return"p."===e.substr(0,1)&&/^[1-9][\d]*$/.test(e.substr("p.".length))}(h=n.pString(e[t]))&&((a=n.pInt(h.substr("p.".length)))<=0&&(a=1),t++),e.length>t&&function(e){return"s."===e.substr(0,"s.".length)}(h=n.pString(e[t]))&&(l=h.substr("s.".length),t++)})),{Entities:i,CurrentType:r,Last:n.isNonEmptyString(e[t])?e[t]:"",Page:a,Search:l}},e.exports=a},ZIwz:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("K+UY"),a=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass");function l(){a.call(this,"MailChangePasswordPoppassdPlugin"),this.supportedServers=n.observable(r.SupportedServers),this.host=n.observable(r.Host),this.port=n.observable(r.Port)}s.extendOwn(l.prototype,a.prototype),l.prototype.ViewTemplate="MailChangePasswordPoppassdPlugin_AdminSettingsView",l.prototype.getCurrentValues=function(){return[o.pString(this.supportedServers()),o.pString(this.host()),o.pInt(this.port())]},l.prototype.revertGlobalValues=function(){this.supportedServers(r.SupportedServers),this.host(r.Host),this.port(r.Port)},l.prototype.getParametersForSave=function(){return{SupportedServers:o.pString(this.supportedServers()),Host:o.pString(this.host()),Port:o.pInt(this.port())}},l.prototype.applySavedValues=function(e){r.updateAdmin(e.SupportedServers,e.Host,e.Port)},l.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new l},ZdzK:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("o0Bx"),a=i("JFZZ"),l=i("SQrT"),h=i("OgeD"),u=h.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),c=h.run("MailDomains","getMailDomainsCache"),d=i("SVRS");function p(){u.call(this,d.ServerModuleName),this.iUserId=0,this.iRequestedUserId=0,this.domain=n.observable(""),this.domains=n.computed((function(){return s.map(c.domains(),(function(e){return e.Name}))}),this),this.aliasName=n.observable(""),this.aliases=n.observableArray([]),this.selectedAliases=n.observableArray([])}s.extendOwn(p.prototype,u.prototype),p.prototype.ViewTemplate="CpanelIntegrator_AliasesPerUserAdminSettingsView",p.prototype.getCurrentValues=function(){return[this.aliasName(),this.domain()]},p.prototype.revertGlobalValues=function(){this.aliasName(""),this.domain("")},p.prototype.onRouteChild=function(){this.aliasName(""),this.selectedAliases([]),this.requestNewData()},p.prototype.addNewAlias=function(){""!==this.aliasName()?r.send(d.ServerModuleName,"AddNewAlias",{UserId:this.iUserId,AliasName:this.aliasName(),AliasDomain:this.domain()},(function(e){e.Result?(this.aliasName(""),this.requestAliases()):a.showErrorByCode(e,o.i18n("CPANELINTEGRATOR/ERROR_ADD_NEW_ALIAS"))}),this):l.showError(o.i18n("CPANELINTEGRATOR/ERROR_EMPTY_ALIAS"))},p.prototype.deleteAliases=function(){0!==this.selectedAliases().length?r.send(d.ServerModuleName,"DeleteAliases",{UserId:this.iUserId,Aliases:this.selectedAliases()},(function(e){e.Result?(this.selectedAliases([]),this.requestAliases()):a.showErrorByCode(e,o.i18n("CPANELINTEGRATOR/ERROR_DELETE_ALIASES_PLURAL",{},null,this.selectedAliases().length))}),this):l.showError(o.i18n("CPANELINTEGRATOR/ERROR_EMPTY_ALIASES"))},p.prototype.requestNewData=function(){this.bShown&&this.iRequestedUserId!==this.iUserId&&this.requestAliases()},p.prototype.requestAliases=function(){this.iRequestedUserId=this.iUserId,this.aliases([]),r.send(d.ServerModuleName,"GetAliases",{UserId:this.iUserId},(function(e){e.Result&&(this.aliases(e.Result.Aliases),this.domain(e.Result.Domain))}),this)},p.prototype.setAccessLevel=function(e,t){this.visible("User"===e),this.iUserId!==t&&(this.iUserId=t,this.requestNewData())},e.exports=new p},a28q:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("Ol7c"),a=i("RN+F"),l=i("AFLV"),h=i("IAk5"),u=i("HLSX"),c=i("mjrp"),d=i("hPb3"),p=i("76Kh"),m=i("1grR"),g=i("XTZw"),f=i("sWkr"),b=i("4+IO"),v=i("p2hp"),y=i("jDNX");function E(e,t){this.oParent=t,this.creaId="creaId"+Math.random().toString().replace(".",""),this.textFocused=o.observable(!1),this.workareaDom=o.observable(),this.uploaderAreaDom=o.observable(),this.editorUploaderBodyDragOver=o.observable(!1),this.htmlEditorDom=o.observable(),this.toolbarDom=o.observable(),this.colorPickerDropdownDom=o.observable(),this.insertLinkDropdownDom=o.observable(),this.insertImageDropdownDom=o.observable(),this.isFWBold=o.observable(!1),this.isFSItalic=o.observable(!1),this.isTDUnderline=o.observable(!1),this.isTDStrikeThrough=o.observable(!1),this.isEnumeration=o.observable(!1),this.isBullets=o.observable(!1),this.isEnable=o.observable(!0),this.isEnable.subscribe((function(){this.oCrea&&this.oCrea.setEditable(this.isEnable())}),this),this.bInsertImageAsBase64=e,this.bAllowFileUpload=!(e&&void 0===window.File),this.bAllowInsertImage=v.AllowInsertImage,this.lockFontSubscribing=o.observable(!1),this.bAllowImageDragAndDrop=!u.ie10AndAbove,this.aFonts=["Arial","Arial Black","Courier New","Tahoma","Times New Roman","Verdana"],this.sDefaultFont=v.DefaultFontName,this.correctFontFromSettings(),this.selectedFont=o.observable(""),this.selectedFont.subscribe((function(){!this.oCrea||this.lockFontSubscribing()||this.inactive()||this.oCrea.fontName(this.selectedFont())}),this),this.iDefaultSize=v.DefaultFontSize,this.selectedSize=o.observable(0),this.selectedSize.subscribe((function(){!this.oCrea||this.lockFontSubscribing()||this.inactive()||this.oCrea.fontSize(this.selectedSize())}),this),this.visibleInsertLinkPopup=o.observable(!1),this.linkForInsert=o.observable(""),this.linkFocused=o.observable(!1),this.visibleLinkPopup=o.observable(!1),this.linkPopupDom=o.observable(null),this.linkHrefDom=o.observable(null),this.linkHref=o.observable(""),this.visibleLinkHref=o.observable(!1),this.visibleImagePopup=o.observable(!1),this.visibleImagePopup.subscribe((function(){this.onImageOut()}),this),this.imagePopupTop=o.observable(0),this.imagePopupLeft=o.observable(0),this.imageSelected=o.observable(!1),this.tooltipText=o.observable(""),this.tooltipPopupTop=o.observable(0),this.tooltipPopupLeft=o.observable(0),this.visibleInsertImagePopup=o.observable(!1),this.imageUploaderButton=o.observable(null),this.aUploadedImagesData=[],this.imagePathFromWeb=o.observable(""),this.visibleTemplatePopup=o.observable(!1),this.visibleFontColorPopup=o.observable(!1),this.oFontColorPickerView=new y(a.i18n("MAILWEBCLIENT/LABEL_TEXT_COLOR"),this.setTextColorFromPopup,this),this.oBackColorPickerView=new y(a.i18n("MAILWEBCLIENT/LABEL_BACKGROUND_COLOR"),this.setBackColorFromPopup,this),this.inactive=o.observable(!1),this.sPlaceholderText="",this.bAllowChangeInputDirection=d.IsRTL||v.AllowChangeInputDirection,this.disableEdit=o.observable(!1),this.textChanged=o.observable(!1),this.actualTextСhanged=o.observable(!1),this.templates=o.observableArray([]),v.AllowInsertTemplateOnCompose&&h.subscribeEvent("MailWebclient::ParseMessagesBodies::after",s.bind((function(e){e.AccountID===b.currentAccountId()&&e.Folder===b.getTemplateFolder()&&this.fillTemplates()}),this))}E.prototype.ViewTemplate="MailWebclient_HtmlEditorView",E.prototype.setInactive=function(e){this.inactive(e),this.inactive()?this.setPlaceholder():this.removePlaceholder()},E.prototype.setPlaceholder=function(){var e=this.removeAllTags(this.getText());""!==e&&"&nbsp;"!==e||(this.setText("<span>"+this.sPlaceholderText+"</span>"),this.oCrea&&this.oCrea.setBlur())},E.prototype.removePlaceholder=function(){(this.oCrea?this.removeAllTags(this.oCrea.getText(!1)):"")===this.sPlaceholderText&&(this.setText(""),this.oCrea&&this.oCrea.setFocus(!0))},E.prototype.hasOpenedPopup=function(){return this.visibleInsertLinkPopup()||this.visibleLinkPopup()||this.visibleImagePopup()||this.visibleInsertImagePopup()||this.visibleFontColorPopup()||this.visibleTemplatePopup()},E.prototype.setDisableEdit=function(e){this.disableEdit(!!e)},E.prototype.correctFontFromSettings=function(){var e=this.sDefaultFont,t=!1;s.each(this.aFonts,(function(i){i.toLowerCase()===e.toLowerCase()&&(e=i,t=!0)})),t?this.sDefaultFont=e:this.aFonts.push(e)},E.prototype.showLinkPopup=function(e){var t=n(this.workareaDom()),i=t.closest(".panel.compose"),s=t.position(),o=e.position(),r=e.height(),a=Math.round(o.left+s.left),l=Math.round(o.top+r+s.top);this.linkHref(e.attr("href")||e.text()),n(this.linkPopupDom()).css({left:a,top:l}),n(this.linkHrefDom()).css({left:a,top:l}),u.firefox||1!==i.length||n(this.linkPopupDom()).css({"max-width":i.width()-a-40+"px","white-space":"pre-line","word-wrap":"break-word"}),this.visibleLinkPopup(!0)},E.prototype.hideLinkPopup=function(){this.visibleLinkPopup(!1)},E.prototype.showChangeLink=function(){this.visibleLinkHref(!0),this.hideLinkPopup()},E.prototype.changeLink=function(){this.oCrea.changeLink(this.linkHref()),this.hideChangeLink()},E.prototype.hideChangeLink=function(){this.visibleLinkHref(!1)},E.prototype.showImagePopup=function(e,t){var i=n(this.workareaDom()),s=i.position(),o=i.offset();this.imagePopupLeft(Math.round(t.pageX+s.left-o.left)),this.imagePopupTop(Math.round(t.pageY+s.top-o.top)),this.visibleImagePopup(!0)},E.prototype.hideImagePopup=function(){this.visibleImagePopup(!1)},E.prototype.resizeImage=function(e){var t={width:"auto",height:"auto"};switch(e){case Enums.HtmlEditorImageSizes.Small:t.width="300px";break;case Enums.HtmlEditorImageSizes.Medium:t.width="600px";break;case Enums.HtmlEditorImageSizes.Large:t.width="1200px";break;case Enums.HtmlEditorImageSizes.Original:t.width="auto"}this.oCrea.changeCurrentImage(t),this.visibleImagePopup(!1)},E.prototype.onImageOver=function(e){if("IMG"===e.target.nodeName&&!this.visibleImagePopup()){this.imageSelected(!0),this.tooltipText(a.i18n("MAILWEBCLIENT/ACTION_CLICK_TO_EDIT_IMAGE"));var t=this,i=n(this.workareaDom());i.bind("mousemove.image",(function(e){var s=i.position(),n=i.offset();t.tooltipPopupTop(Math.round(e.pageY+s.top-n.top)),t.tooltipPopupLeft(Math.round(e.pageX+s.left-n.left))}))}return!0},E.prototype.onImageOut=function(e){this.imageSelected()&&(this.imageSelected(!1),n(this.workareaDom()).unbind("mousemove.image"));return!0},E.prototype.commit=function(){this.textChanged(!1)},E.prototype.init=function(e,t,i,o){this.sPlaceholderText=o||"",this.oCrea?(this.oCrea.$container=n("#"+this.oCrea.oOptions.creaId),0===this.oCrea.$container.children().length&&(this.oCrea.start(this.isEnable()),this.initEditorUploader())):(n(document.body).on("click",s.bind((function(e){0===n(e.target).parents("span.dropdown_helper").length&&this.closeAllPopups(!0)}),this)),this.initEditorUploader(),this.oCrea=new f({creaId:this.creaId,fontNameArray:this.aFonts,defaultFontName:this.sDefaultFont,defaultFontSize:this.iDefaultSize,alwaysTryUseImageWhilePasting:v.AlwaysTryUseImageWhilePasting,isRtl:d.IsRTL,enableDrop:!1,onChange:s.bind((function(){this.oCrea.bEditing&&(this.textChanged(!0),this.actualTextСhanged.valueHasMutated())}),this),onCursorMove:s.bind(this.setFontValuesFromText,this),onFocus:s.bind(this.onCreaFocus,this),onBlur:s.bind(this.onCreaBlur,this),onUrlIn:s.bind(this.showLinkPopup,this),onUrlOut:s.bind(this.hideLinkPopup,this),onImageSelect:s.bind(this.showImagePopup,this),onImageBlur:s.bind(this.hideImagePopup,this),onItemOver:u.mobileDevice||h.isMobile()?null:s.bind(this.onImageOver,this),onItemOut:u.mobileDevice||h.isMobile()?null:s.bind(this.onImageOut,this),openInsertLinkDialog:s.bind(this.insertLink,this),onUrlClicked:!0}),this.oCrea.start(this.isEnable())),this.oCrea.setTabIndex(i),this.clearUndoRedo(),this.setText(e,t),this.setFontValuesFromText(),this.aUploadedImagesData=[],this.selectedFont(this.sDefaultFont),this.selectedSize(this.iDefaultSize),v.AllowInsertTemplateOnCompose&&this.fillTemplates()},E.prototype.fillTemplates=function(){var e=b.folderList(),t=b.getTemplateFolder(),i=t?e.getFolderByFullName(t):null,n=i?i.getUidList("","",v.MessagesSortBy.DefaultSortBy,v.MessagesSortBy.DefaultSortOrder):null,o=[];if(n){var r=n.collection();r.length>v.MaxTemplatesCountOnCompose&&(r=r.splice(v.MaxTemplatesCountOnCompose)),s.each(r,(function(e){var t=i.getMessageByUid(e);""!==t.text()&&o.push({subject:t.subject(),text:t.text()})}))}this.templates(o)},E.prototype.toggleTemplatePopup=function(e,t){this.visibleTemplatePopup()?this.visibleTemplatePopup(!1):(t.stopPropagation(),this.closeAllPopups(),this.visibleTemplatePopup(!0))},E.prototype.insertTemplate=function(e,t){t.stopPropagation(),this.insertHtml(e)},E.prototype.isInitialized=function(){return!!this.oCrea},E.prototype.setFocus=function(){this.oCrea&&this.oCrea.setFocus(!1)},E.prototype.changeSignatureContent=function(e,t){this.oCrea&&!this.disableEdit()&&this.oCrea.changeSignatureContent(e,t)},E.prototype.setFontValuesFromText=function(){this.lockFontSubscribing(!0),this.isFWBold(this.oCrea.getIsBold()),this.isFSItalic(this.oCrea.getIsItalic()),this.isTDUnderline(this.oCrea.getIsUnderline()),this.isTDStrikeThrough(this.oCrea.getIsStrikeThrough()),this.isEnumeration(this.oCrea.getIsEnumeration()),this.isBullets(this.oCrea.getIsBullets()),this.selectedFont(this.oCrea.getFontName()),this.selectedSize(this.oCrea.getFontSizeInNumber().toString()),this.lockFontSubscribing(!1)},E.prototype.isUndoAvailable=function(){return!!this.oCrea&&this.oCrea.isUndoAvailable()},E.prototype.getPlainText=function(){return this.oCrea?this.oCrea.getPlainText():""},E.prototype.getText=function(e){var t=this.oCrea?this.oCrea.getText(e):"";return""!==this.sPlaceholderText&&this.removeAllTags(t)===this.sPlaceholderText?"":t},E.prototype.getEditableArea=function(){return this.oCrea.$editableArea},E.prototype.setText=function(e,t){this.oCrea&&!this.disableEdit()&&(t?this.oCrea.setPlainText(e):this.oCrea.setText(e),this.inactive()&&""===e&&this.setPlaceholder())},E.prototype.undoAndClearRedo=function(){this.oCrea&&(this.oCrea.undo(),this.oCrea.clearRedo())},E.prototype.clearUndoRedo=function(){this.oCrea&&this.oCrea.clearUndoRedo()},E.prototype.isEditing=function(){return!!this.oCrea&&this.oCrea.bEditing},E.prototype.removeAllTags=function(e){return e.replace(/<style>.*<\/style>/g,"").replace(/<[^>]*>/g,"")},E.prototype.onCreaFocus=function(){this.oCrea&&(this.closeAllPopups(),this.textFocused(!0))},E.prototype.onCreaBlur=function(){this.oCrea&&this.textFocused(!1)},E.prototype.onEscHandler=function(){p.hasOpenedMaximizedPopups()||this.closeAllPopups()},E.prototype.closeAllPopups=function(e){(e=!!e)||this.visibleLinkPopup(!1),this.visibleInsertLinkPopup(!1),this.visibleImagePopup(!1),this.visibleInsertImagePopup(!1),this.visibleFontColorPopup(!1),this.visibleTemplatePopup(!1)},E.prototype.insertHtml=function(e){this.oCrea&&(this.oCrea.isFocused()||this.oCrea.setFocus(!0),this.oCrea.insertHtml(e,!1))},E.prototype.insertLink=function(e,t){this.inactive()||this.visibleInsertLinkPopup()||(t&&s.isFunction(t.stopPropagation)&&t.stopPropagation(),this.linkForInsert(this.oCrea.getSelectedText()),this.closeAllPopups(),this.visibleInsertLinkPopup(!0),this.linkFocused(!0))},E.prototype.insertLinkFromPopup=function(e,t){return this.linkForInsert().length>0&&(r.isCorrectEmail(this.linkForInsert())?this.oCrea.insertEmailLink(this.linkForInsert()):this.oCrea.insertLink(this.linkForInsert())),this.closeInsertLinkPopup(e,t),!1},E.prototype.closeInsertLinkPopup=function(e,t){this.visibleInsertLinkPopup(!1),t&&t.stopPropagation()},E.prototype.textColor=function(e,t){this.inactive()||(this.closeAllPopups(),this.visibleFontColorPopup()||(t.stopPropagation(),this.visibleFontColorPopup(!0),this.oFontColorPickerView.onShow(),this.oBackColorPickerView.onShow()))},E.prototype.colorToHex=function(e){if("#"===e.substr(0,1))return e;for(var t=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(e),i=l.pInt(t[2]),s=l.pInt(t[3]),n=(l.pInt(t[4])|s<<8|i<<16).toString(16);n.length<6;)n="0"+n;return t[1]+"#"+n},E.prototype.setTextColorFromPopup=function(e){this.oCrea.textColor(this.colorToHex(e)),this.closeAllPopups()},E.prototype.setBackColorFromPopup=function(e){this.oCrea.backgroundColor(this.colorToHex(e)),this.closeAllPopups()},E.prototype.insertImage=function(e,t){return this.inactive()||!v.AllowInsertImage||this.visibleInsertImagePopup()||(t.stopPropagation(),this.imagePathFromWeb(""),this.closeAllPopups(),this.visibleInsertImagePopup(!0),this.initUploader()),!0},E.prototype.insertWebImageFromPopup=function(e,t){v.AllowInsertImage&&this.imagePathFromWeb().length>0&&this.oCrea.insertImage(this.imagePathFromWeb()),this.closeInsertImagePopup(e,t)},E.prototype.insertComputerImageFromPopup=function(e,t){var i,o=s.isFunction(this.oParent&&this.oParent.senderAccountId)?this.oParent.senderAccountId():b.currentAccountId(),r=new g(o);r.parse(t),i=r.getActionUrl("view"),v.AllowInsertImage&&i.length>0&&this.oCrea.insertImage(i)&&(n(this.oCrea.$editableArea).find('img[src="'+i+'"]').attr("data-x-src-cid",e),t.CID=e,this.aUploadedImagesData.push(t)),this.closeInsertImagePopup()},E.prototype.getUploadedImagesData=function(){return this.aUploadedImagesData},E.prototype.closeInsertImagePopup=function(e,t){this.visibleInsertImagePopup(!1),t&&t.stopPropagation()},E.prototype.initUploader=function(){this.imageUploaderButton()&&(this.oJua=new c({action:"?/Api/",name:"jua-uploader",queueSize:2,clickElement:this.imageUploaderButton(),hiddenElementsPosition:d.IsRTL?"right":"left",disableMultiple:!0,disableAjaxUpload:!1,disableDragAndDrop:!0,hidden:s.extendOwn({Module:v.ServerModuleName,Method:"UploadAttachment",Parameters:function(){return JSON.stringify({AccountID:b.currentAccountId()})}},h.getCommonRequestParameters())}),this.bInsertImageAsBase64?this.oJua.on("onSelect",s.bind(this.onEditorDrop,this)):this.oJua.on("onSelect",s.bind(this.onFileUploadSelect,this)).on("onComplete",s.bind(this.onFileUploadComplete,this)))},E.prototype.initEditorUploader=function(){if(v.AllowInsertImage&&this.uploaderAreaDom()){var e=null,t=null;this.oParent&&this.oParent.composeUploaderDragOver&&this.oParent.onFileUploadProgress&&this.oParent.onFileUploadStart&&this.oParent.onFileUploadComplete?(e=s.bind((function(){this.editorUploaderBodyDragOver(!0),this.oParent.composeUploaderDragOver(!0)}),this),t=s.bind((function(){this.editorUploaderBodyDragOver(!1),this.oParent.composeUploaderDragOver(!1)}),this),this.editorUploader=new c({action:"?/Api/",name:"jua-uploader",queueSize:1,dragAndDropElement:this.bAllowImageDragAndDrop?this.uploaderAreaDom():null,disableMultiple:!0,disableAjaxUpload:!1,disableDragAndDrop:!this.bAllowImageDragAndDrop,hidden:s.extendOwn({Module:v.ServerModuleName,Method:"UploadAttachment",Parameters:function(){return JSON.stringify({AccountID:b.currentAccountId()})}},h.getCommonRequestParameters())}),this.editorUploader.on("onDragEnter",s.bind(this.oParent.composeUploaderDragOver,this.oParent,!0)).on("onDragLeave",s.bind(this.oParent.composeUploaderDragOver,this.oParent,!1)).on("onBodyDragEnter",e).on("onBodyDragLeave",t).on("onProgress",s.bind(this.oParent.onFileUploadProgress,this.oParent)).on("onSelect",s.bind(this.onEditorDrop,this)).on("onStart",s.bind(this.oParent.onFileUploadStart,this.oParent)).on("onComplete",s.bind(this.oParent.onFileUploadComplete,this.oParent))):(e=s.bind(this.editorUploaderBodyDragOver,this,!0),t=s.bind(this.editorUploaderBodyDragOver,this,!1),this.editorUploader=new c({queueSize:1,dragAndDropElement:this.bAllowImageDragAndDrop?this.uploaderAreaDom():null,disableMultiple:!0,disableAjaxUpload:!1,disableDragAndDrop:!this.bAllowImageDragAndDrop}),this.editorUploader.on("onBodyDragEnter",e).on("onBodyDragLeave",t).on("onSelect",s.bind(this.onEditorDrop,this)))}},E.prototype.isDragAndDropSupported=function(){return!!this.editorUploader&&this.editorUploader.isDragAndDropSupported()},E.prototype.onEditorDrop=function(e,t){var i=null,s=null,n=this,o=!1,r=Math.random().toString(),l="";if(t&&t.File&&"string"==typeof t.File.type)if(v.AllowInsertImage&&0===t.File.type.indexOf("image/"))s=t.File,v.ImageUploadSizeLimit>0&&s.size>v.ImageUploadSizeLimit?p.showPopup(m,[a.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE")]):(i=new window.FileReader,(o=this.oCrea.isFocused())||this.oCrea.setFocus(!0),l=s.name+"_"+r,this.oCrea.insertHtml('<img id="'+l+'" src="./static/styles/images/wait.gif" />',!0),o||this.oCrea.fixFirefoxCursorBug(),i.onload=function(e){n.oCrea.changeImageSource(l,e.target.result)},i.readAsDataURL(s));else{if(this.oParent&&this.oParent.onFileUploadSelect)return this.oParent.onFileUploadSelect(e,t),!0;u.ie10AndAbove||p.showPopup(m,[a.i18n("MAILWEBCLIENT/ERROR_NOT_IMAGE_CHOOSEN")])}return!1},E.prototype.isFileImage=function(e){if("string"==typeof e.Type)return-1!==e.Type.indexOf("image");var t=e.FileName.lastIndexOf("."),i=e.FileName.substr(t+1);return-1!==n.inArray(i,["jpg","jpeg","gif","tif","tiff","png"])},E.prototype.onFileUploadSelect=function(e,t){return this.isFileImage(t)?(this.closeInsertImagePopup(),!0):(p.showPopup(m,[a.i18n("MAILWEBCLIENT/ERROR_NOT_IMAGE_CHOOSEN")]),!1)},E.prototype.onFileUploadComplete=function(e,t,i){var s="";i&&i.Result?i.Result.Error?(s="size"===i.Result.Error?a.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):a.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN"),p.showPopup(m,[s])):(this.oCrea.setFocus(!0),this.insertComputerImageFromPopup(e,i.Result.Attachment)):p.showPopup(m,[a.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN")])},E.prototype.undo=function(){return this.inactive()||this.oCrea.undo(),!1},E.prototype.redo=function(){return this.inactive()||this.oCrea.redo(),!1},E.prototype.bold=function(){return this.inactive()||(this.oCrea.bold(),this.isFWBold(!this.isFWBold())),!1},E.prototype.italic=function(){return this.inactive()||(this.oCrea.italic(),this.isFSItalic(!this.isFSItalic())),!1},E.prototype.underline=function(){return this.inactive()||(this.oCrea.underline(),this.isTDUnderline(!this.isTDUnderline())),!1},E.prototype.strikeThrough=function(){return this.inactive()||(this.oCrea.strikeThrough(),this.isTDStrikeThrough(!this.isTDStrikeThrough())),!1},E.prototype.numbering=function(){return this.inactive()||(this.oCrea.numbering(),this.isBullets(!1),this.isEnumeration(!this.isEnumeration())),!1},E.prototype.bullets=function(){return this.inactive()||(this.oCrea.bullets(),this.isEnumeration(!1),this.isBullets(!this.isBullets())),!1},E.prototype.removeFormat=function(){return this.inactive()||this.oCrea.removeFormat(),!1},E.prototype.setRtlDirection=function(){return this.inactive()||this.oCrea.setRtlDirection(),!1},E.prototype.setLtrDirection=function(){return this.inactive()||this.oCrea.setLtrDirection(),!1},e.exports=E},aM42:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("wd/R"),r=i("PMX0"),a=i("tqo6");r.getTimeListStepHour=function(e){return s.map(["01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","00:00"],(function(t){var i=o(t,"HH:mm"),s=i.format(e),n=i.format("H");return"00:00"===t&&(n="24"),{text:s,value:n}}))},r.getTitleForEvent=function(e,t){if(a.AddDescriptionToTitle)return n.trim((e+" "+t).replace(/[\n\r]/g," "));var i=e?n.trim(e.replace(/[\n\r]/," ")):"",s=i.indexOf(" ",180);return s>=0&&(i=i.substring(0,s)+"..."),i.length>200&&(i=i.substring(0,200)+"..."),i},e.exports=r},bBfe:function(e,t,i){"use strict";var s=i("0h2I"),n=i("Ol7c"),o=i("AFLV"),r=i("Yjhd");function a(){this.FETCHER=!0,this.id=s.observable(0),this.accountId=s.observable(0),this.hash=s.computed((function(){return r.getHash(this.accountId()+"fetcher"+this.id())}),this),this.isEnabled=s.observable(!1),this.isLocked=s.observable(!1).extend({autoResetToFalse:1e3}),this.email=s.observable(""),this.userName=s.observable(""),this.folder=s.observable(""),this.useSignature=s.observable(!1),this.signature=s.observable(""),this.incomingServer=s.observable(""),this.incomingPort=s.observable(0),this.incomingUseSsl=s.observable(!1),this.incomingLogin=s.observable(""),this.leaveMessagesOnServer=s.observable(""),this.isOutgoingEnabled=s.observable(!1),this.outgoingServer=s.observable(""),this.outgoingPort=s.observable(0),this.outgoingUseSsl=s.observable(!1),this.outgoingUseAuth=s.observable(!1),this.iCheckIntervalMinutes=0,this.fullEmail=s.computed((function(){return n.getFullEmail(this.userName(),this.email())}),this)}a.prototype.parse=function(e){this.id(o.pInt(e.EntityId)),this.accountId(o.pInt(e.IdAccount)),this.isEnabled(!!e.IsEnabled),this.isLocked(!!e.IsLocked),this.email(o.pString(e.Email)),this.userName(o.pString(e.Name)),this.folder(o.pString(e.Folder)),this.useSignature(!!e.UseSignature);var t=o.pString(e.Signature);0!==t.indexOf("<")&&(t="<div>"+t+"</div>"),this.signature=s.observable(t),this.incomingServer(o.pString(e.IncomingServer)),this.incomingPort(o.pInt(e.IncomingPort)),this.incomingUseSsl(!!e.IncomingUseSsl),this.incomingLogin(o.pString(e.IncomingLogin)),this.leaveMessagesOnServer(!!e.LeaveMessagesOnServer),this.isOutgoingEnabled(!!e.IsOutgoingEnabled),this.outgoingServer(o.pString(e.OutgoingServer)),this.outgoingPort(o.pInt(e.OutgoingPort)),this.outgoingUseSsl(!!e.OutgoingUseSsl),this.outgoingUseAuth(!!e.OutgoingUseAuth),this.iCheckIntervalMinutes=o.pInt(e.CheckInterval,0)},e.exports=a},cGGv:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("wd/R"),a=i("IAk5"),l=i("QFUI"),h=i("RN+F"),u=i("AFLV"),c=i("ZP6a"),d=i("Yjhd"),p=i("ZCBP"),m=["image/jpeg","image/jpg","image/png","image/gif","text/html","text/plain","text/css","text/rfc822-headers","message/delivery-status","application/x-httpd-php","application/javascript"],g=[];function f(){this.id=o.observable(""),this.index=o.observable(0),this.fileName=o.observable(""),this.tempName=o.observable(""),this.displayName=o.observable(""),this.extension=o.observable(""),this.fileName.subscribe((function(e){this.id(e),this.displayName(e),this.extension(d.getFileExtension(e))}),this),this.size=o.observable(0),this.friendlySize=o.computed((function(){return this.size()>0?h.getFriendlySize(this.size()):""}),this),this.hash=o.observable(""),this.thumbUrlInQueue=o.observable(""),this.thumbUrlInQueueSubscribtion=this.thumbUrlInQueue.subscribe((function(){this.getInThumbQueue()}),this),this.thumbnailSrc=o.observable(""),this.thumbnailLoaded=o.observable(!1),this.thumbnailSessionUid=o.observable(""),this.mimeType=o.observable(""),this.uploadUid=o.observable(""),this.uploaded=o.observable(!1),this.uploadError=o.observable(!1),this.downloading=o.observable(!1),this.isViewMimeType=o.computed((function(){return-1!==n.inArray(this.mimeType(),m)}),this),this.bHasHtmlEmbed=!1,this.otherTemplates=o.observableArray([]),this.visibleCancelButton=o.observable(!0),this.statusText=o.observable(""),this.statusTooltip=o.computed((function(){return this.uploadError()?this.statusText():""}),this),this.progressPercent=o.observable(0),this.visibleProgress=o.observable(!1),this.uploadStarted=o.observable(!1),this.uploadStarted.subscribe((function(){this.uploadStarted()?(this.uploaded(!1),this.visibleProgress(!0),this.progressPercent(20)):(this.progressPercent(100),this.visibleProgress(!1),this.uploaded(!0))}),this),this.downloading.subscribe((function(){this.downloading()?this.visibleProgress(!0):(this.visibleProgress(!1),this.progressPercent(0))}),this),this.allowDrag=o.observable(!1),this.allowUpload=o.observable(!1),this.allowPublicLink=o.observable(!1),this.bIsSecure=o.observable(!1),this.isShared=o.observable(!1),this.sHeaderText="",this.oActionsData={view:{Text:h.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),HandlerName:"viewFile"},download:{Text:h.i18n("COREWEBCLIENT/ACTION_DOWNLOAD_FILE"),HandlerName:"downloadFile",Tooltip:o.computed((function(){var e=h.i18n("COREWEBCLIENT/INFO_CLICK_TO_DOWNLOAD_FILE",{FILENAME:this.fileName(),SIZE:this.friendlySize()});return""===this.friendlySize()&&(e=e.replace(" ()","")),e}),this)}},this.allowActions=o.observable(!0),this.iconAction=o.observable("download"),this.cssClasses=o.computed((function(){return this.getCommonClasses().join(" ")}),this),this.actions=o.observableArray([]),this.firstAction=o.computed((function(){return this.actions().length>1?this.actions()[0]:""}),this),this.secondAction=o.computed((function(){return 1===this.actions().length?this.actions()[0]:this.actions().length>1?this.actions()[1]:""}),this),this.subFiles=o.observableArray([]),this.subFilesExpanded=o.observable(!1),this.sUploadSubFolder="",this.bIsHidden=!1}n("html").hasClass("pdf")&&(m.push("application/pdf"),m.push("application/x-pdf")),f.prototype.addAction=function(e,t,i){t?this.actions.unshift(e):this.actions.push(e),this.actions(s.compact(this.actions())),i&&(this.oActionsData[e]=i)},f.prototype.removeAction=function(e){this.actions(s.without(this.actions(),e))},f.prototype.getMainAction=function(){return this.actions()[0]},f.prototype.hasAction=function(e){return-1!==s.indexOf(this.actions(),e)},f.prototype.getActionText=function(e){return this.hasAction(e)&&this.oActionsData[e]&&("string"==typeof this.oActionsData[e].Text||s.isFunction(this.oActionsData[e].Text))?s.isFunction(this.oActionsData[e].Text)?this.oActionsData[e].Text():this.oActionsData[e].Text:""},f.prototype.getActionUrl=function(e){return this.hasAction(e)&&this.oActionsData[e]&&this.oActionsData[e].Url||""},f.prototype.executeAction=function(e){var t=this.hasAction(e)&&this.oActionsData[e];t&&(s.isFunction(t.Handler)?t.Handler():"string"==typeof t.HandlerName&&s.isFunction(this[t.HandlerName])&&this[t.HandlerName]())},f.prototype.getTooltip=function(e){var t=this.hasAction(e)&&this.oActionsData[e]?this.oActionsData[e].Tooltip:"";return"string"==typeof t?t:s.isFunction(t)?t():""},f.prototype.getCommonClasses=function(){var e=[];return(this.allowUpload()&&!this.uploaded()||this.downloading())&&e.push("incomplete"),this.uploadError()?e.push("fail"):e.push("success"),e},f.prototype.parse=function(e){this.fileName(u.pString(e.FileName)),this.tempName(u.pString(e.TempName)),""===this.tempName()&&this.tempName(this.fileName()),this.mimeType(u.pString(e.MimeType)),this.size(e.EstimatedSize?u.pInt(e.EstimatedSize):u.pInt(e.SizeInBytes)),this.hash(u.pString(e.Hash)),this.parseActions(e),this.uploadUid(this.hash()),this.uploaded(!0),n.isFunction(this.additionalParse)&&this.additionalParse(e)},f.prototype.parseActions=function(e){this.thumbUrlInQueue(""!==u.pString(e.ThumbnailUrl)?u.pString(e.ThumbnailUrl)+"/"+Math.random():""),this.commonParseActions(e),this.commonExcludeActions()},f.prototype.commonExcludeActions=function(){this.isViewSupported()||this.actions(s.without(this.actions(),"view"))},f.prototype.commonParseActions=function(e){s.each(e.Actions,(function(e,t){this.oActionsData[t]||(this.oActionsData[t]={}),this.oActionsData[t].Url=u.pString(e.url),this.actions.push(t)}),this)},f.addViewExtensions=function(e){s.isArray(e)&&(g=s.union(g,e))},f.prototype.isViewSupported=function(){return-1!==n.inArray(this.mimeType(),m)||-1!==n.inArray(this.extension(),g)},f.prototype.getInThumbQueue=function(){""===this.thumbUrlInQueue()||this.linked&&(!this.linked||this.linked())||(this.thumbnailSessionUid(Date.now().toString()),l.thumbQueue(this.thumbnailSessionUid(),this.thumbUrlInQueue(),this.thumbnailSrc))},f.prototype.downloadFile=function(e){var t=this.getActionUrl("download"),i={File:this,CancelDownload:!1};t.length>0&&"#"!==t&&(e||a.broadcastEvent("AbstractFileModel::FileDownload::before",i),i.CancelDownload||(s.isFunction(i.CustomDownloadHandler)?i.CustomDownloadHandler():(t+="/"+r().unix(),c.downloadByUrl(t,"eml"===this.extension()))))},f.prototype.viewFile=function(e,t){d.calmEvent(t),this.viewCommonFile()},f.prototype.viewCommonFile=function(e){var t=null,i=null;u.isNonEmptyString(e)||(e=c.getAppPath()+this.getActionUrl("view")),e.length>0&&"#"!==e&&(i={sUrl:e,index:this.index(),bBreakView:!1},a.broadcastEvent("AbstractFileModel::FileView::before",i),i.bBreakView||(t=p.open(i.sUrl,i.sUrl,!1))&&t.focus())},f.prototype.eventDragStart=function(e,t){var i=t.originalEvent||t;return e&&i&&i.dataTransfer&&i.dataTransfer.setData&&i.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},f.prototype.generateTransferDownloadUrl=function(){var e=this.getActionUrl("download");return"http"!==e.substr(0,4)&&(e=c.getAppPath()+e),this.mimeType()+":"+this.fileName()+":"+e},f.prototype.onUploadSelect=function(e,t,i){i||(this.fileName(u.pString(t.FileName)),this.mimeType(u.pString(t.Type)),this.size(u.pInt(t.Size))),this.uploadUid(e),this.uploaded(!1),this.statusText(""),this.progressPercent(0),this.visibleProgress(!1),this.sUploadSubFolder=u.pString(t.Folder),this.bIsHidden=""!==this.sUploadSubFolder},f.prototype.onUploadStart=function(){this.visibleProgress(!0)},f.prototype.onUploadProgress=function(e,t){t>0&&(this.progressPercent(Math.ceil(e/t*100)),this.visibleProgress(!0))},f.prototype.onDownloadProgress=function(e,t){t>0&&(this.progressPercent(Math.ceil(e/t*100)),this.visibleProgress(this.progressPercent()<100))},f.prototype.onUploadComplete=function(e,t,i){var s=!(t&&i&&!i.ErrorCode&&i.Result&&!i.Result.Error),n=i&&i.ErrorCode&&i.ErrorCode===Enums.Errors.CanNotUploadFileLimit?h.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):h.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN");this.progressPercent(0),this.visibleProgress(!1),this.uploaded(!0),this.uploadError(s),this.statusText(s?n:h.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),s||(this.fillDataAfterUploadComplete(i,e),setTimeout(function(e){return function(){e.statusText("")}}(this),3e3))},f.prototype.fillDataAfterUploadComplete=function(e,t){},f.prototype.onImageLoad=function(e,t){""===this.thumbUrlInQueue()||this.thumbnailLoaded()||(this.thumbnailLoaded(!0),l.thumbQueue(this.thumbnailSessionUid()))},f.prototype.stopDownloading=function(){this.downloading(!1)},f.prototype.startDownloading=function(){this.downloading(!0)},e.exports=f},cPXi:function(e,t,i){"use strict";var s=i("F/us"),n=(i("AFLV"),i("IAk5")),o=i("hPb3"),r=i("jonm"),a=i("UN2P"),l=i("p2hp"),h=i("4+IO"),u={},c=!1;u.prefetchFolderLists=function(){if(r.unifiedInboxAllowed()&&!r.unifiedInboxReady()){var e=s.find(r.collection(),(function(e){return e.includeInUnifiedMailbox()&&!h.oFolderListItems[e.id()]}),this);if(e)return h.getFolderList(e.id()),!0;r.unifiedInboxReady(!0)}return!1},u.prefetchFetchersIdentities=function(){return!(n.isNewTab()||c||!l.AllowFetchers&&!l.AllowIdentities)&&(r.populateFetchersIdentities(),c=!0,!0)},u.prefetchAccountFilters=function(){var e=r.getCurrent(),t=!1;return e&&e.allowFilters()&&!e.filters()&&(e.requestFilters(),t=!0),t},u.prefetchMessageList=function(e,t,i,s){var n,o={page:t,search:i,filters:s},r=e.hasListBeenRequested(o);return n=h.requestMessageList(e.fullName(),o.page,o.search,o.filters,l.MessagesSortBy.DefaultSortBy,l.MessagesSortBy.DefaultSortOrder,!1,!1,r),!r&&!!n&&n.RequestStarted},u.prefetchStarredMessageList=function(){var e=h.folderList(),t=e?e.inboxFolder():null,i=!1;return t&&(i=this.prefetchMessageList(t,1,"",Enums.FolderFilter.Flagged)),i},u.prefetchUnseenMessageList=function(){var e=h.folderList(),t=e?e.inboxFolder():null,i=!1;return t&&(i=this.prefetchMessageList(t,1,"",Enums.FolderFilter.Unseen)),i},u.prefetchNextPage=function(e){var t=h.uidList(),i=s.indexOf(t.collection(),e),n=Math.ceil(i/l.MailsPerPage)+1;this.startPagePrefetch(n-1)},u.prefetchPrevPage=function(e){var t=h.uidList(),i=s.indexOf(t.collection(),e),n=Math.ceil((i+1)/l.MailsPerPage)+1;this.startPagePrefetch(n)},u.startPagePrefetch=function(e){var t=h.getCurrentFolder(),i=h.uidList(),s=(e-1)*l.MailsPerPage,n=e>0&&s<i.resultCount(),o=!1;return t&&!t.hasChanges()&&n&&(o=this.prefetchMessageList(t,e,i.search(),"")),o},u.startUnifiedInboxPrefetch=function(){return!!r.unifiedInboxReady()&&this.startFolderPrefetch(h.oUnifiedInbox)},u.startOtherFoldersPrefetch=function(){var e=h.folderList(),t=e.currentFolderFullName(),i=h.getNamesOfFoldersToRefresh(h.currentAccountId()),n=e?[e.inboxFolderFullName(),e.sentFolderFullName(),e.draftsFolderFullName(),e.spamFolderFullName()]:[],o=i.length<5?this.getOtherFolderNames(5-i.length):[],r=s.uniq(s.compact(s.union(n,i,o))),a=!1;return s.each(r,s.bind((function(i){a||t===i||(a=this.startFolderPrefetch(e.getFolderByFullName(i)))}),this)),a},u.getOtherFolderNames=function(e){var t=h.folderList().inboxFolder(),i=t?t.subfolders():[],n=s.filter(h.folderList().collection(),(function(e){return!e.isSystem()}),this),o=s.first(s.union(i,n),e);return s.map(o,(function(e){return e.fullName()}))},u.startFolderPrefetch=function(e){var t=!1;return e&&(t=this.prefetchMessageList(e,1,"","")),t},u.startThreadListPrefetch=function(){var e=!1,t={},i={},n=h.getCurrentFolder();return s.each(h.messages(),(function(e){if(e.threadCount()>0){var o=e.accountId(),r=n.bIsUnifiedInbox?n.getUnifiedInbox(o):n;s.isArray(t[o])||(t[o]=[],i[o]=r),s.each(e.threadUids(),(function(e){r.hasThreadUidBeenRequested(e)||t[o].push(e)}))}}),this),s.each(t,(function(t,s){var n=i[s];n&&t.length>0&&(t=t.slice(0,l.MailsPerPage),n.addRequestedThreadUids(t),n.loadThreadMessages(t),e=!0)})),e},u.startMessagesPrefetch=function(e){var t=e||h.getCurrentFolder(),i=!1;return t&&(t.bIsUnifiedInbox?s.each(r.unifiedMailboxAccounts(),(function(e){var t=h.oUnifiedInbox.getUnifiedInbox(e.id());t&&(i=i||this.startMessagesPrefetchForFolder(t,h.oUnifiedInbox.selected()))}),this):i=this.startMessagesPrefetchForFolder(t,t.selected())),i},u.startMessagesPrefetchForFolder=function(e,t){var i=e.iAccountId,n=0,o=l.MaxMessagesBodiesSizeToPrefetch,r=[],u=null,c=function(t){if(t&&s.isFunction(t.uid)){var a=t.accountId()===i,h=!t.deleted()&&!t.completelyFilled(),u=!s.find(r,(function(e){return e===t.uid()}),this),c=!e.hasUidBeenRequested(t.uid()),d=t.textSize()<l.MessageBodyTruncationThreshold?t.textSize():l.MessageBodyTruncationThreshold;n<o&&a&&h&&u&&c&&(r.push(t.uid()),n+=d+2048)}};return!!(e&&(t&&s.each(h.messages(),c),e.doForAllMessages(c),r.length>0))&&(e.addRequestedUids(r),u={AccountID:i,Folder:e.fullName(),Uids:r,MessageBodyTruncationThreshold:l.MessageBodyTruncationThreshold},a.send("GetMessagesBodies",u,this.onGetMessagesBodiesResponse,this),!0)},u.onGetMessagesBodiesResponse=function(e,t){var i=t.Parameters,o=h.getFolderByFullName(i.AccountID,i.Folder);s.isArray(e.Result)&&(s.each(e.Result,(function(e){o.parseAndCacheMessage(e,!1,!1)})),n.broadcastEvent("MailWebclient::ParseMessagesBodies::after",{AccountID:i.AccountID,Folder:i.Folder}))},u.prefetchAccountQuota=function(){var e=r.getCurrent(),t=e&&!e.quotaRecieved();return!(!o.ShowQuotaBar||!t)&&(e.updateQuotaParams(),!0)},u.prefetchTemplateFolder=function(){var e=h.folderList(),t=h.getTemplateFolder();return""!==t&&this.startFolderPrefetch(e.getFolderByFullName(t))},u.prefetchTemplateMessages=function(){var e=h.folderList(),t=h.getTemplateFolder(),i=t?e.getFolderByFullName(t):null;if(i)return this.startMessagesPrefetch(i)},e.exports={startMin:function(){var e=!1;return(e=u.prefetchFetchersIdentities())||(e=u.prefetchFolderLists()),e||(e=u.prefetchTemplateFolder()),e||(e=u.prefetchTemplateMessages()),e||(e=u.prefetchAccountFilters()),e||(e=u.prefetchStarredMessageList()),e||(e=u.prefetchAccountQuota()),e},startAll:function(){var e=!1;return(e=u.prefetchFetchersIdentities())||(e=u.prefetchFolderLists()),e||(e=u.prefetchTemplateFolder()),e||(e=u.prefetchTemplateMessages()),e||(e=u.prefetchAccountFilters()),e||(e=u.startMessagesPrefetch()),e||(e=u.startThreadListPrefetch()),e||(e=u.prefetchStarredMessageList()),e||(e=u.startPagePrefetch(h.page()+1)),e||(e=u.startPagePrefetch(h.page()-1)),e||(e=u.prefetchUnseenMessageList()),e||(e=u.prefetchAccountQuota()),e||(e=u.startUnifiedInboxPrefetch()),e||(e=u.startOtherFoldersPrefetch()),e},prefetchStarredMessageList:function(){u.prefetchStarredMessageList()},prefetchFolderLists:function(){return u.prefetchFolderLists()},startFolderPrefetch:function(e){u.startFolderPrefetch(e)},prefetchNextPage:function(e){u.prefetchNextPage(e)},prefetchPrevPage:function(e){u.prefetchPrevPage(e)}}},cleQ:function(e,t,i){"use strict";var s=i("0h2I"),n=i("AFLV"),o=i("Yjhd"),r=i("Ol7c");function a(){this.ALIAS=!0,this.email=s.observable(""),this.friendlyName=s.observable(""),this.fullEmail=s.computed((function(){return r.getFullEmail(this.friendlyName(),this.email())}),this),this.accountId=s.observable(-1),this.id=s.observable(-1),this.signature=s.observable(""),this.useSignature=s.observable(!1),this.hash=s.computed((function(){return o.getHash(this.accountId()+"alias"+this.id())}),this)}a.prototype.parse=function(e){if("Object/Aurora\\Modules\\CpanelIntegrator\\Classes\\Alias"===e["@Object"]){this.email(n.pString(e.Email)),this.friendlyName(n.pString(e.FriendlyName)),this.accountId(n.pInt(e.IdAccount)),this.id(n.pInt(e.EntityId));var t=n.pString(e.Signature);0!==t.indexOf("<")&&(t="<div>"+t+"</div>"),this.signature=s.observable(t),this.useSignature(!!e.UseSignature)}},e.exports=a},cyfa:function(e,t,i){"use strict";var s=i("0h2I"),n=i("Ol7c"),o=i("AFLV");function r(){this.sName="",this.sEmail="",this.sDisplay="",this.sFull="",this.loaded=s.observable(!1),this.found=s.observable(!1)}r.prototype.parse=function(e){null!==e&&(this.sName=o.pString(e.DisplayName),this.sEmail=o.pString(e.Email),this.sDisplay=this.sName.length>0?this.sName:this.sEmail,this.sFull=n.getFullEmail(this.sName,this.sEmail))},r.prototype.getEmail=function(){return this.sEmail},r.prototype.getName=function(){return this.sName},r.prototype.getDisplay=function(){return this.sDisplay},r.prototype.getFull=function(){return this.sFull},e.exports=r},dKfC:function(e,t,i){"use strict";var s=i("IAk5"),n=i("SQrT"),o=i("QaF5"),r=i("jxK9"),a=i("jonm"),l=i("4+IO"),h=[],u=[];if(s.isNewTab()){var c={getEditedDraftUid:function(){return l.editedDraftUid()}};window.SlaveTabMailMethods=c,e.exports={}}else{var d={showReport:function(e){n.showReport(e)},getAccountList:function(){return a},getFolderListItems:function(){return l.oFolderListItems},getUidList:function(){return l.uidList()},getComposedMessageAccountId:function(e){var t=h[e];return t?t.accountId:0},getComposedMessage:function(e){var t=h[e];return delete h[e],t},removeOneMessageFromCacheForFolder:function(e,t,i){l.removeOneMessageFromCacheForFolder(e,t,i)},replaceHashWithoutMessageUid:function(e){o.replaceHashWithoutMessageUid(e)},startMessagesLoadingWhenDraftSaving:function(e,t){l.startMessagesLoadingWhenDraftSaving(e,t)},removeMessagesFromCacheForFolder:function(e,t){l.removeMessagesFromCacheForFolder(e,t)},searchMessagesInCurrentFolder:function(e){l.searchMessagesInCurrentFolder(e)},getReplyData:function(e){var t=u[e];return delete u[e],t},deleteMessage:function(e,t){r.deleteMessages([e],t)}};window.MainTabMailMethods=d,e.exports={passReplyData:function(e,t){u[e]=t},passComposedMessage:function(e,t){h[e]=t}}}},fIp0:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("Yjhd"),a=i("IAk5");function l(e,t){this.bShown=!1,this.currentPage=o.observable(1),this.count=o.observable(e),this.perPage=o.observable(t),this.firstPage=o.observable(1),this.lastPage=o.observable(1),this.pagesCount=o.computed((function(){var e=this.perPage()>0?Math.ceil(this.count()/this.perPage()):0;return e>0?e:1}),this),o.computed((function(){var e=20,t=4,i=this.pagesCount(),s=this.currentPage(),n=s,o=s;if(i>1)for(;e--,1<n&&(n--,t--),0!==t&&(i>o&&(o++,t--),0!==t)&&0!==e;);this.firstPage(n),this.lastPage(o)}),this),this.visibleFirst=o.computed((function(){return this.firstPage()>1}),this),this.visibleLast=o.computed((function(){return this.lastPage()<this.pagesCount()}),this),this.clickPage=s.bind(this.clickPage,this),this.pages=o.computed((function(){var e=this.firstPage(),t=[];if(this.firstPage()<this.lastPage())for(;e<=this.lastPage();e++)t.push({number:e,current:e===this.currentPage(),clickFunc:this.clickPage});return t}),this),a.isMobile()||this.hotKeysBind()}l.prototype.ViewTemplate="CoreWebclient_PageSwitcherView",l.prototype.hotKeysBind=function(){n(document).on("keydown",n.proxy((function(e){if(this.bShown&&!r.isTextFieldFocused()){var t=e.keyCode;e.ctrlKey&&t===Enums.Key.Left?this.clickPreviousPage():e.ctrlKey&&t===Enums.Key.Right&&this.clickNextPage()}}),this))},l.prototype.hide=function(){this.bShown=!1},l.prototype.show=function(){this.bShown=!0},l.prototype.clear=function(){this.currentPage(1),this.count(0)},l.prototype.setCount=function(e){this.count(e),this.currentPage()>this.pagesCount()&&this.currentPage(this.pagesCount())},l.prototype.setPage=function(e,t){this.perPage(t),e>this.pagesCount()?this.currentPage(this.pagesCount()):this.currentPage(e)},l.prototype.clickPage=function(e){var t=e.number;t<1&&(t=1),t>this.pagesCount()&&(t=this.pagesCount()),this.currentPage(t)},l.prototype.clickFirstPage=function(){this.currentPage(1)},l.prototype.clickPreviousPage=function(){var e=this.currentPage()-1;e<1&&(e=1),this.currentPage(e)},l.prototype.clickNextPage=function(){var e=this.currentPage()+1;e>this.pagesCount()&&(e=this.pagesCount()),this.currentPage(e)},l.prototype.clickLastPage=function(){this.currentPage(this.pagesCount())},e.exports=l},gAbd:function(e,t,i){"use strict";var s=i("AFLV");e.exports=function(e){this.iId=e?s.pInt(e.EntityId)||s.pInt(e.ServerId):0,this.iTenantId=e?s.pInt(e.TenantId):0,this.sName=e?s.pString(e.Name):"",this.sIncomingServer=e?s.pString(e.IncomingServer):"",this.iIncomingPort=e?s.pInt(e.IncomingPort):143,this.bIncomingUseSsl=!!e&&!!e.IncomingUseSsl,this.sOutgoingServer=e?s.pString(e.OutgoingServer):"",this.iOutgoingPort=e?s.pInt(e.OutgoingPort):25,this.bOutgoingUseSsl=!!e&&!!e.OutgoingUseSsl,this.sDomains=e?s.pString(e.Domains):"",this.sSmtpAuthType=e?s.pString(e.SmtpAuthType):window.Enums.SmtpAuthType.UseUserCredentials,this.sSmtpLogin=e?s.pString(e.SmtpLogin):"",this.sSmtpPassword=e?s.pString(e.SmtpPassword):"",this.bEnableSieve=!!e&&!!e.EnableSieve,this.iSievePort=e&&e.SievePort?s.pInt(e.SievePort):4190,this.bEnableThreading=!!e&&!!e.EnableThreading,this.bUseFullEmailAddressAsLogin=!e||!!e.UseFullEmailAddressAsLogin,this.bSetExternalAccessServers=s.pBool(e&&e.SetExternalAccessServers,!1),this.sExternalAccessImapServer=s.pString(e&&e.ExternalAccessImapServer,""),this.iExternalAccessImapPort=s.pInt(e&&e.ExternalAccessImapPort,143),this.sExternalAccessSmtpServer=s.pString(e&&e.ExternalAccessSmtpServer,""),this.iExternalAccessSmtpPort=s.pInt(e&&e.ExternalAccessSmtpPort,25),this.bAllowToDelete=s.pBool(e&&e.AllowToDelete,!0),this.bAllowEditDomains=s.pBool(e&&e.AllowEditDomains,!0),this.sOwnerType=e?s.pString(e.OwnerType):"",this.bOauthEnable=s.pBool(e&&e.OAuthEnable,!1),this.sOauthName=s.pString(e&&e.OAuthName,""),this.sOauthType=s.pString(e&&e.OAuthType,""),this.sOauthIconUrl=s.pString(e&&e.OAuthIconUrl,"")}},gcGb:function(e,t,i){"use strict";var s=i("0h2I"),n=i("F/us"),o=i("IAk5"),r=i("KA8O");function a(){this.calendars=s.observableArray([]),this.calendarsLoadingStarted=s.observable(!1),this.icalAttachments=[],this.recivedAnim=s.observable(!1).extend({autoResetToFalse:500}),this.calendarSettingsChanged=s.observable(!1),this.calendarChanged=s.observable(!1)}a.prototype.addIcal=function(e){n.each(this.icalAttachments,(function(t){t.uid()===e.uid()&&(e.sSequence>=t.sSequence?t.lastModification(!1):e.lastModification(!1))})),this.icalAttachments.push(e),0===this.calendars().length&&this.requestCalendarList()},a.prototype.getIcal=function(e){return n.find(this.icalAttachments,(function(t){return e===t.file()}))},a.prototype.onGetCalendarsResponse=function(e,t){if(e&&e.Result&&e.Result.Calendars){var i=o.currentAccountEmail?o.currentAccountEmail():"",s=n.filter(e.Result.Calendars,(function(e){return e.Owner===i||e.Access===Enums.CalendarAccess.Full||e.Access===Enums.CalendarAccess.Write}));this.calendars(n.map(s,(function(e){return{name:e.Name+" <"+e.Owner+">",id:e.Id}})))}this.calendarsLoadingStarted(!1)},a.prototype.requestCalendarList=function(){this.calendarsLoadingStarted()||(r.send("GetCalendars",null,this.onGetCalendarsResponse,this),this.calendarsLoadingStarted(!0))},a.prototype.markIcalTypeByFile=function(e,t,i,s,o,r){n.each(this.icalAttachments,(function(n){e===n.file()&&(n.type(t),n.cancelDecision(i),n.replyDecision(s),n.calendarId(o),n.selectedCalendarId(r))}))},a.prototype.markIcalNonexistent=function(e){n.each(this.icalAttachments,(function(t){e===t.uid()&&t.markNeededAction()}))},a.prototype.markIcalNotSaved=function(e){n.each(this.icalAttachments,(function(t){e===t.uid()&&t.markNotSaved()}))},a.prototype.markIcalTentative=function(e){n.each(this.icalAttachments,(function(t){e===t.uid()&&t.markTentative()}))},a.prototype.markIcalAccepted=function(e){n.each(this.icalAttachments,(function(t){e===t.uid()&&t.markAccepted()}))},e.exports=new a},h1OO:function(e,t,i){"use strict";var s=i("IAk5"),n=s.isMobile()||s.isNewTab()?i("Olic"):i("TCxV");e.exports=n},iIt5:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"BrandingWebclient",HashModuleName:"branding",LoginLogo:"",TabsbarLogo:"",init:function(e){var t=e.BrandingWebclient;s.isEmpty(t)||(this.LoginLogo=n.pString(t.LoginLogo,this.LoginLogo),this.TabsbarLogo=n.pString(t.TabsbarLogo,this.TabsbarLogo))},update:function(e){s.isEmpty(e)||(this.LoginLogo=e.LoginLogo,this.TabsbarLogo=e.TabsbarLogo)}}},iQb4:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("AFLV"),a=i("o0Bx"),l=i("JFZZ"),h=i("SQrT"),u=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),c=i("ll04");function d(){u.call(this,c.ServerModuleName),this.iUserId=0,this.enableModule=n.observable(!1)}s.extendOwn(d.prototype,u.prototype),d.prototype.ViewTemplate="ActiveServer_PerUserAdminSettingsView",d.prototype.onRoute=function(){this.requestPerUserSettings(),this.iAuthMode=c.AuthMode},d.prototype.requestPerUserSettings=function(){r.isPositiveNumber(this.iUserId)&&a.send(c.ServerModuleName,"GetPerUserSettings",{UserId:this.iUserId},(function(e){e.Result&&this.enableModule(e.Result.EnableModule)}),this)},d.prototype.savePerUserSettings=function(){this.isSaving(!0);var e={UserId:this.iUserId,EnableModule:this.enableModule()};a.send(c.ServerModuleName,"UpdatePerUserSettings",e,(function(e){this.isSaving(!1),e.Result?h.showReport(o.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS")):l.showErrorByCode(e,o.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))}),this)},d.prototype.setAccessLevel=function(e,t){this.visible("User"===e),this.iUserId!==t&&(this.iUserId=t)},e.exports=new d},jDNX:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("EVdn");function r(e,t,i){this.aGreyColors=["rgb(0, 0, 0)","rgb(68, 68, 68)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(204, 204, 204)","rgb(238, 238, 238)","rgb(243, 243, 243)","rgb(255, 255, 255)"],this.aBrightColors=["rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],this.aColorLines=[["rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(11, 83, 148)","rgb(53, 28, 117)","rgb(116, 27, 71)"],["rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]],this.caption=e,this.pickHandler=t,this.pickContext=i,this.colorPickerDom=n.observable(null)}r.prototype.ViewTemplate="MailWebclient_ColorPickerView",r.prototype.onShow=function(){o(this.colorPickerDom()).find("span.color-item").on("click",s.bind((function(e){e.stopPropagation(),this.setColorFromPopup(o(e.target).data("color"))}),this))},r.prototype.setColorFromPopup=function(e){this.pickHandler.call(this.pickContext,e)},e.exports=r},jonm:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("IAk5").isNewTab()&&window.opener?window.opener.MainTabMailMethods:null,a=i("QaF5"),l=i("o0Bx"),h=i("UN2P"),u=i("4M/5"),c=i("p2hp"),d=i("2ug6"),p=i("bBfe"),m=i("cleQ"),g=i("vsma");function f(){this.collection=n.observableArray([]),this.unifiedMailboxAccounts=n.computed((function(){return c.AllowUnifiedInbox?s.filter(this.collection(),(function(e){return e.includeInUnifiedMailbox()})):[]}),this),this.unifiedInboxAllowed=n.computed((function(){return this.unifiedMailboxAccounts().length>1}),this),this.unifiedInboxReady=n.observable(!1)}f.prototype.getAccountByHash=function(e){return s.find(this.collection(),(function(t){return t.hash()===e}),this)},f.prototype.changeCurrentAccountByHash=function(e){var t=this.getAccountByHash(e);t&&t.id()!==this.currentId()&&this.changeCurrentAccount(t.id(),!1)},f.prototype.changeCurrentAccount=function(e,t){var i=this.getCurrent(),s=this.getAccount(e);s&&this.currentId()!==e?(i&&i.isCurrent(!1),this.currentId(e),s.isCurrent(!0)):i||this.currentId(0),t&&a.setHash(u.getMailbox())},f.prototype.changeEditedAccountByHash=function(e){var t=this.getAccountByHash(e);t&&t.id()!==this.editedId()&&this.changeEditedAccount(t.id())},f.prototype.changeEditedAccount=function(e){var t=this.getEdited(),i=this.getAccount(e);i&&this.editedId()!==e?(t&&t.isEdited(!1),this.editedId(e),i.isEdited(!0)):t||this.editedId(0)},f.prototype.getDefaultFriendlyName=function(){var e=this.getCurrent(),t=s.find(e&&e.identities()||[],(function(e){return e.isDefault()}))||e;return t?t.friendlyName()||t.email():""},f.prototype.getIdentityByHash=function(e){var t=null;return s.each(this.collection(),(function(i){t||(t=s.find(i.identities()||[],(function(t){return t.hash()===e})))}),this),t},f.prototype.getFetcherByHash=function(e){var t=null;return s.each(this.collection(),(function(i){t||(t=s.find(i.fetchers(),(function(t){return t.hash()===e})))}),this),t},f.prototype.getAliasByHash=function(e){var t=null;return s.each(this.collection(),(function(i){t||(t=s.find(i.aliases()||[],(function(t){return t.hash()===e})))}),this),t},f.prototype.parse=function(e){s.isArray(e)&&(this.collection(s.map(e,(function(e){return new d(e)}))),this.initObservables(this.collection().length>0?this.collection()[0].id():0))},f.prototype.initObservables=function(e){var t=this.getAccount(e);t&&(t.isCurrent(!0),t.isEdited(!0)),this.currentId=n.observable(e),this.editedId=n.observable(e)},f.prototype.hasAccount=function(){return this.collection().length>0},f.prototype.getAccount=function(e){return s.find(this.collection(),(function(t){return t.id()===e}),this)},f.prototype.getDefault=function(){return s.find(this.collection(),(function(e){return e.bDefault}),this)},f.prototype.getCurrent=function(){return this.getAccount(this.currentId())},f.prototype.getEdited=function(){return this.getAccount(this.editedId())},f.prototype.getEmail=function(e){e=e||this.currentId();var t="",i=this.getAccount(e);return i&&(t=i.email()),t},f.prototype.addAccount=function(e){this.collection.push(e)},f.prototype.deleteAccount=function(e){this.collection.remove((function(t){return t.id()===e}));var t=this.collection().length>0?this.collection()[0].id():0;this.changeCurrentAccount(t,!1),this.changeEditedAccount(t)},f.prototype.hasAccountWithId=function(e){return!!s.find(this.collection(),(function(t){return t.id()===e}),this)},f.prototype.populateFetchersIdentities=function(){this.populateFetchers(),this.populateIdentities(),this.populateAliases()},f.prototype.populateFetchers=function(){c.AllowFetchers&&l.send(c.FetchersServerModuleName,"GetFetchers",{AccountID:this.editedId()},this.onGetFetchersResponse,this)},f.prototype.populateAliases=function(e){c.AllowAliases&&l.send(c.AliasesServerModuleName,"GetAliases",{AccountID:this.editedId()},(function(t,i){this.onGetAliasesResponse(t,i),s.isFunction(e)&&e()}),this)},f.prototype.onGetFetchersResponse=function(e,t){var i={};o.isNonEmptyArray(e.Result)&&s.each(e.Result,(function(e){var t=new p;t.parse(e),i[t.accountId()]||(i[t.accountId()]=[]),i[t.accountId()].push(t)})),s.each(this.collection(),(function(e){var t=o.isNonEmptyArray(i[e.id()])?i[e.id()]:[];e.fetchers(t)}),this)},f.prototype.onGetAliasesResponse=function(e,t){var i={};e.Result&&o.isNonEmptyArray(e.Result.ObjAliases)&&s.each(e.Result.ObjAliases,(function(e){var t=new m;t.parse(e),i[t.accountId()]||(i[t.accountId()]=[]),i[t.accountId()].push(t)})),s.each(this.collection(),(function(e){var t=o.isNonEmptyArray(i[e.id()])?i[e.id()]:[];e.aliases(t)}),this)},f.prototype.populateIdentities=function(e){c.AllowIdentities&&this.collection().length>=1&&h.send("GetIdentities",null,(function(t,i){this.onGetIdentitiesResponse(t,i),s.isFunction(e)&&e()}),this)},f.prototype.onGetIdentitiesResponse=function(e,t){var i={};o.isNonEmptyArray(e.Result)&&s.each(e.Result,(function(e){var t,s=new g;s.parse(e),t=s.accountId(),i[t]||(i[t]=[]),i[t].push(s)})),s.each(this.collection(),(function(e){var t=i[e.id()],n=new g;o.isNonEmptyArray(t)||(t=[]),n.parse({"@Object":"Object/Aurora\\Modules\\Mail\\Classes\\Identity",AccountPart:!0,Default:!s.find(t,(function(e){return e.isDefault()})),Email:e.email(),FriendlyName:e.friendlyName(),IdAccount:e.id(),EntityId:1e5*e.id(),Signature:e.signature(),UseSignature:e.useSignature()}),t.unshift(n),e.identities(t)}))},f.prototype.populateIdentitiesFromSourceAccount=function(e){e&&s.each(this.collection(),(function(t){var i=e.getAccount(t.id());i&&(t.fetchers(i.fetchers()),t.identities(i.identities()),t.signature(i.signature()),t.useSignature(i.useSignature()))}))},f.prototype.getAccountsEmails=function(){return s.uniq(s.map(this.collection(),(function(e){return e.email()})))},f.prototype.getAllFullEmails=function(){var e=[];return s.each(this.collection(),(function(t){t&&(o.isNonEmptyArray(t.identities())?s.each(t.identities(),(function(t){e.push(t.fullEmail())})):e.push(t.fullEmail()),s.each(t.fetchers(),(function(t){t.isEnabled()&&t.isOutgoingEnabled()&&""!==t.fullEmail()&&e.push(t.fullEmail())})))})),e},f.prototype.getCurrentFetchersAndFiltersFolderNames=function(){var e=this.getCurrent(),t=[];return e&&(e.filters()&&s.each(e.filters().collection(),(function(e){t.push(e.folder())}),this),s.each(e.fetchers(),(function(e){t.push(e.folder())}),this)),t},f.prototype.getAttendee=function(e){var t=[],i="";return s.each(this.collection(),(function(e){t=e.isCurrent()?s.union([e.email()],e.getFetchersIdentitiesEmails(),t):s.union(t,[e.email()],e.getFetchersIdentitiesEmails())})),t=s.uniq(t),s.each(t,s.bind((function(t){""===i&&(s.find(e,(function(e){return e===t}))===t&&(i=t))}),this)),i};var b=new f;window.auroraAppData.Mail&&s.isArray(window.auroraAppData.Mail.Accounts)?b.parse(window.auroraAppData.Mail.Accounts):b.parse([]),r&&b.populateIdentitiesFromSourceAccount(r.getAccountList()),e.exports=b},jxK9:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("RN+F"),r=(i("AFLV"),i("ZP6a")),a=i("gcBV"),l=i("hPb3"),h=i("76Kh"),u=i("20Ah"),c=i("jonm"),d=i("4+IO"),p={deleteMessages:function(e,t){n.isFunction(t)||(t=function(){});var i=d.folderList(),s=i.currentFolderFullName(),r=i.trashFolder(),a=r&&s===r.fullName(),l=i.spamFolder(),c=function(i){i&&(d.deleteMessages(e),t())};l&&s===l.fullName()||a?h.showPopup(u,[o.i18n("MAILWEBCLIENT/CONFIRM_DELETE_MESSAGES_PLURAL",{},null,e.length),c,"",o.i18n("COREWEBCLIENT/ACTION_DELETE")]):d.oUnifiedInbox.selected()?p.deleteMessagesFromUnifiedInbox(e,t):r?(d.moveMessagesToFolder(i.currentFolder(),r,e),t()):h.showPopup(u,[o.i18n("MAILWEBCLIENT/CONFIRM_MESSAGES_DELETE_NO_TRASH_FOLDER"),c])},deleteMessagesFromUnifiedInbox:function(e,t){var i=!1,n=!1,r=d.getUidsSeparatedByAccounts(e),a=function(e,i,s){s&&(d.deleteMessagesFromFolder(e,i),t())};s.each(r,(function(e){var t=e.Uids,s=e.AccountId,r=d.oFolderListItems[s],l=c.getAccount(s),p=r?r.trashFolder():null,m=r?r.inboxFolder():null;m&&(p?(d.moveMessagesToFolder(m,p,t),i=!0):(h.showPopup(u,[o.i18n("MAILWEBCLIENT/CONFIRM_MESSAGES_DELETE_NO_TRASH_FOLDER"),a.bind(null,m,t),l?l.fullEmail():""]),n=!0))})),i&&!n&&t()},isAvailableRegisterMailto:function(){return window.navigator&&n.isFunction(window.navigator.registerProtocolHandler)},registerMailto:function(e){!p.isAvailableRegisterMailto()||e&&!0===a.getData("MailtoAsked")||(window.navigator.registerProtocolHandler("mailto",r.getAppPath()+"#mail/compose/to/%s",""!==l.SiteName?l.SiteName:"WebMail"),a.setData("MailtoAsked",!0))}};e.exports=p},ko8N:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("JFZZ"),l=i("SQrT"),h=i("hPb3"),u=i("yYIs");function c(){u.call(this,h.ServerModuleName),this.aLanguages=h.LanguageList,this.login=o.observable(h.AdminLogin),this.pass=o.observable(""),this.newPass=o.observable(""),this.confirmPass=o.observable(""),this.selectedLanguage=o.observable(h.AdminLanguage),this.passFocused=o.observable(!1),this.newPassFocused=o.observable(!1),this.startError=o.observable(""),this.setStartError()}s.extendOwn(c.prototype,u.prototype),c.prototype.ViewTemplate="AdminPanelWebclient_SecurityAdminSettingsView",c.prototype.setStartError=function(){var e=[];h.AdminHasPassword||e.push(r.i18n("ADMINPANELWEBCLIENT/ERROR_ADMIN_EMPTY_PASSWORD")),h.SaltNotEmpty||e.push(r.i18n("ADMINPANELWEBCLIENT/ERROR_SALT_EMPTY")),this.startError(e.join("<br /><br />"))},c.prototype.getStartError=function(){return this.startError},c.prototype.getCurrentValues=function(){return[this.login(),this.pass(),this.newPass(),this.confirmPass(),this.selectedLanguage()]},c.prototype.revertGlobalValues=function(){this.login(h.AdminLogin),this.pass(""),this.newPass(""),this.confirmPass(""),this.selectedLanguage(h.AdminLanguage)},c.prototype.getParametersForSave=function(){var e={AdminLogin:n.trim(this.login()),Password:n.trim(this.pass()),NewPassword:n.trim(this.newPass())};return this.selectedLanguage()!==h.AdminLanguage&&(e.AdminLanguage=this.selectedLanguage()),e},c.prototype.applySavedValues=function(e){this.selectedLanguage()!==h.AdminLanguage&&window.location.reload(),h.updateSecurity(e.AdminLogin,h.AdminHasPassword||""!==e.NewPassword),this.setStartError()},c.prototype.setAccessLevel=function(e,t){this.visible(""===e)},c.prototype.validateBeforeSave=function(){var e=n.trim(this.pass()),t=n.trim(this.newPass()),i=n.trim(this.confirmPass());return h.AdminHasPassword&&""===e&&""!==t?(l.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_CURRENT_PASSWORD_EMPTY")),this.passFocused(!0),!1):""!==e&&""===t?(l.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_NEW_PASSWORD_EMPTY")),this.newPassFocused(!0),!1):""===e||t===i||(l.showError(r.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")),this.newPassFocused(!0),!1)},c.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var i=t.Parameters;this.pass(""),this.newPass(""),this.confirmPass(""),this.updateSavedState(),this.applySavedValues(i),l.showReport(r.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))}else a.showErrorByCode(e,r.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},e.exports=new c},lPfU:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=null,a=i("xzvH"),l=i("p2hp");function h(){this.iAccountId=0,this.sFullName="",this.search=n.observable(""),this.filters=n.observable(""),this.sortBy=n.observable(l.MessagesSortBy.DefaultSortBy),this.sortOrder=n.observable(l.MessagesSortBy.DefaultSortOrder),this.resultCount=n.observable(-1),this.collection=n.observableArray([]),this.threadUids={}}h.prototype.requireMailCache=function(){null===r&&(r=i("4+IO"))},h.prototype.addThreadUids=function(e,t){-1!==s.indexOf(this.collection(),e)&&(this.threadUids[e]=t)},h.prototype.setUidsAndCount=function(e,t){"Collection/MessageCollection"===t["@Object"]&&(s.each(t.Uids,(function(t,i){this.collection()[i+e]=t.toString()}),this),this.resultCount(t.MessageResultCount))},h.prototype.getUidsForOffset=function(e){this.requireMailCache();for(var t=0,i=this.collection().length,s="",n=this.iAccountId,h=this.sFullName,u=0,c=[],d=null;t<i;t++)if(t>=e&&u<l.MailsPerPage){var p=s=this.collection()[t];if(void 0!==s&&this.sFullName===r.oUnifiedInbox.fullName()){var m=s.split(":");n=o.pInt(m[0]),h="INBOX",p=m[1]}((d=void 0===s?null:a.get([n,h,p]))&&!d.deleted()||void 0===s)&&(u++,void 0!==s&&c.push(s))}return c},h.prototype.deleteUids=function(e){for(var t=0,i=this.collection().length,n="",o=[],r=0;t<i;t++)n=this.collection()[t],-1===s.indexOf(e,n)?o.push(n):r++;this.collection(o),this.resultCount(this.resultCount()-r)},h.prototype.clearData=function(){this.resultCount(-1),this.collection([]),this.threadUids={}},e.exports=h},lRcT:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"Licensing",HashModuleName:"licensing",LicenseKey:"",TrialKeyLink:"",PermanentKeyLink:"",init:function(e){var t=e.LicensingWebclient,i=e[this.ServerModuleName];s.isEmpty(i)||(this.LicenseKey=n.pString(i.LicenseKey,this.LicenseKey)),s.isEmpty(t)||(this.TrialKeyLink=n.pString(t.TrialKeyLink,this.TrialKeyLink),this.PermanentKeyLink=n.pString(t.PermanentKeyLink,this.PermanentKeyLink))},update:function(e){this.LicenseKey=e}}},lXfK:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("OgeD"),a=i("SQrT"),l=r.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("sJNY");function u(){l.call(this,h.ServerModuleName),this.enable=n.observable(h.EnableModule),this.id=n.observable(h.Id),this.secret=n.observable(h.Secret),this.scopes=n.observable(h.getScopesCopy())}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="Facebook_AdminSettingsView",u.prototype.getCurrentValues=function(){var e=s.map(this.scopes(),(function(e){return e.Name+e.Value()}));return[this.enable(),this.id(),this.secret(),e]},u.prototype.revertGlobalValues=function(){this.enable(h.EnableModule),this.id(h.Id),this.secret(h.Secret),this.scopes(h.getScopesCopy())},u.prototype.validateBeforeSave=function(){return!this.enable()||""!==this.id()&&""!==this.secret()||(a.showError(o.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY")),!1)},u.prototype.getParametersForSave=function(){return{EnableModule:this.enable(),Id:this.id(),Secret:this.secret(),Scopes:s.map(this.scopes(),(function(e){return{Name:e.Name,Description:e.Description,Value:e.Value()}}))}},u.prototype.applySavedValues=function(e){h.updateAdmin(e.EnableModule,e.Id,e.Secret,e.Scopes)},u.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new u},ll04:function(e,t,i){"use strict";var s=i("F/us"),n=i("AFLV");e.exports={ServerModuleName:"ActiveServer",HashModuleName:"activeserver",EnableModule:!1,EnableModuleForUser:!1,EnableForNewUsers:!1,UsersCount:0,LicensedUsersCount:0,UsersFreeSlots:0,Server:"",LinkToManual:"",ProductName:"",init:function(e){var t=e.ActiveServer,i=e.Core;s.isEmpty(t)||(this.EnableModule=n.pBool(t.EnableModule,this.EnableModule),this.EnableModuleForUser=n.pBool(t.EnableModuleForUser,this.EnableModuleForUser),this.EnableForNewUsers=n.pBool(t.EnableForNewUsers,this.EnableForNewUsers),this.UsersCount=n.pInt(t.UsersCount,this.UsersCount),this.LicensedUsersCount=t.LicensedUsersCount,this.UsersFreeSlots=t.UsersFreeSlots,this.Server=t.Server,this.LinkToManual=t.LinkToManual,this.ProductName=i.ProductName)},updateAdmin:function(e,t,i,s){this.EnableModule=e,this.EnableForNewUsers=t,this.Server=i,this.LinkToManual=s}}},mjrp:function(e,t,i){"use strict";var s=i("EVdn"),n=i("F/us"),o=i("0h2I"),r=i("w+bY"),a=i("RN+F"),l=i("AFLV"),h=i("IAk5"),u=i("hPb3"),c=i("76Kh"),d=i("1grR"),p=u.MultipleFilesUploadLimit;function m(e){return void 0===e}function g(e){0<e&&clearTimeout(e),e=0}function f(e){return(e=e&&(e.originalEvent?e.originalEvent:e)||window.event).dataTransfer?e:null}function b(e,t,i){return e&&t&&!m(e[t])?e[t]:i}function v(e,t,i){e[t]=i}function y(){return"jua-uid-"+function(e){var t="",i="0123456789abcdefghijklmnopqrstuvwxyz";for(e=m(e)?32:l.pInt(e);t.length<e;)t+=i.substr(Math.round(Math.random()*i.length),1);return t}(16)+"-"+(new Date).getTime().toString()}function E(e,t){return{FileName:m(e.fileName)?m(e.name)?null:e.name:e.fileName,Size:m(e.fileSize)?m(e.size)?null:e.size:e.fileSize,Type:m(e.type)?null:e.type,Folder:m(t)?"":t,File:e}}function S(e,t,i,s,n,o){var r=0,a=0,h=0,u=null,c=null,d=!1,g=!1,f=function(e,t,i,a){if(e&&!m(e.name))if(t=t||"",e.isFile)e.file((function(e){!d||0<=--n?i(E(e,t)):d&&!g&&0>n&&o&&(g=!0,o(r))}));else if(s&&e.isDirectory&&e.createReader){var h=e.createReader(),u=0,c=0;h&&h.readEntries&&h.readEntries((function(s){if(s&&l.isNonEmptyArray(s))for(u=0,c=s.length;u<c;u++)f(s[u],t+e.name+"/",i,a)}))}};if(s=!!m(s)||!!s,i=!m(i)&&!!i,n=m(n)?p:l.pInt(n),r=n,d=0<n,e=e&&0<e.length?e:null)for(h=0,a=e.length;h<a;h++)(u=e[h])&&(i?"file"===u.kind&&u.webkitGetAsEntry&&(c=u.webkitGetAsEntry())&&f(c,"",t,o):!d||0<=--n?t(E(u)):d&&!g&&0>n&&o&&(g=!0,o(r)))}function A(e,t,i,s){var n=e&&e.files&&0<e.files.length?e.files:null;n?S(n,t,!1,!1,i,s):t({FileName:e.value.split("\\").pop().split("/").pop(),Size:null,Type:null,Folder:"",File:null})}function I(e){var t=!1;if(e&&e.dataTransfer&&e.dataTransfer.types&&e.dataTransfer.types.length)for(var i=0,s=e.dataTransfer.types.length;i<s;i++)if("files"===e.dataTransfer.types[i].toLowerCase()){t=!0;break}return t}function T(){return s('<label style="position: absolute; background-color:#fff; right: 0px; top: 0px; left: 0px; bottom: 0px; margin: 0px; padding: 0px; cursor: pointer;"></label>').css({opacity:0})}function C(e,t,i,n){e=m(e)?"":e.toString();var o=function(e,t){return""!==t&&(t=' accept="'+t+'"'),s('<input type="file" tabindex="-1" hidefocus="hidefocus" style="position: absolute; '+e+': -9999px;"'+t+" />")}(i=m(i)?"left":i.toString(),n=m(n)?"":n.toString());return 0<e.length&&o.attr("name",e),(m(t)||t)&&o.prop("multiple",!0),o}function F(e,t){return l.pString(n.isFunction(e)?e.apply(null,n.isArray(t)?t:[]):e)}function L(e,t){this.oXhrs={},this.oUids={},this.oJua=e,this.oOptions=t}function M(e,t){this.oUids={},this.oForms={},this.oJua=e,this.oOptions=t}function w(e){e=m(e)?{}:e;var t=this;t.bEnableDnD=!0,t.bEnableButton=!0,t.oEvents={onDialog:null,onSelect:null,onStart:null,onComplete:null,onCompleteAll:null,onProgress:null,onDragEnter:null,onDragLeave:null,onDrop:null,onBodyDragEnter:null,onBodyDragLeave:null,onLimitReached:function(){c.showPopup(d,[a.i18n("COREWEBCLIENT/ERROR_UPLOAD_NUMBER_LIMIT_PLURAL",{NUMBERLIMIT:p},null,p)])}},t.oOptions=n.extend({action:"",name:"",hidden:{},queueSize:10,clickElement:!1,dragAndDropElement:!1,dragAndDropBodyElement:!1,disableAjaxUpload:!1,disableFolderDragAndDrop:!0,disableDragAndDrop:!1,disableMultiple:!1,disableDocumentDropPrevent:!1,disableAutoUploadOnDrop:!1,multipleSizeLimit:p,hiddenElementsPosition:"left"},e),t.oQueue=r(l.pInt(b(t.oOptions,"queueSize",10))),t.runEvent("onCompleteAll")&&t.oQueue.await((function(){t.runEvent("onCompleteAll")})),t.oDriver=t.isAjaxUploaderSupported()&&!b(t.oOptions,"disableAjaxUpload",!1)?new L(t,t.oOptions):new M(t,t.oOptions),t.oClickElement=b(t.oOptions,"clickElement",null),t.oClickElement&&(s(t.oClickElement).css({position:"relative",overflow:"hidden"}),"inline"===s(this.oClickElement).css("display")&&s(this.oClickElement).css("display","inline-block"),this.oDriver.generateNewInput(this.oClickElement)),this.oDriver.isDragAndDropSupported()&&b(this.oOptions,"dragAndDropElement",!1)&&!b(this.oOptions,"disableAjaxUpload",!1)?function(e){var t=s(document),i=s(b(e.oOptions,"dragAndDropBodyElement",!1)||t),n=b(e.oOptions,"dragAndDropElement",!1);n&&(b(e.oOptions,"disableDocumentDropPrevent",!1)||t.on("dragover",(function(t){if(e.bEnableDnD&&t&&(t=f(t))&&t.dataTransfer&&I(t))try{t.dataTransfer.dropEffect="none",t.preventDefault()}catch(e){}})),i&&i[0]&&i.on("dragover",(function(t){e.bEnableDnD&&t&&g(e.iDocTimer)})).on("dragenter",(function(t){e.bEnableDnD&&t&&(t=f(t))&&I(t)&&(g(e.iDocTimer),t.preventDefault(),e.runEvent("onBodyDragEnter",[t]))})).on("dragleave",(function(t){e.bEnableDnD&&t&&(t=f(t))&&(g(e.iDocTimer),e.iDocTimer=setTimeout((function(){e.runEvent("onBodyDragLeave",[t])}),200))})).on("drop",(function(t){if(e.bEnableDnD&&t&&(t=f(t))){var i=I(t);return i&&t.preventDefault(),e.runEvent("onBodyDragLeave",[t]),!i}return!1})),s(n).bind("dragenter",(function(t){e.bEnableDnD&&t&&(t=f(t))&&I(t)&&(g(e.iDocTimer),t.preventDefault(),e.runEvent("onDragEnter",[n,t]))})).bind("dragover",(function(t){if(e.bEnableDnD&&t&&(t=f(t))&&t.dataTransfer&&I(t))try{var s=t.dataTransfer.effectAllowed;g(e.iDocTimer),t.dataTransfer.dropEffect="move"===s||"linkMove"===s?"move":"copy",t.stopPropagation(),t.preventDefault(),i.trigger("dragover",t)}catch(e){}})).bind("dragleave",(function(t){if(e.bEnableDnD&&t){if(t=f(t)){var i=document.elementFromPoint?document.elementFromPoint(t.clientX,t.clientY):null;if(i&&(o=i,r=!1,(s=this)&&o&&(r=s===o||(s.contains?s.contains(o):!!o.compareDocumentPosition&&!!(8&o.compareDocumentPosition(s)))),r))return;g(e.iDocTimer),e.runEvent("onDragLeave",[n,t])}}else var s,o,r})).bind("drop",(function(t){e.bEnableDnD&&t&&(t=f(t))&&I(t)&&(t.preventDefault(),function(e,t,i,s,n){var o=null,r=null;(e=f(e))&&((o=(e.dataTransfer?b(e.dataTransfer,"items",null):null)||b(e,"items",null))&&0<o.length&&o[0]&&o[0].webkitGetAsEntry?S(o,t,!0,n,i,s):I(e)&&(r=b(e,"files",null)||(e.dataTransfer?b(e.dataTransfer,"files",null):null))&&0<r.length&&S(r,t,!1,!1,i,s))}(t,(function(i){i&&(b(e.oOptions,"disableAutoUploadOnDrop",!1)?e.runEvent("onDrop",[i,t,function(){e.addNewFile(i),g(e.iDocTimer)}]):(e.runEvent("onDrop",[i,t]),e.addNewFile(i),g(e.iDocTimer)))}),b(e.oOptions,"multipleSizeLimit",p),e.getEvent("onLimitReached"),!b(e.oOptions,"disableFolderDragAndDrop",!0))),e.runEvent("onDragLeave",[t])})))}(t):t.bEnableDnD=!1,v(t,"on",t.on),v(t,"cancel",t.cancel),v(t,"isDragAndDropSupported",t.isDragAndDropSupported),v(t,"isAjaxUploaderSupported",t.isAjaxUploaderSupported),v(t,"setDragAndDropEnabledStatus",t.setDragAndDropEnabledStatus)}L.prototype.oXhrs={},L.prototype.oUids={},L.prototype.oJua=null,L.prototype.oOptions={},L.prototype.isDragAndDropSupported=function(){return!0},L.prototype.regTaskUid=function(e){this.oUids[e]=!0},L.prototype.uploadTask=function(e,t,i,o,r,a,l){if(!1===this.oUids[e]||!t||!t.File)return o(null,e),!1;try{var h=this,u=new XMLHttpRequest,c=new FormData,d=b(this.oOptions,"action",""),p=n.clone(b(this.oOptions,"hidden",{})),g=this.oJua.getEvent("onStart"),f=this.oJua.getEvent("onComplete"),v=this.oJua.getEvent("onProgress");return u.open("POST",d,!0),u.setRequestHeader("Authorization","Bearer "+s.cookie("AuthToken")),u.setRequestHeader("X-Client","WebClient"),v&&u.upload&&(u.upload.onprogress=function(i){i&&i.lengthComputable&&!m(i.loaded)&&!m(i.total)&&(void 0===l?v(e,i.loaded,i.total):v(e,l+i.loaded>t.Size?t.Size:l+i.loaded,t.Size))}),u.onreadystatechange=function(){if(4===u.readyState&&200===u.status){if(f&&!r){var t=!1,i=null;try{i=s.parseJSON(u.responseText),t=!0}catch(e){i=null}f(e,t,i)}m(h.oXhrs[e])||(h.oXhrs[e]=null),o(a?u.responseText:null,e)}else 4===u.readyState&&(f(e,!1,null),o(null,e))},g&&g(e),c.append("jua-post-type","ajax"),c.append(b(this.oOptions,"name","juaFile"),t.File,t.FileName),i=n.extend(i,t.Hidden||{}),p.Parameters=JSON.stringify(i),s.each(p,(function(e,i){c.append(e,F(i,[t]))})),u.send(c),this.oXhrs[e]=u,!0}catch(e){window.console&&window.console.error(e)}return o(null,e),!1},L.prototype.generateNewInput=function(e){var t=this,i=null,n=null;e&&(n=C("",!b(this.oOptions,"disableMultiple",!1),b(this.oOptions,"hiddenElementsPosition","left"),b(this.oOptions,"accept","")),(i=T()).append(n),s(e).append(i),n.on("click",(function(e){if(t.oJua.bEnableButton){var i=t.oJua.getEvent("onDialog");i&&i()}else e.preventDefault()})).on("change",(function(){A(this,(function(s){t.oJua.addNewFile(s),t.generateNewInput(e),setTimeout((function(){i.remove()}),10)}),b(t.oOptions,"multipleSizeLimit",p),t.oJua.getEvent("onLimitReached"))})))},L.prototype.cancel=function(e){if(this.oUids[e]=!1,this.oXhrs[e]){try{this.oXhrs[e].abort&&this.oXhrs[e].abort()}catch(e){}this.oXhrs[e]=null}},M.prototype.oUids={},M.prototype.oForms={},M.prototype.oJua=null,M.prototype.oOptions={},M.prototype.isDragAndDropSupported=function(){return!1},M.prototype.regTaskUid=function(e){this.oUids[e]=!0},M.prototype.uploadTask=function(e,t,i,o,r,a,l){if(!1===this.oUids[e])return o(null,e),!1;var h=this.oForms[e],u=n.clone(b(this.oOptions,"hidden",{})),c=this.oJua.getEvent("onStart"),d=this.oJua.getEvent("onComplete");return h?(h.append(s('<input type="hidden" />').attr("name","jua-post-type").val("iframe")),i=n.extend(i,t.Hidden||{}),u.Parameters=JSON.stringify(i),s.each(u,(function(e,i){h.append(s('<input type="hidden" />').attr("name",e).val(F(i,[t])))})),h.trigger("submit"),c&&c(e),h.find("iframe").on("load",(function(t){var i=!1,n=null,r={};if(d){try{n=this.contentDocument?this.contentDocument:this.contentWindow.document,r=s.parseJSON(n.body.innerHTML),i=!0}catch(e){r={}}d(e,i,r)}o(null,e),window.setTimeout((function(){h.remove()}),100)}))):o(null,e),!0},M.prototype.generateNewInput=function(e){var t=this,i="",n=null,o=null,r=b(this.oOptions,"action",""),a=null,l=b(this.oOptions,"hiddenElementsPosition","left");e&&(i=y(),n=C(b(this.oOptions,"name","juaFile"),!b(this.oOptions,"disableMultiple",!1),b(this.oOptions,"hiddenElementsPosition","left"),b(this.oOptions,"accept","")),a=s('<form action="'+r+'" target="iframe-'+i+'"  method="POST" enctype="multipart/form-data" style="display: block; cursor: pointer;"></form>'),o=s('<iframe name="iframe-'+i+'" tabindex="-1" src="javascript:void(0);"  style="position: absolute; top: -1000px; '+l+': -1000px; cursor: pointer;" />').css({opacity:0}),a.append(T().append(n)).append(o),s(e).append(a),this.oForms[i]=a,n.on("click",(function(e){if(t.oJua.bEnableButton){var i=t.oJua.getEvent("onDialog");i&&i()}else e.preventDefault()})).on("change",(function(){A(this,(function(s){if(s){var n=b(t.oOptions,"hiddenElementsPosition","left");a.css({position:"absolute",top:-1e3}),a.css(n,-1e3),t.oJua.addFile(i,s),t.generateNewInput(e)}}),b(t.oOptions,"multipleSizeLimit",p),t.oJua.getEvent("onLimitReached"))})))},M.prototype.cancel=function(e){this.oUids[e]=!1,this.oForms[e]&&(this.oForms[e].remove(),this.oForms[e]=!1)},w.prototype.bEnableDnD=!0,w.prototype.iDocTimer=0,w.prototype.oOptions={},w.prototype.oEvents={},w.prototype.oQueue=null,w.prototype.oDriver=null,w.prototype.on=function(e,t){return this.oEvents[e]=t,this},w.prototype.runEvent=function(e,t){this.oEvents[e]&&this.oEvents[e].apply(null,t||[])},w.prototype.getEvent=function(e){return this.oEvents[e]||null},w.prototype.cancel=function(e){this.oDriver.cancel(e)},w.prototype.isAjaxUploaderSupported=function(){return(e=document.createElement("input")).type="file",!!("XMLHttpRequest"in window&&"multiple"in e&&"FormData"in window&&(new XMLHttpRequest).upload);var e},w.prototype.setDragAndDropEnabledStatus=function(e){this.bEnableDnD=!!e},w.prototype.isDragAndDropSupported=function(){return this.oDriver.isDragAndDropSupported()},w.prototype.addNewFile=function(e){this.addFile(y(),e)},w.prototype.addFile=function(e,t){var i=this.getEvent("onSelect"),r=null,a=b(this.oOptions,"hidden",{}),l=this.getEvent("onComplete"),u=n.bind((function(e,t){var i,s,n=b(this.oOptions,"hidden",{}),o=JSON.parse(F(n.Parameters,[t]));this.oDriver.regTaskUid(e),this.oQueue.defer((i=this.oDriver.uploadTask,s=this.oDriver,function(){return i.apply(m(s)?null:s,Array.prototype.slice.call(arguments))}),e,t,o)}),this),c=this.getEvent("onCancel");if(!t||i&&!1===i(e,t))this.oDriver.cancel(e);else{r=n.bind((function(e,t,i,n,o,a){var u;u=function(t,n){var o=null;try{o=s.parseJSON(t)}catch(e){}o&&o.Result&&!o.Result.Error&&!o.ErrorCode?i(e,r):o&&o.Result&&o.Result.Error?(h.broadcastEvent("Jua::FileUploadingError"),l(n,!1,{ErrorCode:o.Result.Error})):o&&o.ErrorCode?(h.broadcastEvent("Jua::FileUploadingError"),l(n,!1,{ErrorCode:o.ErrorCode})):(h.broadcastEvent("Jua::FileUploadingError"),l(n,!1))};var c=b(this.oOptions,"hidden",{}),d=JSON.parse(F(c.Parameters,[t]));this.oDriver.regTaskUid(e),this.oDriver.uploadTask(e,t,d,u,n<o,!0,a)}),this);var d=o.observable(!0),p=JSON.parse(F(a.Parameters,[t]));h.broadcastEvent("Jua::FileUpload::isUploadAvailable",{isUploadAvailable:d,sModuleName:a.Module,sUid:e,oFileInfo:t}),d()?!1===h.broadcastEvent("Jua::FileUpload::before",{sUid:e,oFileInfo:t,fOnChunkReadyCallback:r,sModuleName:a.Module,fRegularUploadFileCallback:u,fCancelFunction:c,sStorageType:p.Type})&&u(e,t):n.isFunction(c)&&c(e)}},w.prototype.setOption=function(e,t){this.oOptions[e]=t},e.exports=w},mrHt:function(e,t,i){"use strict";var s=i("o0Bx"),n=i("61ci");s.registerAbortRequestHandler(n.ServerModuleName,(function(e,t){switch(e.Method){case"GetUsers":return"GetUsers"===t.Method;case"GetTenants":return"GetTenants"===t.Method}return!1})),e.exports={send:function(e,t,i,o){s.send(n.ServerModuleName,e,t,i,o)}}},nIpt:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("uN/E"),a=i("RN+F"),l=i("AFLV"),h=i("o0Bx"),u=i("JFZZ"),c=i("ZCBP"),d=i("hPb3"),p=i("XjIm"),m=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass");function g(){m.call(this,"Core"),this.iViewLogSizeBytes=p.ViewLastLogSize,this.aLevelOptions=[{text:a.i18n("LOGSVIEWERWEBCLIENT/LABEL_LOGGING_DEBUG"),value:Enums.LogLevel.Full},{text:a.i18n("LOGSVIEWERWEBCLIENT/LABEL_LOGGING_WARNINGS"),value:Enums.LogLevel.Warning},{text:a.i18n("LOGSVIEWERWEBCLIENT/LABEL_LOGGING_ERRORS"),value:Enums.LogLevel.Error}],this.logSize=o.observable(p.LogSizeBytes),this.downloadLogText=o.computed((function(){return a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_DOWNLOAD",{SIZE:a.getFriendlySize(this.logSize())})}),this),this.viewLogText=o.computed((function(){return this.logSize()<this.iViewLogSizeBytes?a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_VIEW"):a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_VIEW_LAST",{SIZE:a.getFriendlySize(this.iViewLogSizeBytes)})}),this),this.eventsLogSize=o.observable(p.EventLogSizeBytes),this.downloadEventsLogText=o.computed((function(){return a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_DOWNLOAD_EVENTS",{SIZE:a.getFriendlySize(this.eventsLogSize())})}),this),this.viewEventsLogText=o.computed((function(){return this.eventsLogSize()<this.iViewLogSizeBytes?a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_VIEW"):a.i18n("LOGSVIEWERWEBCLIENT/BUTTON_LOGGING_VIEW_LAST",{SIZE:a.getFriendlySize(this.iViewLogSizeBytes)})}),this),this.usersWithSeparateLog=o.observableArray([]),this.enableLogging=o.observable(p.EnableLogging),this.enableEventLogging=o.observable(p.EnableEventLogging),this.loggingLevel=o.observable(p.LoggingLevel)}s.extendOwn(g.prototype,m.prototype),g.prototype.ViewTemplate="LogsViewerWebclient_AdminSettingsView",g.prototype.onRouteChild=function(){this.setUpdateStatusTimer(),""===d.DbLogin||""===d.DbName||""===d.DbHost||h.send(p.ServerModuleName,"GetUsersWithSeparateLog",null,(function(e){e.Result?this.usersWithSeparateLog(s.isArray(e.Result)?e.Result:[]):u.showErrorByCode(e)}),this)},g.prototype.turnOffSeparateLogs=function(){this.usersWithSeparateLog([]),h.send(p.ServerModuleName,"TurnOffSeparateLogs")},g.prototype.clearSeparateLogs=function(){h.send(p.ServerModuleName,"ClearSeparateLogs")},g.prototype.setUpdateStatusTimer=function(){this.bShown&&setTimeout(s.bind((function(){h.send(p.ServerModuleName,"GetLogFilesData",null,(function(e){e.Result&&(p.updateLogsData(e.Result),this.logSize(p.LogSizeBytes),this.eventsLogSize(p.EventLogSizeBytes)),this.setUpdateStatusTimer()}),this)}),this),5e3)},g.prototype.getCurrentValues=function(){return[this.enableLogging(),this.enableEventLogging(),l.pInt(this.loggingLevel())]},g.prototype.revertGlobalValues=function(){this.enableLogging(p.EnableLogging),this.enableEventLogging(p.EnableEventLogging),this.loggingLevel(p.LoggingLevel)},g.prototype.getParametersForSave=function(){return{EnableLogging:this.enableLogging(),EnableEventLogging:this.enableEventLogging(),LoggingLevel:l.pInt(this.loggingLevel())}},g.prototype.applySavedValues=function(e){p.updateLogging(e.EnableLogging,e.EnableEventLogging,e.LoggingLevel)},g.prototype.setAccessLevel=function(e,t){this.visible(""===e)},g.prototype.downloadLog=function(e,t){h.send(p.ServerModuleName,"GetLogFile",{EventsLog:e,PublicId:t||""},(function(i){var s=new Blob([i.ResponseText],{type:"text/plain;charset=utf-8"}),n=""!==l.pString(t)?t+"-":"";r.saveAs(s,e?p.EventLogFileName:n+p.LogFileName)}),this,void 0,{Format:"Raw"})},g.prototype.viewLog=function(e){h.send(p.ServerModuleName,"GetLog",{EventsLog:e},(function(e){if(e.Result){var t=c.open("","view-log");t&&n(t.document.body).html("<pre>"+e.Result+"</pre>")}}),this)},g.prototype.clearLog=function(e){h.send(p.ServerModuleName,"ClearLog",{EventsLog:e},(function(t){t.Result&&(e?this.eventsLogSize(0):this.logSize(0))}),this)},e.exports=new g},o0Wm:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("AFLV"),a=i("Yjhd"),l=i("o0Bx"),h=i("JFZZ"),u=i("IAk5"),c=i("SQrT"),d=i("fIp0"),p=i("76Kh"),m=i("20Ah"),g=i("pvQt"),f=i("TAkd"),b=i("61ci");function v(e){this.bToolbarDisabled=u.getUserRole()===Enums.UserRole.TenantAdmin&&"Tenant"===e,g.selectedTenantId.subscribe((function(){"Tenant"!==this.sType&&this.requestEntities()}),this),this.sType=e,this.oEntityCreateView=f.getEditView(this.sType),this.oEntityData=f.getEntityData(this.sType),this.sActionCreateText=this.oEntityData.ActionCreateText,this.sNoEntitiesFoundText=this.oEntityData.NoEntitiesFoundText,this.entities=n.observableArray([]),this.aFilters=[],this.initFilters(),this.errorMessage=n.observable(""),this.totalEntitiesCount=n.observable(0),this.entitiesCountText=n.computed((function(){return this.oEntityData.EntitiesCountText?this.oEntityData.EntitiesCountText.replace(/%COUNT%/g,this.totalEntitiesCount()):""}),this),this.current=n.observable(0),this.showCreateForm=n.observable(!1),this.isCreating=n.observable(!1),this.hasSelectedEntity=n.computed((function(){return!!s.find(this.entities(),function(e){return e.Id===this.current()}.bind(this))}),this),this.idToDisplayAfterGetTenants=n.observable(0),this.fChangeEntityHandler=function(){},n.computed((function(){0===this.idToDisplayAfterGetTenants()&&!this.showCreateForm()&&!this.hasSelectedEntity()&&this.entities().length>0&&this.fChangeEntityHandler(this.sType,this.entities()[0].Id)}),this).extend({throttle:1}),this.checkedEntities=n.computed((function(){return s.filter(this.entities(),(function(e){return e.checked()}),this)}),this),this.hasCheckedEntities=n.computed((function(){return this.checkedEntities().length>0}),this),this.deleteCommand=a.createCommand(this,this.deleteCheckedEntities,this.hasCheckedEntities),this.selectedCount=n.computed((function(){return this.checkedEntities().length}),this),this.searchValue=n.observable(""),this.newSearchValue=n.observable(""),this.isSearchFocused=n.observable(!1),this.loading=n.observable(!1),this.searchText=n.computed((function(){return o.i18n("ADMINPANELWEBCLIENT/INFO_SEARCH_RESULT",{SEARCH:this.searchValue()})}),this),this.oPageSwitcher=new d(0,b.EntitiesPerPage),this.oPageSwitcher.currentPage.subscribe((function(){this.requestEntities()}),this),this.totalEntitiesCount.subscribe((function(){this.oPageSwitcher.setCount(this.totalEntitiesCount())}),this),this.aIdListDeleteProcess=[],this.aAdditionalButtons=[],this.initAdditionalButtons()}v.prototype.ViewTemplate="AdminPanelWebclient_EntitiesView",v.prototype.CreateFormViewTemplate="AdminPanelWebclient_EntityCreateFormView",v.prototype.onShow=function(){this.bShown=!0,this.requestEntities()},v.prototype.onHide=function(){this.bShown=!1},v.prototype.hasEntity=function(e){return!!s.find(this.entities(),(function(t){return t.Id===e}))},v.prototype.setPageAndEntity=function(e,t){this.oPageSwitcher.currentPage()!==e&&(this.idToDisplayAfterGetTenants(t),this.oPageSwitcher.setPage(e,b.EntitiesPerPage))},v.prototype.search=function(){this.oPageSwitcher.setPage(1,b.EntitiesPerPage),this.requestEntities()},v.prototype.clearSearch=function(){this.newSearchValue(""),this.requestEntities()},v.prototype.initFilters=function(){s.each(this.oEntityData.Filters,function(e){var t={list:n.computed((function(){var t=[];return s.isFunction(e.mList)?(t=e.mList(),s.isArray(t)||(t=[])):s.isArray(e.mList)&&(t=e.mList),t.length>0&&(e.sAllText&&t.unshift({text:e.sAllText,value:-1}),e.sNotInAnyText&&t.push({text:e.sNotInAnyText,value:0})),t}),this),selectedValue:n.observable(-1),requestValue:n.observable(-1),sAllText:e.sAllText,sFileld:e.sField,sEntity:e.sEntity};t.selectedValue.subscribe((function(){t.sEntity?this.fChangeEntityHandler(t.sEntity,t.selectedValue()):t.requestValue(t.selectedValue())}),this),t.requestValue.subscribe((function(){this.requestEntities()}),this),this.aFilters.push(t)}.bind(this))},v.prototype.initAdditionalButtons=function(){s.each(this.oEntityData.AdditionalButtons,function(e){e&&e.ButtonView&&(s.isFunction(e.ButtonView.init)&&e.ButtonView.init(this.hasCheckedEntities,this.checkedEntities),this.aAdditionalButtons.push(e))}.bind(this))},v.prototype.requestEntities=function(){if(this.bShown&&("Tenant"===this.sType||r.isPositiveNumber(g.selectedTenantId()))){var e=this.sType,t={TenantId:g.selectedTenantId(),Type:e,Offset:(this.oPageSwitcher.currentPage()-1)*b.EntitiesPerPage,Limit:b.EntitiesPerPage,Search:this.newSearchValue()};s.each(this.aFilters,(function(e){t[e.sFileld]=e.requestValue()})),this.searchValue(this.newSearchValue()),this.loading(!0),this.errorMessage(""),l.send(this.oEntityData.ServerModuleName,this.oEntityData.GetListRequest,t,(function(t){if(this.loading(!1),t.Result){var i=s.isArray(t.Result.Items)?t.Result.Items:[],o=[],a=r.pInt(t.Result.Count);s.each(i,(function(t){t&&t.Id&&(t.Id=r.pInt(t.Id),t.bItsMe="Tenant"===e&&t.Id===u.getTenantId()||"User"===e&&t.Id===u.getUserId(),t.bIsDefault=!!t.IsDefault,t.checked=n.observable(!1),t.trottleChecked=function(e,t){t.stopPropagation(),this.bItsMe||this.bIsDefault||this.checked(!this.checked())},o.push(t))})),this.entities(o),this.totalEntitiesCount(a),0===this.entities().length?this.fChangeEntityHandler(e,void 0,"create"):0!==this.idToDisplayAfterGetTenants()&&this.fChangeEntityHandler(e,this.idToDisplayAfterGetTenants()),this.aIdListDeleteProcess=[]}else r.isNonEmptyString(t.ErrorMessage)?this.errorMessage(t.ErrorMessage):h.showErrorByCode(t),this.entities([])}),this)}},v.prototype.setChangeEntityHandler=function(e){this.fChangeEntityHandler=e},v.prototype.changeEntity=function(e,t){s.each(this.aFilters,function(e){t[e.sEntity]?(e.selectedValue(t[e.sEntity]),e.requestValue(t[e.sEntity])):e.selectedValue()<=0?e.requestValue(e.selectedValue()):(e.selectedValue(-1),e.requestValue(-1))}.bind(this)),this.current(r.pInt(e)),this.idToDisplayAfterGetTenants(0)},v.prototype.openCreateForm=function(){this.showCreateForm(!0),this.oEntityCreateView.clearFields()},v.prototype.cancelCreatingEntity=function(){this.showCreateForm(!1)},v.prototype.createEntity=function(){if(this.oEntityCreateView&&("Tenant"===this.sType||r.isPositiveNumber(g.selectedTenantId()))&&(!s.isFunction(this.oEntityCreateView.isValidSaveData)||this.oEntityCreateView.isValidSaveData())){var e=this.oEntityCreateView.getParametersForSave();e.TenantId=g.selectedTenantId(),this.isCreating(!0),l.send(this.oEntityData.ServerModuleName,this.oEntityData.CreateRequest,e,(function(e){e.Result?(c.showReport(this.oEntityData.ReportSuccessCreateText),this.idToDisplayAfterGetTenants(r.pInt(e.Result)),this.oEntityCreateView.updateSavedState(),this.cancelCreatingEntity()):h.showErrorByCode(e,this.oEntityData.ErrorCreateText),this.requestEntities(),this.isCreating(!1)}),this)}},v.prototype.deleteCurrentEntity=function(){this.deleteEntities([this.current()])},v.prototype.deleteCheckedEntities=function(){var e=s.map(this.checkedEntities(),(function(e){return e.Id}));this.deleteEntities(e)},v.prototype.deleteEntities=function(e){if(this.oEntityData.DeleteRequest&&(r.isNonEmptyArray(this.aIdListDeleteProcess)?(e=s.difference(e,this.aIdListDeleteProcess),this.aIdListDeleteProcess=s.union(e,this.aIdListDeleteProcess)):this.aIdListDeleteProcess=e,e.length>0)){var t="",i=1===e.length?s.find(this.entities(),(function(t){return t.Id===e[0]})):null,n={Type:this.sType,Count:e.length,ConfirmText:o.i18n(this.oEntityData.ConfirmDeleteLangConst,{},null,e.length)};i&&(t=i.Name||i.PublicId),u.broadcastEvent("ConfirmDeleteEntity::before",n),p.showPopup(m,[n.ConfirmText,s.bind(this.confirmedDeleteEntities,this,e),t,o.i18n("COREWEBCLIENT/ACTION_DELETE")])}},v.prototype.confirmedDeleteEntities=function(e,t){if(t&&r.isPositiveNumber(g.selectedTenantId())){var i={TenantId:g.selectedTenantId(),Type:this.sType,IdList:e,DeletionConfirmedByAdmin:!0};l.send(this.oEntityData.ServerModuleName,this.oEntityData.DeleteRequest,i,(function(t){t.Result?c.showReport(o.i18n(this.oEntityData.ReportSuccessDeleteLangConst,{},null,e.length)):h.showErrorByCode(t,o.i18n(this.oEntityData.ErrorDeleteLangConst,{},null,e.length)),this.requestEntities()}),this)}else this.aIdListDeleteProcess=[]},v.prototype.groupCheck=function(){var e=!this.hasCheckedEntities();s.each(this.entities(),(function(t){t.bItsMe||t.bIsDefault||t.checked(e)}))},e.exports=v},p2hp:function(e,t,i){"use strict";var s=i("0h2I"),n=i("F/us"),o=i("AFLV"),r=i("IAk5");e.exports={ServerModuleName:"Mail",HashModuleName:"mail",FetchersServerModuleName:"MtaConnector",AliasesServerModuleName:"CpanelIntegrator",EnableMultiTenant:!1,AllowAddAccounts:!1,AllowAutosaveInDrafts:!0,AllowChangeMailQuotaOnMailServer:!1,AllowDefaultAccountForUser:!0,AllowEditDomainsInServer:!0,AllowFetchers:!1,AllowIdentities:!1,AllowAliases:!1,OnlyUserEmailsInIdentities:!1,AllowInsertImage:!0,AllowMultiAccounts:!1,AutoSaveIntervalSeconds:60,AllowTemplateFolders:!1,AllowInsertTemplateOnCompose:!1,MaxTemplatesCountOnCompose:100,AllowAlwaysRefreshFolders:!1,AutocreateMailAccountOnNewUserFirstLogin:!1,IgnoreImapSubscription:!1,ImageUploadSizeLimit:0,AllowUnifiedInbox:!0,AllowAppRegisterMailto:!1,AllowChangeInputDirection:!0,FoldersExpandedByDefault:!1,AllowSpamFolder:!0,AllowAddNewFolderOnMainScreen:!1,ComposeToolbarOrder:["back","send","save","importance","MailSensitivity","confirmation","OpenPgp"],DefaultFontName:"Tahoma",DefaultFontSize:3,AlwaysTryUseImageWhilePasting:!0,JoinReplyPrefixes:!0,MailsPerPage:20,MaxMessagesBodiesSizeToPrefetch:5e4,MessageBodyTruncationThreshold:65e4,MessagesSortBy:{},ShowEmailAsTabName:!0,AllowShowMessagesCountInFolderList:!1,showMessagesCountInFolderList:s.observable(!1),AllowSearchMessagesBySubject:!1,PrefixesToRemoveBeforeSearchMessagesBySubject:[],AllowHorizontalLayout:!1,HorizontalLayout:!1,HorizontalLayoutByDefault:!1,DisableRtlRendering:!1,AllowQuickReply:!1,AllowQuickSendOnCompose:!1,MarkMessageSeenWhenViewing:!0,MarkMessageSeenWhenAnswerForward:!1,UserLoginPartInAccountDropdown:!1,UseMeRecipientForMessages:!0,userMailAccountsCount:s.observable(0),mailAccountsEmails:s.observableArray([]),init:function(e){var t=e.Core,i=e[this.ServerModuleName],s=e.MailWebclient,a=e[this.FetchersServerModuleName],l=e[this.AliasesServerModuleName];if(n.isEmpty(t)||(this.EnableMultiTenant=o.pBool(t.EnableMultiTenant,this.EnableMultiTenant)),!n.isEmpty(i)){this.AllowAddAccounts=o.pBool(i.AllowAddAccounts,this.AllowAddAccounts),this.AllowAutosaveInDrafts=o.pBool(i.AllowAutosaveInDrafts,this.AllowAutosaveInDrafts),this.AllowChangeMailQuotaOnMailServer=o.pBool(i.AllowChangeMailQuotaOnMailServer,this.AllowChangeMailQuotaOnMailServer),this.AllowDefaultAccountForUser=o.pBool(i.AllowDefaultAccountForUser,this.AllowDefaultAccountForUser),this.AllowEditDomainsInServer=o.pBool(i.AllowEditDomainsInServer,this.AllowEditDomainsInServer),this.AllowIdentities=o.pBool(i.AllowIdentities,this.AllowIdentities),this.OnlyUserEmailsInIdentities=o.pBool(i.OnlyUserEmailsInIdentities,this.OnlyUserEmailsInIdentities),this.AllowInsertImage=o.pBool(i.AllowInsertImage,this.AllowInsertImage),this.AllowMultiAccounts=o.pBool(i.AllowMultiAccounts,this.AllowMultiAccounts),this.AutoSaveIntervalSeconds=o.pNonNegativeInt(i.AutoSaveIntervalSeconds,this.AutoSaveIntervalSeconds),this.AllowTemplateFolders=o.pBool(i.AllowTemplateFolders,this.AllowTemplateFolders),this.AllowInsertTemplateOnCompose=o.pBool(i.AllowInsertTemplateOnCompose,this.AllowInsertTemplateOnCompose),this.MaxTemplatesCountOnCompose=o.pPositiveInt(i.MaxTemplatesCountOnCompose,this.MaxTemplatesCountOnCompose),this.AllowAlwaysRefreshFolders=o.pBool(i.AllowAlwaysRefreshFolders,this.AllowAlwaysRefreshFolders),this.AutocreateMailAccountOnNewUserFirstLogin=o.pBool(i.AutocreateMailAccountOnNewUserFirstLogin,this.AutocreateMailAccountOnNewUserFirstLogin),this.IgnoreImapSubscription=o.pBool(i.IgnoreImapSubscription,this.IgnoreImapSubscription),this.ImageUploadSizeLimit=o.pNonNegativeInt(i.ImageUploadSizeLimit,this.ImageUploadSizeLimit),this.AllowUnifiedInbox=o.pBool(i.AllowUnifiedInbox,this.AllowUnifiedInbox),window.Enums.SmtpAuthType=o.pObject(i.SmtpAuthType),this.MessagesSortBy=n.clone(o.pObject(i.MessagesSortBy,this.MessagesSortBy)),this.MessagesSortBy.Allow=o.pBool(this.MessagesSortBy.Allow,!1),this.MessagesSortBy.List=o.pArray(this.MessagesSortBy.List,[]),this.MessagesSortBy.DefaultSortBy=o.pString(this.MessagesSortBy.DefaultSortBy,"arrival");var h=o.pString(this.MessagesSortBy.DefaultSortOrder,"desc");this.MessagesSortBy.DefaultSortOrder="desc"===h?Enums.SortOrder.Desc:Enums.SortOrder.Asc}n.isEmpty(s)||(this.AllowAppRegisterMailto=o.pBool(s.AllowAppRegisterMailto,this.AllowAppRegisterMailto),this.AllowChangeInputDirection=o.pBool(s.AllowChangeInputDirection,this.AllowChangeInputDirection),this.FoldersExpandedByDefault=o.pBool(s.FoldersExpandedByDefault,this.FoldersExpandedByDefault),this.AllowSpamFolder=o.pBool(s.AllowSpamFolder,this.AllowSpamFolder),this.AllowAddNewFolderOnMainScreen=o.pBool(s.AllowAddNewFolderOnMainScreen,this.AllowAddNewFolderOnMainScreen),this.ComposeToolbarOrder=o.pArray(s.ComposeToolbarOrder,this.ComposeToolbarOrder),this.DefaultFontName=o.pString(s.DefaultFontName,this.DefaultFontName),this.DefaultFontSize=o.pPositiveInt(s.DefaultFontSize,this.DefaultFontSize),this.AlwaysTryUseImageWhilePasting=o.pBool(s.AlwaysTryUseImageWhilePasting,this.AlwaysTryUseImageWhilePasting),this.JoinReplyPrefixes=o.pBool(s.JoinReplyPrefixes,this.JoinReplyPrefixes),this.MailsPerPage=o.pPositiveInt(s.MailsPerPage,this.MailsPerPage),this.MaxMessagesBodiesSizeToPrefetch=o.pNonNegativeInt(s.MaxMessagesBodiesSizeToPrefetch,this.MaxMessagesBodiesSizeToPrefetch),this.MessageBodyTruncationThreshold=o.pNonNegativeInt(s.MessageBodyTruncationThreshold,this.MessageBodyTruncationThreshold),this.ShowEmailAsTabName=o.pBool(s.ShowEmailAsTabName,this.ShowEmailAsTabName),this.AllowShowMessagesCountInFolderList=o.pBool(s.AllowShowMessagesCountInFolderList,this.AllowShowMessagesCountInFolderList),this.showMessagesCountInFolderList(o.pBool(s.ShowMessagesCountInFolderList,this.showMessagesCountInFolderList())),this.AllowSearchMessagesBySubject=o.pBool(s.AllowSearchMessagesBySubject,this.AllowSearchMessagesBySubject),this.PrefixesToRemoveBeforeSearchMessagesBySubject=o.pArray(s.PrefixesToRemoveBeforeSearchMessagesBySubject,this.PrefixesToRemoveBeforeSearchMessagesBySubject),this.AllowHorizontalLayout=o.pBool(s.AllowHorizontalLayout,this.AllowHorizontalLayout),this.HorizontalLayout=this.AllowHorizontalLayout&&o.pBool(s.HorizontalLayout,this.HorizontalLayout),this.HorizontalLayoutByDefault=this.AllowHorizontalLayout&&o.pBool(s.HorizontalLayoutByDefault,this.HorizontalLayoutByDefault),this.DisableRtlRendering=o.pBool(s.DisableRtlRendering,this.DisableRtlRendering),this.AllowQuickReply=o.pBool(s.AllowQuickReply,this.AllowQuickReply),this.AllowQuickSendOnCompose=o.pBool(s.AllowQuickSendOnCompose,this.AllowQuickSendOnCompose),this.MarkMessageSeenWhenViewing=o.pBool(s.MarkMessageSeenWhenViewing,this.MarkMessageSeenWhenViewing),this.MarkMessageSeenWhenAnswerForward=o.pBool(s.MarkMessageSeenWhenAnswerForward,this.MarkMessageSeenWhenAnswerForward),this.UserLoginPartInAccountDropdown=o.pBool(s.UserLoginPartInAccountDropdown,this.UserLoginPartInAccountDropdown),this.UseMeRecipientForMessages=o.pBool(s.UseMeRecipientForMessages,this.UseMeRecipientForMessages)),n.isEmpty(a)||(this.AllowFetchers=o.pBool(a.AllowFetchers,this.AllowFetchers)),n.isEmpty(l)||(this.AllowAliases=o.pBool(l.AllowAliases,this.AllowAliases)),r.registerUserAccountsCount(this.userMailAccountsCount),r.registerAccountsWithPass(this.mailAccountsEmails)},update:function(e,t,i,s){this.AllowAutosaveInDrafts=o.pBool(t,this.AllowAutosaveInDrafts),this.AllowChangeInputDirection=o.pBool(i,this.AllowChangeInputDirection),this.MailsPerPage=o.pPositiveInt(e,this.MailsPerPage),this.showMessagesCountInFolderList(o.pBool(s,this.showMessagesCountInFolderList()))},updateAdmin:function(e,t,i){this.AutocreateMailAccountOnNewUserFirstLogin=o.pBool(e,this.AutocreateMailAccountOnNewUserFirstLogin),this.AllowAddAccounts=o.pBool(t,this.AllowAddAccounts),this.HorizontalLayoutByDefault=o.pBool(i,this.HorizontalLayoutByDefault)},disableEditDomainsInServer:function(){this.AllowEditDomainsInServer=!1}}},pvQt:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV"),r=i("o0Bx"),a=i("IAk5"),l=i("hPb3"),h=i("61ci");function u(){this.tenants=n.observableArray([]),this.selectedTenantId=n.observable(0),this.selectedTenant=n.computed((function(){return s.find(this.tenants(),function(e){return e.Id===this.selectedTenantId()}.bind(this))||{Name:""}}),this),l.dbSettingsChanged.subscribe((function(){l.dbSettingsChanged()&&r.send(h.ServerModuleName,"GetTenants")})),this.bTenantsChanged=!1}u.prototype.init=function(e){a.subscribeEvent("ReceiveAjaxResponse::after",this.onAjaxResponse.bind(this));var t=e.AdminPanelWebclient;this.parseTenants(t?t.Tenants:[])},u.prototype.onAjaxResponse=function(e){if(e.Response.Module===h.ServerModuleName)switch(e.Response.Method){case"CreateTables":r.send(h.ServerModuleName,"GetTenants");break;case"CreateTenant":case"DeleteTenants":this.bTenantsChanged=!0;break;case"GetTenants":var t=o.pString(e.Request.Parameters.Search),i=o.pInt(e.Request.Parameters.Offset),s=o.pInt(e.Request.Parameters.Limit);""===t&&0===i&&0===s?this.parseTenants(e.Response.Result):this.bTenantsChanged&&r.send(h.ServerModuleName,"GetTenants"),this.bTenantsChanged=!1}},u.prototype.setSelectedTenant=function(e){s.find(this.tenants(),(function(t){return t.Id===e}))&&this.selectedTenantId(e)},u.prototype.parseTenants=function(e){var t=this.selectedTenantId(),i=!1,n=e&&s.isArray(e.Items)?e.Items:[],r=[];s.each(n,(function(e){var s={Name:e.Name,Id:o.pInt(e.Id)};s.Id===t&&(i=!0),r.push(s)})),i||this.selectedTenantId(r.length>0?r[0].Id:0),this.tenants(r)},e.exports=new u},qGK3:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("wd/R"),a=i("Yjhd"),l=i("RN+F"),h=i("AFLV"),u=i("UN2P"),c=i("JFZZ"),d=i("IAk5"),p=i("QaF5"),m=i("gcBV"),g=i("76Kh"),f=i("20Ah"),b=i("4M/5"),v=i("jonm"),y=null,E=i("xzvH"),S=i("p2hp"),A=i("Nfk5"),I=i("lPfU");function T(e,t){this.iAccountId=e,this.bIsUnifiedInbox=!!t,this.oUnifiedInboxes={},this.bNamespace=!1,this.iDisplayedLevel=0,this.bIgnoreImapSubscription=S.IgnoreImapSubscription,this.bAllowTemplateFolders=S.AllowTemplateFolders,this.isTemplateStorage=o.observable(!1),this.bAllowAlwaysRefreshFolders=S.AllowAlwaysRefreshFolders,this.isAlwaysRefresh=o.observable(!1),this.sDelimiter="",this.bExists=!0,this.sUidNext="",this.sHash="",this.messageCount=o.observable(0),this.unseenMessageCount=o.observable(0),this.iRealUnseenMessageCount=0,this.hasExtendedInfo=o.observable(!1),this.fullName=o.observable(""),this.fullNameHash=o.observable(""),this.parentFullName=o.observable(""),this.bSelectable=!0,this.subscribed=o.observable(!0),this.name=o.observable(""),this.nameForEdit=o.observable(""),this.subfolders=o.observableArray([]),this.subfoldersMessagesCount=o.observable(0),this.type=o.observable(Enums.FolderTypes.User),this.bVirtual=!1,this.selected=o.observable(!1),this.expanded=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.edited=o.observable(!1),this.aMessagesDictionaryUids=[],this.oUids={},this.aResponseHandlers=[],this.aRequestedUids=[],this.aRequestedThreadUids=[],this.requestedLists=[],this.hasChanges=o.observable(!1),this.oRelevantInformationLastMoment=null,this.bSubscribtionsInitialized=!1,this.disableMoveTo=o.observable(this.bVirtual||this.bIsUnifiedInbox),this.disableMoveFrom=o.observable(this.bIsUnifiedInbox)}T.prototype.setDisableMoveTo=function(e){this.disableMoveTo(this.bVirtual||this.bIsUnifiedInbox||e)},T.prototype.setDisableMoveFrom=function(e){this.disableMoveFrom(this.bIsUnifiedInbox||e)},T.prototype.requireMailCache=function(){null===y&&(y=i("4+IO"))},T.prototype.setDisplayedLevel=function(e){this.iDisplayedLevel=e},T.prototype.getDisplayedLevel=function(){return this.iDisplayedLevel},T.prototype.getUnifiedInbox=function(e){var t=this.oUnifiedInboxes[e];if(!t){this.requireMailCache();var i=y.oFolderListItems[e];t=i?i.inboxFolder():null,this.oUnifiedInboxes[e]=t}return t},T.prototype.getMessageByUid=function(e){if(this.bIsUnifiedInbox){var t=e.split(":"),i=2===t.length?h.pInt(t[0]):this.iAccountId,s=2===t.length?h.pString(t[1]):e,n=this.getUnifiedInbox(i);return n?E.get([i,n.fullName(),s]):null}return E.get([this.iAccountId,this.fullName(),e])},T.prototype.removeMessageFromDict=function(e){E.remove([this.iAccountId,this.fullName(),e]),this.aMessagesDictionaryUids=s.without(this.aMessagesDictionaryUids,e),this.aRequestedUids=s.without(this.aRequestedUids,e),this.aRequestedThreadUids=s.without(this.aRequestedThreadUids,e)},T.prototype.updateLastAccessTime=function(e){s.each(e,(function(e){var t=this.getMessageByUid(e);t&&t.updateLastAccessTime()}),this)},T.prototype.doForAllMessages=function(e){var t=[];s.each(this.aMessagesDictionaryUids,(function(i){var s=this.getMessageByUid(i);s?e(s):t.push(i)}),this),t.length>0&&(this.aMessagesDictionaryUids=s.difference(this.aMessagesDictionaryUids,t),this.aRequestedUids=s.difference(this.aRequestedUids,t),this.aRequestedThreadUids=s.difference(this.aRequestedThreadUids,t))},T.prototype.getFlaggedMessageUids=function(){var e=[];return this.doForAllMessages((function(t){t.flagged()&&e.push(t.uid())})),e},T.prototype.setMessageUnflaggedByUid=function(e){var t=this.getMessageByUid(e);t&&t.flagged(!1)},T.prototype.hideThreadMessages=function(e){s.each(e.threadUids(),(function(e){var t=this.getMessageByUid(e);t&&(t.deleted()||(t.threadShowAnimation(!1),t.threadHideAnimation(!0),setTimeout((function(){t.threadHideAnimation(!1)}),1e3)))}),this)},T.prototype.getThreadMessages=function(e){var t=[],i=[],n=[],o=0,r=null;return s.each(e.threadUids(),(function(s){if(o<e.threadCountForLoad()){var a=this.getMessageByUid(s);a?a.deleted()||(a.markAsThreadPart(50,e.uid()),a.unifiedUid()||a.unifiedUid(a.accountId()+":"+a.uid()),t.push(a),n.push(a.uid()),o++,r=a):(i.push(s),n.push(s),o++)}else n.push(s)}),this),e.threadLoading()||this.loadThreadMessages(i),e.changeThreadUids(n,t.length),r&&t.length<e.threadUids().length&&r.showNextLoadingLink(s.bind(e.increaseThreadCountForLoad,e)),this.addThreadUidsToUidLists(e.uid(),e.threadUids()),t},T.prototype.computeThreadData=function(e){var t=0,i=!1,o=[],r=[],a=e.oFrom.getFirstEmail();s.each(e.threadUids(),(function(s){var h=this.bIsUnifiedInbox?this.getUnifiedInbox(e.accountId()):null,u=h?h.getMessageByUid(s):this.getMessageByUid(s),c="";u&&!u.deleted()&&(u.seen()||t++,u.flagged()&&(i=!0),(c=u.oFrom.getFirstEmail())!==a&&-1===n.inArray(c,r)&&(r.push(c),c===v.getEmail()?o.push(l.i18n("MAILWEBCLIENT/LABEL_ME_SENDER")):o.push(u.oFrom.getFirstDisplay())))}),this),e.threadUnreadCount(t),e.partialFlagged(i)},T.prototype.addThreadUidsToUidLists=function(e,t){s.each(this.oUids,(function(i){i.addThreadUids(e,t)}))},T.prototype.loadThreadMessages=function(e){if(e.length>0){var t={AccountID:this.iAccountId,Folder:this.fullName(),Uids:e};u.send("GetMessagesByUids",t,this.onGetMessagesByUidsResponse,this)}},T.prototype.getThreadCheckedUidsFromList=function(e){var t=[];return s.each(e,(function(e){e.threadCount()>0&&!e.threadOpened()&&s.each(e.threadUids(),(function(i){var s=this.bIsUnifiedInbox?this.getUnifiedInbox(e.accountId()):null,n=s?s.getMessageByUid(i):this.getMessageByUid(i);n&&!n.deleted()&&n.checked()&&t.push(this.bIsUnifiedInbox?n.unifiedUid():n.uid())}),this)}),this),t},T.prototype.parseAndCacheMessage=function(e,t,i){var n=e.Uid.toString(),o=!1,r=this.getMessageByUid(n);return r||(o=!0,r=new A),r.parse(e,this.iAccountId,t,i),this.type()===Enums.FolderTypes.Inbox&&o&&r.flagged()&&(this.requireMailCache(),y.increaseStarredCount()),E.set([r.accountId(),r.folder(),n],r),o&&(this.aRequestedUids=s.without(this.aRequestedUids,n),-1===s.indexOf(this.aMessagesDictionaryUids,n)&&this.aMessagesDictionaryUids.push(n)),r},T.prototype.onGetMessagesByUidsResponse=function(e,t){var i=e.Result;i&&"Collection/MessageCollection"===i["@Object"]&&(s.each(i["@Collection"],(function(e){this.parseAndCacheMessage(e,!0,!0)}),this),this.requireMailCache(),y.showOpenedThreads(this.fullName()))},T.prototype.addRequestedUids=function(e){this.aRequestedUids=s.union(this.aRequestedUids,e)},T.prototype.hasUidBeenRequested=function(e){return-1!==s.indexOf(this.aRequestedUids,e)},T.prototype.addRequestedThreadUids=function(e){this.aRequestedThreadUids=s.union(this.aRequestedThreadUids,e)},T.prototype.hasThreadUidBeenRequested=function(e){return-1!==s.indexOf(this.aRequestedThreadUids,e)},T.prototype.hasListBeenRequested=function(e){var t=s.where(this.requestedLists,e).length>0;return t||this.requestedLists.push(e),t},T.prototype.markMessageReplied=function(e,t){var i=this.getMessageByUid(e),s=i?y.getFolderByFullName(i.accountId(),i.folder()):null;if(i)switch(t){case Enums.ReplyType.Reply:case Enums.ReplyType.ReplyAll:i.answered(!0),S.MarkMessageSeenWhenAnswerForward&&s&&!i.seen()&&y.executeGroupOperationForFolder("SetMessagesSeen",s,[y.getMessageUid(i)],"seen",!0);break;case Enums.ReplyType.Forward:case Enums.ReplyType.ForwardAsAttach:i.forwarded(!0),S.MarkMessageSeenWhenAnswerForward&&s&&!i.seen()&&y.executeGroupOperationForFolder("SetMessagesSeen",s,[y.getMessageUid(i)],"seen",!0)}},T.prototype.removeAllMessages=function(){var e=this.oUids,t=this.aMessagesDictionaryUids;this.aMessagesDictionaryUids=[],this.aRequestedUids=[],this.aRequestedThreadUids=[],this.requestedLists=[],this.oUids={},this.messageCount(0),this.unseenMessageCount(0),this.iRealUnseenMessageCount=0,this.getUidList("","",S.MessagesSortBy.DefaultSortBy,S.MessagesSortBy.DefaultSortOrder).resultCount(0),y.currentMessage()&&y.currentMessage().accountId()===this.iAccountId&&y.currentMessage().folder()===this.fullName()&&(a.log("removeAllMessages, the current message is in the list to remove",y.currentMessage()?{accountId:y.currentMessage().accountId(),folder:y.currentMessage().folder(),uid:y.currentMessage().uid()}:null),t=s.without(t,y.currentMessage().uid())),s.each(t,(function(e){this.removeMessageFromDict(e)}),this),t=null,s.each(e,(function(e){e.clearData()})),e=null},T.prototype.removeAllMessageListsFromCacheIfHasChanges=function(){this.hasChanges()&&(this.oUids={},this.requestedLists=[],this.aRequestedThreadUids=[],this.hasChanges(!1))},T.prototype.removeFlaggedMessageListsFromCache=function(){s.each(this.oUids,(function(e){e.filters()===Enums.FolderFilter.Flagged&&e.clearData()}),this)},T.prototype.removeUnseenMessageListsFromCache=function(){s.each(this.oUids,(function(e){e.filters()===Enums.FolderFilter.Unseen&&e.clearData()}),this)},T.prototype.setRelevantInformation=function(e,t,i,s,n){var o=this.hasExtendedInfo()&&(this.sHash!==t||this.iRealUnseenMessageCount!==s||this.unseenMessageCount()!==s);return this.sHash=t,this.iRealUnseenMessageCount=s,this.hasExtendedInfo()&&n||(this.sUidNext=e,this.messageCount(i),this.unseenMessageCount(s),0===s&&this.unseenMessageCount.valueHasMutated()),this.hasExtendedInfo(!0),o&&this.markHasChanges(),this.oRelevantInformationLastMoment=r(),o},T.prototype.increaseCountIfHasNotInfo=function(){this.hasExtendedInfo()||this.messageCount(this.messageCount()+1)},T.prototype.markHasChanges=function(){this.hasChanges(!0)},T.prototype.addMessagesCountsDiff=function(e,t){var i=this.messageCount()+e,s=this.unseenMessageCount()+t;i<0&&(i=0),this.messageCount(i),s<0&&(s=0),s>i&&(s=i),this.unseenMessageCount(s)},T.prototype.markDeletedByUids=function(e){var t=0,i=0;return s.each(e,(function(e){var s=this.getMessageByUid(e);s&&(t++,s.seen()||i++,s.deleted(!0))}),this),this.addMessagesCountsDiff(-t,-i),y.setUnifiedInboxUnseenChanges(this.iAccountId,this.fullName(),-t,-i),{MinusDiff:t,UnseenMinusDiff:i}},T.prototype.revertDeleted=function(e){var t=0,i=0;return s.each(e,(function(e){var s=this.getMessageByUid(e);s&&s.deleted()&&(t++,s.seen()||i++,s.deleted(!1))}),this),this.addMessagesCountsDiff(t,i),{PlusDiff:t,UnseenPlusDiff:i}},T.prototype.commitDeleted=function(e){s.each(e,s.bind((function(e){y.currentMessage()&&y.currentMessage().accountId()===this.iAccountId&&y.currentMessage().folder()===this.fullName()&&y.currentMessage().uid()===e?a.log("commitDeleted, the current message is to remove",y.currentMessage()?{accountId:y.currentMessage().accountId(),folder:y.currentMessage().folder(),uid:y.currentMessage().uid()}:null):this.removeMessageFromDict(e),this.aMessagesDictionaryUids=s.without(this.aMessagesDictionaryUids,e),this.aRequestedUids=s.without(this.aRequestedUids,e),this.aRequestedThreadUids=s.without(this.aRequestedThreadUids,e)}),this)),s.each(this.oUids,(function(t){t.deleteUids(e)}))},T.prototype.getUidList=function(e,t,i,s){var n=JSON.stringify([e,t,i,s]),o=null;return void 0===this.oUids[n]&&((o=new I).iAccountId=this.iAccountId,o.sFullName=this.fullName(),o.search(e),o.filters(t),o.sortBy(i),o.sortOrder(s),this.oUids[n]=o),this.oUids[n]},T.prototype.initStarredFolder=function(e,t){this.bVirtual=!0,this.setDisplayedLevel(e),this.fullName(t),this.name(l.i18n("MAILWEBCLIENT/LABEL_FOLDER_STARRED")),this.type(Enums.FolderTypes.Starred),this.initSubscriptions(""),this.initComputedFields(!0)},T.prototype.parse=function(e,t,i){var n="",o=Enums.FolderTypes.User,r=m.getData("folderAccordion")||[];return"Object/Folder"===e["@Object"]?(n=h.pString(e.Name),this.name(n),this.nameForEdit(n),this.fullName(h.pString(e.FullNameRaw)),this.fullNameHash(h.pString(e.FullNameHash)),this.parentFullName(h.pString(t)),this.sDelimiter=e.Delimiter,o=h.pInt(e.Type),S.AllowTemplateFolders||o!==Enums.FolderTypes.Template||(o=Enums.FolderTypes.User),(S.AllowSpamFolder||o!==Enums.FolderTypes.Spam)&&this.type(o),this.isTemplateStorage(this.type()===Enums.FolderTypes.Template),this.bNamespace=i===this.fullName(),this.isAlwaysRefresh(S.AllowAlwaysRefreshFolders&&!!e.AlwaysRefresh),this.subscribed(!!S.IgnoreImapSubscription||e.IsSubscribed),this.bSelectable=e.IsSelectable,this.bExists=e.Exists,e.Extended&&this.setRelevantInformation(e.Extended.UidNext.toString(),e.Extended.Hash,e.Extended.MessageCount,e.Extended.MessageUnseenCount,!1),s.find(r,(function(e){return e===this.name()}),this)&&this.expanded(!0),this.initSubscriptions(t),this.initComputedFields(),d.broadcastEvent("MailWebclient::ParseFolder::after",this),e.SubFolders):null},T.prototype.initSubscriptions=function(e){this.bSubscribtionsInitialized||(this.requireMailCache(),this.unseenMessageCount.subscribe((function(){s.delay(s.bind((function(){y.countMessages(this)}),this),1e3)}),this),this.subscribed.subscribe((function(){if(e){var t=y.folderList().getFolderByFullName(e);t&&y.countMessages(t)}}),this),this.edited.subscribe((function(e){!1===e&&this.nameForEdit(this.name())}),this),this.hasChanges.subscribe((function(){this.requestedLists=[]}),this),this.bSubscribtionsInitialized=!0)},T.prototype.initComputedFields=function(){this.routingHash=o.computed((function(){return this.bVirtual?p.buildHashFromArray(b.getMailbox(this.fullName(),1,"","",Enums.FolderFilter.Flagged)):p.buildHashFromArray(b.getMailbox(this.fullName()))}),this),this.isSystem=o.computed((function(){return this.type()!==Enums.FolderTypes.User}),this),this.withoutThreads=o.computed((function(){return this.type()===Enums.FolderTypes.Drafts||this.type()===Enums.FolderTypes.Spam||this.type()===Enums.FolderTypes.Trash}),this),this.enableEmptyFolder=o.computed((function(){return(this.type()===Enums.FolderTypes.Spam||this.type()===Enums.FolderTypes.Trash)&&this.messageCount()>0}),this),this.virtualEmpty=o.computed((function(){return this.bVirtual&&0===this.messageCount()}),this),this.hasSubscribedSubfolders=o.computed((function(){return s.any(this.subfolders(),(function(e){return e.subscribed()}))}),this),this.canExpand=o.computed((function(){return!this.bNamespace&&this.hasSubscribedSubfolders()}),this),this.unseenMessagesCountToShow=o.computed((function(){return!d.isMobile()&&this.canExpand()?this.unseenMessageCount()+this.subfoldersMessagesCount():this.unseenMessageCount()}),this),this.showTotalInsteadUnseenCount=o.observable(!1),this.showUnseenMessagesCount=o.computed((function(){return this.unseenMessagesCountToShow()>0&&this.type()!==Enums.FolderTypes.Drafts&&!this.showTotalInsteadUnseenCount()}),this),this.showMessagesCount=o.computed((function(){return this.messageCount()>0&&(this.type()===Enums.FolderTypes.Drafts||this.showTotalInsteadUnseenCount()||S.AllowShowMessagesCountInFolderList&&S.showMessagesCountInFolderList())}),this),this.visible=o.computed((function(){return this.subscribed()||this.isSystem()||this.hasSubscribedSubfolders()}),this),this.canBeSelected=o.computed((function(){return this.bExists&&this.bSelectable&&this.subscribed()}),this),this.canSubscribe=o.computed((function(){return!S.IgnoreImapSubscription&&!this.isSystem()&&this.bExists&&this.bSelectable}),this),this.canDelete=o.computed((function(){return!this.isSystem()&&this.hasExtendedInfo()&&0===this.messageCount()&&0===this.subfolders().length}),this),this.canRename=this.canSubscribe,this.visibleTemplateTrigger=o.computed((function(){return S.AllowTemplateFolders&&(this.bSelectable&&!this.isSystem()||this.isTemplateStorage())}),this),this.templateButtonHint=o.computed((function(){return this.visibleTemplateTrigger()?this.isTemplateStorage()?l.i18n("MAILWEBCLIENT/ACTION_TURN_TEMPLATE_FOLDER_OFF"):l.i18n("MAILWEBCLIENT/ACTION_TURN_TEMPLATE_FOLDER_ON"):""}),this),this.alwaysRefreshButtonHint=o.computed((function(){return S.AllowAlwaysRefreshFolders?this.isAlwaysRefresh()?l.i18n("MAILWEBCLIENT/ACTION_TURN_ALWAYS_REFRESH_OFF"):l.i18n("MAILWEBCLIENT/ACTION_TURN_ALWAYS_REFRESH_ON"):""}),this),this.subscribeButtonHint=o.computed((function(){return this.canSubscribe()?this.subscribed()?l.i18n("MAILWEBCLIENT/ACTION_HIDE_FOLDER"):l.i18n("MAILWEBCLIENT/ACTION_SHOW_FOLDER"):""}),this),this.deleteButtonHint=o.computed((function(){return this.canDelete()?l.i18n("MAILWEBCLIENT/ACTION_DELETE_FOLDER"):""}),this),this.usedAs=o.computed((function(){switch(this.type()){case Enums.FolderTypes.Inbox:return l.i18n("MAILWEBCLIENT/LABEL_USED_AS_INBOX");case Enums.FolderTypes.Sent:return l.i18n("MAILWEBCLIENT/LABEL_USED_AS_SENT");case Enums.FolderTypes.Drafts:return l.i18n("MAILWEBCLIENT/LABEL_USED_AS_DRAFTS");case Enums.FolderTypes.Trash:return l.i18n("MAILWEBCLIENT/LABEL_USED_AS_TRASH");case Enums.FolderTypes.Spam:return l.i18n("MAILWEBCLIENT/LABEL_USED_AS_SPAM")}return""}),this),this.displayName=o.computed((function(){if(this.bIsUnifiedInbox)return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_ALL_INBOXES");switch(this.type()){case Enums.FolderTypes.Inbox:return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_INBOX");case Enums.FolderTypes.Sent:return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_SENT");case Enums.FolderTypes.Drafts:return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_DRAFTS");case Enums.FolderTypes.Trash:return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_TRASH");case Enums.FolderTypes.Spam:return l.i18n("MAILWEBCLIENT/LABEL_FOLDER_SPAM")}return this.name()}),this),this.setDisableMoveTo(!1),this.setDisableMoveFrom(!1)},T.prototype.setShowTotalInsteadUnseenCount=function(e){this.showTotalInsteadUnseenCount(e)},T.prototype.onGetMessageResponse=function(e,t){var i=e.Result,s=t.Parameters,n=null,o=i?i.Uid.toString():s.Uid.toString(),r=this.getMessageByUid(o),a=!!r&&r.selected(),h=!1;i?r=this.parseAndCacheMessage(i,!1,!1):(a&&c.showErrorByCode(e,l.i18n("COREWEBCLIENT/ERROR_UNKNOWN")),p.replaceHashWithoutMessageUid(r.uid()),p.replaceHashWithoutMessageUid(r.unifiedUid()),r&&!r.deleted()&&this.removeMessageFromDict(o),r=null,h=!0),(n=this.aResponseHandlers[o])&&(n.handler.call(n.context,r,o,h?e:null),delete this.aResponseHandlers[o])},T.prototype.getCompletelyFilledMessage=function(e,t,i,s){var n=this.getMessageByUid(e),o={AccountID:n?n.accountId():0,Folder:this.fullName(),Uid:e,MessageBodyTruncationThreshold:S.MessageBodyTruncationThreshold};e.length>0&&(!n||!n.completelyFilled()||n.truncated()||s?(t&&i&&(this.aResponseHandlers[e]={handler:t,context:i}),u.send("GetMessage",o,this.onGetMessageResponse,this)):t&&i&&t.call(i,n,e))},T.prototype.showExternalPictures=function(e){var t=this.getMessageByUid(e);void 0!==t&&t.showExternalPictures()},T.prototype.alwaysShowExternalPicturesForSender=function(e){this.doForAllMessages((function(t){var i=t.oFrom.aCollection;i.length>0&&i[0].sEmail===e&&t.alwaysShowExternalPicturesForSender()}))},T.prototype.executeGroupOperation=function(e,t,i){var n=0;this.doForAllMessages((function(o){t.length>0?s.each(t,(function(t){o.uid()===t&&o[e]()!==i&&(o[e](i),n++)})):o[e](i)})),0===t.length&&(n=i?this.unseenMessageCount():this.messageCount()-this.unseenMessageCount()),"seen"===e&&n>0&&(i?(this.addMessagesCountsDiff(0,-n),y.setUnifiedInboxUnseenChanges(this.iAccountId,this.fullName(),0,-n)):(this.addMessagesCountsDiff(0,n),y.setUnifiedInboxUnseenChanges(this.iAccountId,this.fullName(),0,n)),this.markHasChanges(),this.requireMailCache())},T.prototype.emptyFolder=function(){var e=l.i18n("MAILWEBCLIENT/CONFIRM_EMPTY_FOLDER"),t=s.bind(this.clearFolder,this);this.enableEmptyFolder()&&g.showPopup(f,[e,t])},T.prototype.clearFolder=function(e){this.enableEmptyFolder()&&e&&(u.send("ClearFolder",{Folder:this.fullName()}),this.requireMailCache(),y.onClearFolder(this),this.removeAllMessages())},T.prototype.onAccordion=function(e,t){var i=!this.expanded(),n=m.getData("folderAccordion")||[];i?n.push(this.name()):n=s.reject(n,(function(e){return e===this.name()}),this),m.setData("folderAccordion",n),this.expanded(i),this.requireMailCache(),y.countMessages(this),t&&t.stopPropagation()},T.prototype.executeUnseenFilter=function(){return this.unseenMessagesCountToShow()>this.unseenMessageCount()&&this.onAccordion(),!(this.unseenMessageCount()>0)||(this.requireMailCache(),y.waitForUnseenMessages(!0),p.setHash(b.getMailbox(this.fullName(),1,"","",Enums.FolderFilter.Unseen))&&y.changeCurrentMessageList(this.fullName(),1,"",Enums.FolderFilter.Unseen,S.MessagesSortBy.DefaultSortBy,S.MessagesSortBy.DefaultSortOrder),!1)},T.prototype.onDeleteClick=function(){var e=l.i18n("MAILWEBCLIENT/CONFIRM_DELETE_FOLDER"),t=s.bind(this.deleteAfterConfirm,this);this.canDelete()?g.showPopup(f,[e,t]):d.broadcastEvent("MailWebclient::AttemptDeleteNonemptyFolder")},T.prototype.deleteAfterConfirm=function(e){if(e){var t=y.editedFolderList(),i=this.fullName(),s=function(e){return i===e.fullName()||(e.subfolders.remove(s),!1)};t.collection.remove(s),u.send("DeleteFolder",{AccountID:v.editedId(),Folder:this.fullName()},(function(e){e.Result||(c.showErrorByCode(e,l.i18n("MAILWEBCLIENT/ERROR_DELETE_FOLDER")),y.getFolderList(v.editedId()))}),this)}},T.prototype.onSubscribeClick=function(){if(this.canSubscribe()){var e={AccountID:v.editedId(),Folder:this.fullName(),SetAction:!this.subscribed()};this.subscribed(!this.subscribed()),u.send("SubscribeFolder",e,(function(e){e.Result||(this.subscribed()?c.showErrorByCode(e,l.i18n("MAILWEBCLIENT/ERROR_SUBSCRIBE_FOLDER")):c.showErrorByCode(e,l.i18n("MAILWEBCLIENT/ERROR_UNSUBSCRIBE_FOLDER")),y.getFolderList(v.editedId()))}),this)}},T.prototype.afterMove=function(e){s.each(e,(function(e){s.isFunction(e.afterMove)&&e.afterMove()}))},T.prototype.cancelNameEdit=function(){this.edited(!1)},T.prototype.applyNameEdit=function(){if(this.name()!==this.nameForEdit()){var e={AccountID:v.editedId(),PrevFolderFullNameRaw:this.fullName(),NewFolderNameInUtf8:this.nameForEdit()};u.send("RenameFolder",e,s.bind(this.onResponseFolderRename,this),this),this.name(this.nameForEdit())}this.edited(!1)},T.prototype.onResponseFolderRename=function(e,t){if(e&&e.Result){if(e&&e.Result&&e.Result.FullName){y.editedFolderList().renameFolder(this.fullName(),e.Result.FullName,e.Result.FullNameHash)}}else c.showErrorByCode(e,l.i18n("MAILWEBCLIENT/ERROR_RENAME_FOLDER")),y.getFolderList(v.editedId())},T.prototype.triggerTemplateState=function(){if(this.visibleTemplateTrigger()){this.isTemplateStorage()?(this.type(Enums.FolderTypes.User),this.isTemplateStorage(!1)):(this.type(Enums.FolderTypes.Template),this.isTemplateStorage(!0)),y.changeTemplateFolder(this.fullName(),this.isTemplateStorage());var e={FolderFullName:this.fullName(),SetTemplate:this.isTemplateStorage()};u.send("SetTemplateFolderType",e,this.onSetTemplateFolderType,this)}},T.prototype.onSetTemplateFolderType=function(e){e.Result||(c.showErrorByCode(e,l.i18n("MAILWEBCLIENT/ERROR_SETUP_SPECIAL_FOLDERS")),y.getFolderList(v.editedId()))},T.prototype.triggerAlwaysRefreshState=function(){if(S.AllowAlwaysRefreshFolders){this.isAlwaysRefresh(!this.isAlwaysRefresh());var e={AccountID:this.iAccountId,FolderFullName:this.fullName(),AlwaysRefresh:this.isAlwaysRefresh()};u.send("SetAlwaysRefreshFolder",e,this.onSetAlwaysRefreshFolder,this)}},T.prototype.onSetAlwaysRefreshFolder=function(e){e.Result||(c.showErrorByCode(e),y.getFolderList(v.editedId()))},e.exports=T},qMJN:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("o0Bx"),r=i("OgeD"),a=i("AFLV"),l=r.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("SVRS");function u(){l.call(this,h.ServerModuleName),this.sFakePass="     ",this.host=n.observable(h.CpanelHost),this.port=n.observable(h.CpanelPort),this.user=n.observable(h.CpanelUser),this.pass=n.observable(h.CpanelHasPassword?this.sFakePass:"")}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="CpanelIntegrator_AdminSettingsView",u.prototype.getCurrentValues=function(){return[this.host(),this.port(),this.user(),this.pass()]},u.prototype.revertGlobalValues=function(){this.host(h.CpanelHost),this.port(h.CpanelPort),this.user(h.CpanelUser),this.pass(h.CpanelHasPassword?this.sFakePass:"")},u.prototype.getParametersForSave=function(){var e={CpanelHost:this.host(),CpanelPort:this.port(),CpanelUser:this.user(),CpanelPassword:this.pass()!==this.sFakePass?this.pass():""};return a.isPositiveNumber(this.iTenantId)&&(e.TenantId=this.iTenantId),e},u.prototype.applySavedValues=function(e){a.isPositiveNumber(this.iTenantId)||h.update(e)},u.prototype.setAccessLevel=function(e,t){this.visible(""===e||"Tenant"===e),this.iTenantId=t},u.prototype.onRouteChild=function(e){this.requestPerTenantSettings()},u.prototype.requestPerTenantSettings=function(){a.isPositiveNumber(this.iTenantId)?(this.host(""),this.port(""),this.user(""),this.pass(""),o.send(h.ServerModuleName,"GetSettings",{TenantId:this.iTenantId},(function(e){e.Result&&(this.host(e.Result.CpanelHost),this.port(e.Result.CpanelPort),this.user(e.Result.CpanelUser),this.pass(e.Result.CpanelHasPassword?this.sFakePass:""),this.updateSavedState())}),this)):this.revertGlobalValues()},u.prototype.applySavedValues=function(e){e.TenantId||h.updateAdmin(e.CpanelHost,e.CpanelPort,e.CpanelUser)},e.exports=new u},qdYY:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("0h2I"),r=i("RN+F"),a=i("IAk5"),l=i("SQrT"),h=i("61ci");function u(){this.id=o.observable(0),this.publicId=o.observable(""),this.bAllowMakeTenant=h.EnableMultiTenant&&a.getUserRole()===Enums.UserRole.SuperAdmin,this.tenantAdminSelected=o.observable(!1),this.writeSeparateLog=o.observable(!1),this.sHeading=r.i18n("ADMINPANELWEBCLIENT/HEADING_CREATE_USER"),this.sActionCreate=r.i18n("COREWEBCLIENT/ACTION_CREATE"),this.sActionCreateInProgress=r.i18n("COREWEBCLIENT/ACTION_CREATE_IN_PROGRESS"),a.broadcastEvent("AdminPanelWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}u.prototype.ViewTemplate="AdminPanelWebclient_EditUserView",u.prototype.ViewConstructorName="CEditUserView",u.prototype.getCurrentValues=function(){return[this.id(),this.publicId(),this.tenantAdminSelected(),this.writeSeparateLog()]},u.prototype.clearFields=function(){this.id(0),this.publicId(""),this.tenantAdminSelected(!1),this.writeSeparateLog(!1)},u.prototype.parse=function(e,t){t?(this.id(e),this.publicId(t.PublicId),this.tenantAdminSelected(t.Role===Enums.UserRole.TenantAdmin),this.writeSeparateLog(!!t.WriteSeparateLog)):this.clearFields()},u.prototype.isValidSaveData=function(){var e=""!==n.trim(this.publicId());return e||l.showError(r.i18n("ADMINPANELWEBCLIENT/ERROR_USER_NAME_EMPTY")),e},u.prototype.getParametersForSave=function(){return{UserId:this.id(),PublicId:n.trim(this.publicId()),Role:this.tenantAdminSelected()?Enums.UserRole.TenantAdmin:Enums.UserRole.NormalUser,WriteSeparateLog:this.writeSeparateLog(),Forced:!0}},u.prototype.saveEntity=function(e,t){s.each(e,(function(e){s.isFunction(e.createEntity)?e.createEntity():s.isFunction(e.save)&&e.save(t)}))},e.exports=new u},rzO8:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=(i("AFLV"),i("o0Bx")),a=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),l=i("ll04");function h(){a.call(this,l.ServerModuleName),this.enable=n.observable(l.EnableModule),this.enableForNewUsers=n.observable(l.EnableForNewUsers),this.usersNumber=n.observable(l.UsersCount),this.usersNumberLicensed=n.observable(l.LicensedUsersCount),this.usersFreeSlots=n.observable(l.UsersFreeSlots),this.licenseType=n.observable(""),this.server=n.observable(l.Server),this.linkToManual=n.observable(l.LinkToManual)}s.extendOwn(h.prototype,a.prototype),h.prototype.ViewTemplate="ActiveServer_AdminSettingsView",h.prototype.getCurrentValues=function(){return[this.usersNumber(),this.usersNumberLicensed(),this.usersFreeSlots()]},h.prototype.revertGlobalValues=function(){},h.prototype.getParametersForSave=function(){return{EnableModule:this.enable(),EnableForNewUsers:this.enableForNewUsers(),Server:this.server(),LinkToManual:this.linkToManual()}},h.prototype.applySavedValues=function(e){l.updateAdmin(e.EnableModule,e.EnableForNewUsers,e.Server)},h.prototype.setAccessLevel=function(e,t){this.visible(""===e)},h.prototype.getLicenseInfo=function(){r.send(l.ServerModuleName,"GetLicenseInfo",{},(function(e){var t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_INVALID"),i=e&&e.Result;if(i)switch(i.Type){case 0:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_UNLIM");break;case 1:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_PERMANENT_PLURAL",{COUNT:i.Count},null,i.Count);break;case 2:t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_DOMAINS_PLURAL",{COUNT:i.Count},null,i.Count);break;case 4:i.ExpiresIn<1&&(t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_OUTDATED_INFO"));break;case 3:case 10:t=3===i.Type?o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_ANNUAL_PLURAL",{COUNT:i.Count},null,i.Count):o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_TRIAL"),"*"!==i.ExpiresIn&&(i.ExpiresIn>0?t+=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_EXPIRES_IN_PLURAL",{DAYS:i.ExpiresIn},null,i.ExpiresIn):t+=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_EXPIRED")+" "+o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_OUTDATED_INFO"))}else""===l.LicenseKey&&(t=o.i18n("LICENSINGWEBCLIENT/LABEL_TYPE_NOT_SET"));this.licenseType(t)}),this)},h.prototype.onRouteChild=function(e){this.getLicenseInfo()},e.exports=new h},sJNY:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV");e.exports={ServerModuleName:"Facebook",HashModuleName:"facebook",Connected:!1,EnableModule:!1,Id:"",Secret:"",Scopes:[],init:function(e){var t=e.Facebook;s.isEmpty(t)||(this.Connected=o.pBool(t.Connected,this.Connected),this.EnableModule=o.pBool(t.EnableModule,this.EnableModule),this.Id=o.pString(t.Id,this.Id),this.Secret=o.pString(t.Secret,this.Secret),this.Scopes=o.pArray(t.Scopes,this.Scopes))},getScopesCopy:function(){var e=[];return s.each(this.Scopes,(function(t){e.push({Description:t.Description,Name:t.Name,Value:n.observable(t.Value)})})),e},updateScopes:function(e,t){var i=[];s.each(t,(function(e){i.push({Description:e.Description,Name:e.Name,Value:e.Value()})})),this.Connected=e,this.Scopes=i},updateAdmin:function(e,t,i,s){this.EnableModule=e,this.Id=t,this.Secret=i,this.Scopes=s}}},sWkr:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("AFLV"),r=i("HLSX");function a(e){this.oOptions=s.extend({creaId:"creaId",fontNameArray:["Tahoma"],defaultFontName:"Tahoma",defaultFontSize:3,alwaysTryUseImageWhilePasting:!0,dropableArea:null,isRtl:!1,onChange:function(){},onCursorMove:function(){},onFocus:function(){},onBlur:function(){},onUrlIn:function(){},onUrlOut:function(){},onImageSelect:function(){},onImageBlur:function(){},onItemOver:null,onItemOut:null,openInsertLinkDialog:function(){},onUrlClicked:!1},void 0===e?{}:e)}a.prototype.oOptions={},a.prototype.$container=null,a.prototype.$editableArea=null,a.prototype.aEditableAreaHtml=[],a.prototype.iUndoRedoPosition=0,a.prototype.bEditable=!1,a.prototype.bFocused=!1,a.prototype.bEditing=!1,a.prototype.aSizes=[{inNumber:1,inPixels:10},{inNumber:2,inPixels:13},{inNumber:3,inPixels:16},{inNumber:4,inPixels:18},{inNumber:5,inPixels:24},{inNumber:6,inPixels:32},{inNumber:7,inPixels:48}],a.prototype.bInUrl=!1,a.prototype.oCurrLink=null,a.prototype.oCurrImage=null,a.prototype.bInImage=!1,a.prototype.sBasicFontName="",a.prototype.sBasicFontSize="",a.prototype.sBasicDirection="",a.prototype.start=function(e){function t(e){return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(e)}function i(e){return!!e.match(/^[A-Z0-9\"!#\$%\^\{\}`~&'\+\-=_\.]+@[A-Z0-9\.\-]+$/i)}this.aRanges=null,this.$container=n("#"+this.oOptions.creaId),this.$editableArea=n("<div></div>").addClass("crea-content-editable").prop("contentEditable","true").appendTo(this.$container);var o=this;this.$editableArea.on("focus",(function(){o.bFocused=!0})),this.$editableArea.on("blur",(function(){o.bFocused=!1})),this.$editableArea.on("click","img",(function(e){var t=n(this);o.bInImage=!0,o.oCurrImage=t,o.oOptions.onImageSelect(t,e),e.stopPropagation()})),this.$editableArea.on("click",(function(e){o.bInImage=!1,o.oCurrImage=null,o.oOptions.onImageBlur()})),null!==o.oOptions.onItemOver&&this.$editableArea.on("mouseover",(function(e){o.oOptions.onItemOver(e)})),null!==o.oOptions.onItemOver&&this.$editableArea.on("mouseout",(function(e){o.oOptions.onItemOut(e)})),this.$editableArea.on("cut paste",(function(){o.bEditing=!0,o.editableSave(),s.defer((function(){o.editableSave()}))})),this.$editableArea.on("paste",(function(e){if((e=e.originalEvent||e).clipboardData){var s,n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("text/html");o.oOptions.alwaysTryUseImageWhilePasting&&o.pasteImage(e)?e.preventDefault():t(n)?(e.preventDefault(),o.execCom("insertHTML",'<a href="'+n+'">'+n+"</a>")):i(n)?(e.preventDefault(),o.execCom("insertHTML",'<a href="mailto:'+n+'">'+n+"</a>")):""!==r&&(e.preventDefault(),3===(s=r.split(/<!--StartFragment-->|<!--EndFragment-->/gi)).length&&(r=s[1]),r=o.replacePToBr(r),o.execCom("insertHTML",r))}})),this.$editableArea.on("keydown",(function(e){var s=e.keyCode||e.which||e.charCode||0,n=e.ctrlKey||e.metaKey,r=e.altKey,a=e.shiftKey,l="";if(o.bEditing=!0,a&&n&&s===Enums.Key.z||n&&s===Enums.Key.y)e.preventDefault(),o.editableRedo();else if(n&&!r&&s===Enums.Key.z)e.preventDefault(),o.editableUndo();else if(!n||s!==Enums.Key.k&&s!==Enums.Key.b&&s!==Enums.Key.i&&s!==Enums.Key.u)r||a||n||s!==Enums.Key.Del&&s!==Enums.Key.Backspace||o.editableSave();else switch(e.preventDefault(),s){case Enums.Key.k:t(l=o.getSelectedText())?o.insertLink(l):i(l)?o.insertLink("mailto:"+l):o.oOptions.openInsertLinkDialog();break;case Enums.Key.b:o.bold();break;case Enums.Key.i:o.italic();break;case Enums.Key.u:o.underline()}})),this.$editableArea.on("keyup",(function(e){var t=e.keyCode||e.which||e.charCode||0,i=e.ctrlKey||e.metaKey,s=e.altKey,n=e.shiftKey;s||n||i||(t===Enums.Key.Space||t===Enums.Key.Enter||t===Enums.Key.Del||t===Enums.Key.Backspace?o.editableSave():o.oOptions.onChange())})),this.initContentEditable(),this.setEditable(e)},a.prototype.clearUndoRedo=function(){this.aEditableAreaHtml=[],this.iUndoRedoPosition=0,this.bEditing=!1},a.prototype.isUndoAvailable=function(){return this.iUndoRedoPosition>0},a.prototype.clearRedo=function(){this.aEditableAreaHtml=this.aEditableAreaHtml.slice(0,this.iUndoRedoPosition+1)},a.prototype.editableSave=function(){var e=this.$editableArea.html(),t=s.last(this.aEditableAreaHtml);e!==(t?t[0]:"")&&(this.clearRedo(),this.aEditableAreaHtml.push([e,this.getCaretPos(this.$editableArea[0])]),this.iUndoRedoPosition=this.aEditableAreaHtml.length-1,this.oOptions.onChange())},a.prototype.editableUndo=function(){var e=this.$editableArea.html(),t=this.aEditableAreaHtml[this.iUndoRedoPosition];e!==(t?t[0]:"")&&this.editableSave(),this.iUndoRedoPosition>0&&(this.iUndoRedoPosition--,this.$editableArea.html(this.aEditableAreaHtml[this.iUndoRedoPosition]),this.setCaretPos(this.$editableArea[0],this.aEditableAreaHtml[this.iUndoRedoPosition][1]))},a.prototype.editableRedo=function(){this.iUndoRedoPosition<this.aEditableAreaHtml.length-1&&(this.iUndoRedoPosition++,this.$editableArea.html(this.aEditableAreaHtml[this.iUndoRedoPosition]),this.setCaretPos(this.$editableArea[0],this.aEditableAreaHtml[this.iUndoRedoPosition]?this.aEditableAreaHtml[this.iUndoRedoPosition][1]:{}))},a.prototype.getCaretPos=function(e){var t=null,i={},s={},n=0,o={};return window.getSelection&&document.createRange?(t=window.getSelection()).rangeCount>0&&((s=(i=t.getRangeAt(0)).cloneRange()).selectNodeContents(e),s.setEnd(i.startContainer,i.startOffset),o={start:n=s.toString().length,end:n+i.toString().length}):document.selection&&document.body.createTextRange&&(i=document.selection.createRange(),(s=document.body.createTextRange()).moveToElementText(e),"function"==typeof s.setEndPoint&&s.setEndPoint("EndToStart",i),o={start:n=s.text.length,end:n+i.text.length}),o},a.prototype.setCaretPos=function(e,t){if(window.getSelection&&document.createRange){var i=[e],s={},n={},o=!1,r=!1,a=0,l=0,h=0,u=document.createRange();for(u.setStart(e,0),u.collapse(!0),s=i.pop();!r&&s;){if(3===s.nodeType)l=a+s.length,!o&&t.start>=a&&t.start<=l&&(u.setStart(s,t.start-a),o=!0),o&&t.end>=a&&t.end<=l&&(u.setEnd(s,t.end-a),r=!0),a=l;else for(h=s.childNodes.length;h--;)i.push(s.childNodes[h]);s=i.pop()}(n=window.getSelection()).removeAllRanges(),n.addRange(u)}else if(document.selection&&document.body.createTextRange){var c=document.body.createTextRange();c.moveToElementText(e),c.collapse(!0),c.moveEnd("character",t.end),c.moveStart("character",t.start),c.select()}},a.prototype.setTabIndex=function(e){e&&this.$editableArea.attr("tabindex",e)},a.prototype.initContentEditable=function(){this.$editableArea.bind({mousemove:s.bind(this.storeSelectionPosition,this),mouseup:s.bind(this.onCursorMove,this),keydown:s.bind(this.onButtonPressed,this),keyup:s.bind(this.onCursorMove,this),click:s.bind(this.onClickWith,this),focus:this.oOptions.onFocus,blur:this.oOptions.onBlur}),window.File&&window.FileReader&&window.FileList&&this.oOptions.enableDrop&&this.$editableArea.bind({dragover:s.bind(this.onDragOver,this),dragleave:s.bind(this.onDragLeave,this),drop:s.bind(this.onFileSelect,this)});var e=this,t=s.debounce((function(){e.oCurrLink=null,e.bInUrl=!1,e.oOptions.onUrlOut()}),300);n("html, body").on("scroll",t)},a.prototype.onCursorMove=function(e){var t=-1;window.event?t=window.event.keyCode:e&&(t=e.which),13===t&&this.breakQuotes(e),17===t&&this.$editableArea.find("a").css("cursor","inherit"),8===t&&this.uniteWithNextQuote(e),46===t&&r.chrome&&this.uniteWithPrevQuote(e),this.storeSelectionPosition(),this.oOptions.onCursorMove()},a.prototype.onClickWith=function(e){e.ctrlKey&&"A"===e.target.nodeName&&window.open(e.target.href,"_blank"),this.checkAnchorNode()},a.prototype.onButtonPressed=function(e){var t=-1;window.event?t=window.event.keyCode:e&&(t=e.which),17===t&&this.$editableArea.find("a").css("cursor","pointer")},a.prototype.onFileSelect=function(e){if(e=(e&&e.originalEvent?e.originalEvent:e)||window.event){e.stopPropagation(),e.preventDefault();var t=null,i=null,s=e.files||(e.dataTransfer?e.dataTransfer.files:null),n=this;s&&1===s.length&&this.checkIsImage(s[0])&&(i=s[0],(t=new window.FileReader).onload=function(e){n.insertImage(e.target.result)},t.readAsDataURL(i))}},a.prototype.onDragLeave=function(){this.$editableArea.removeClass("editorDragOver")},a.prototype.onDragOver=function(e){e.stopPropagation(),e.preventDefault(),this.$editableArea.addClass("editorDragOver")},a.prototype.pasteImage=function(e){var t=e.clipboardData&&e.clipboardData.items,i=this,n=!1;return window.File&&window.FileReader&&window.FileList&&t&&s.each(t,(function(e){if(i.checkIsImage(e)&&e.getAsFile){var t=null,s=e.getAsFile();s&&((t=new window.FileReader).onload=function(e){i.insertImage(e.target.result)},t.readAsDataURL(s),n=!0)}})),n},a.prototype.checkIsImage=function(e){return e&&e.type&&0===e.type.indexOf("image/")},a.prototype.setPlainText=function(e){"string"!=typeof e&&(e=""),this.$editableArea&&(this.editableSave(),this.$editableArea.empty().text(e).css("white-space","pre"),this.editableSave())},a.prototype.setText=function(e){if("string"!=typeof e&&(e=""),this.$editableArea){0===e.length&&(e="<br />");var t=n(e),i=n(e),s=i.children(),o=s.first(),r=1===i.length&&"font-wrapper"===i.data("crea"),a=1===i.length&&1===s.length&&"body"===i.data("xDivType")&&"font-wrapper"===o.data("crea");r?(this.setBasicStyles(i.css("font-family"),i.css("font-size"),i.css("direction")),t=i.contents()):a?(this.setBasicStyles(o.css("font-family"),o.css("font-size"),o.css("direction")),t=o.contents()):this.setBasicStyles(this.oOptions.defaultFontName,this.convertFontSizeToPixels(this.oOptions.defaultFontSize),this.oOptions.isRtl?"rtl":"ltr"),this.$editableArea.empty().append(t).css("white-space","normal"),this.clearUndoRedo(),this.editableSave()}},a.prototype.setBasicStyles=function(e,t,i){this.sBasicFontName=e,this.sBasicFontSize=t,this.sBasicDirection=i,this.$editableArea.css({"font-family":this.getFontNameWithFamily(this.sBasicFontName),"font-size":this.sBasicFontSize,direction:this.sBasicDirection})},a.prototype.replacePToBr=function(e){return e.replace(/<\/p>/gi,"<br />").replace(/<p [^>]*>/gi,"").replace(/<p>/gi,"")},a.prototype.getPlainText=function(){var e="";return this.$editableArea&&(e=this.$editableArea.html().replace(/([^>]{1})<div>/gi,"$1\n").replace(/<style[^>]*>[^<]*<\/style>/gi,"\n").replace(/<br *\/{0,1}>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/div>/gi,"\n").replace(/<a [^>]*href="([^"]*?)"[^>]*>(.*?)<\/a>/gi,"$2 ($1)").replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"')),e},a.prototype.getText=function(e){var t="";return this.$editableArea&&this.$editableArea.length>0&&(e&&this.$editableArea.find('div[data-anchor="signature"]').removeAttr("data-anchor"),t=this.$editableArea.html(),t=this.replacePToBr(t),t='<div data-crea="font-wrapper" style="font-family: '+this.getFontNameWithFamily(this.sBasicFontName)+"; font-size: "+this.sBasicFontSize+"; direction: "+this.sBasicDirection+'">'+t+"</div>"),t},a.prototype.changeSignatureContent=function(e,t){var i,s,o,r,a,l,h,u=this.$editableArea.find('div[data-anchor="signature"]'),c=n(e).closest('div[data-crea="font-wrapper"]'),d=n(t).closest('div[data-crea="font-wrapper"]');if(u.length>0)o=u.html(),""===t?u.html(o+e):-1!==o.indexOf(t)?u.html(o.replace(t,e)):-1!==o.indexOf(e)||(i=0===c.length||0===d.length?t:d.html(),s=0===c.length||0===d.length?e:c.html(),-1!==o.indexOf(i)?u.html(o.replace(i,e)):-1!==o.indexOf(s)||u.html(o+e));else{l=t;try{r=this.$editableArea.find('*:contains("'+l+'")')}catch(e){r=n("")}if(0===r.length&&d.length>0){l=d.html();try{r=this.$editableArea.find('*:contains("'+l+'")')}catch(e){r=n("")}}r.length>0&&(a=(r=n(r[0])).closest("blockquote")),a&&0===a.length?r.html(r.html().replace(l,e)):(h=(u=this.$editableArea.find('div[data-anchor="reply-title"]')).length>0?n(u[0]).closest("blockquote"):u,(0===u.length||h.length>0)&&(u=this.$editableArea.find("blockquote")),u.length>0?n(u[0]).before(n('<br /><div data-anchor="signature">'+e+"</div><br />")):this.$editableArea.append(n('<br /><div data-anchor="signature">'+e+"</div><br />")))}this.editableSave()},a.prototype.isFocused=function(){return this.bFocused},a.prototype.setFocus=function(e){var t=this.$editableArea.contents(),i=null,o="";this.$editableArea.focus(),e&&s.isArray(this.aRanges)&&this.aRanges.length>0?this.restoreSelectionPosition():t.length>0&&(3===t[0].nodeType?i=n(t[0]):(i=n(document.createTextNode("")),n(t[0]).before(i)),o=i.text(),this.setCursorPosition(i[0],o.length))},a.prototype.setBlur=function(){this.$editableArea.blur()},a.prototype.setEditable=function(e){e?this.enableContentEditable():this.disableContentEditable()},a.prototype.disableContentEditable=function(){this.bEditable=!1,this.$editableArea.prop("contentEditable","false")},a.prototype.enableContentEditable=function(){this.$editableArea.prop("contentEditable","true"),setTimeout(s.bind((function(){this.bEditable=!0}),this),0)},a.prototype.fixFirefoxCursorBug=function(){r.firefox&&(this.disableContentEditable(),setTimeout(s.bind((function(){this.enableContentEditable()}),this),0))},a.prototype.setRtlDirection=function(){this.setBasicStyles(this.sBasicFontName,this.sBasicFontSize,"rtl")},a.prototype.setLtrDirection=function(){this.setBasicStyles(this.sBasicFontName,this.sBasicFontSize,"ltr")},a.prototype.pasteHtmlAtCaret=function(e){var t,i;if(window.getSelection){if((t=window.getSelection()).getRangeAt&&t.rangeCount){(i=t.getRangeAt(0)).deleteContents();var s=document.createElement("div");s.innerHTML=e;for(var n,o,r=document.createDocumentFragment();n=s.firstChild;)o=r.appendChild(n);i.insertNode(r),o&&((i=i.cloneRange()).setStartAfter(o),i.collapse(!0),t.removeAllRanges(),t.addRange(i))}}else document.selection&&"Control"!==document.selection.type&&(i=document.selection.createRange())&&i.pasteHTML&&i.pasteHTML(e)},a.prototype.execCom=function(e,t,i){var s,n=!1;return this.bEditable&&(this.editableSave(),r.opera&&this.restoreSelectionPosition(),"insertHTML"===e&&r.ie?this.pasteHtmlAtCaret(t):n=void 0===t?window.document.execCommand(e):window.document.execCommand(e,!1,t),r.chrome&&(this.storeSelectionPosition(),"insertHTML"===e&&this.aRanges.length>0&&((s=this.aRanges[0]).setEnd(s.startContainer,s.startOffset),this.restoreSelectionPosition())),i||this.editableSave()),n},a.prototype.insertHtml=function(e,t){this.execCom("insertHTML",e,t)},a.prototype.changeImageSource=function(e,t){this.$editableArea.find('img[id="'+e+'"]').attr("src",t),this.editableSave()},a.prototype.insertEmailLink=function(e){this.restoreSelectionPosition(),""===this.getSelectedText()?this.execCom("insertHTML",'<a href="mailto:'+e+'">'+e+"</a>"):this.insertLink("mailto:"+e)},a.prototype.insertLink=function(e){if(e=this.normaliseURL(e),this.restoreSelectionPosition(e),""===this.getSelectedText()&&r.ie)this.execCom("insertHTML",'<a href="'+e+'">'+e+"</a>");else{var t=r.ie8AndBelow?"CreateLink":"createlink";this.execCom(t,e)}this.changeFocusLink(e)},a.prototype.removeLink=function(){var e=r.ie8AndBelow?"Unlink":"unlink";this.execCom(e)},a.prototype.insertImage=function(e){var t=r.ie8AndBelow?"InsertImage":"insertimage";return this.isFocused()?this.restoreSelectionPosition():this.setFocus(!0),this.execCom(t,e)},a.prototype.numbering=function(){this.execCom("InsertOrderedList")},a.prototype.bullets=function(){this.execCom("InsertUnorderedList")},a.prototype.horizontalLine=function(){this.execCom("InsertHorizontalRule")},a.prototype.getFontNameWithFamily=function(e){var t="";switch(e){case"Arial":case"Arial Black":case"Tahoma":case"Verdana":t=", sans-serif";break;case"Courier New":t=", monospace";break;case"Times New Roman":t=", serif"}return e+t},a.prototype.fontName=function(e){var t=!this.aRanges;this.setFocus(!0),this.execCom("FontName",this.getFontNameWithFamily(e)),t&&this.setBasicStyles(e,this.sBasicFontSize,this.sBasicDirection)},a.prototype.fontSize=function(e){var t=!this.aRanges;this.setFocus(!0),this.execCom("FontSize",e),t&&this.setBasicStyles(this.sBasicFontName,this.convertFontSizeToPixels(e),this.sBasicDirection)},a.prototype.bold=function(){this.execCom("Bold"),this.$editableArea.focus()},a.prototype.italic=function(){this.execCom("Italic"),this.$editableArea.focus()},a.prototype.underline=function(){this.execCom("Underline"),this.$editableArea.focus()},a.prototype.strikeThrough=function(){this.execCom("StrikeThrough"),this.$editableArea.focus()},a.prototype.undo=function(){this.editableUndo()},a.prototype.redo=function(){this.editableRedo()},a.prototype.alignLeft=function(){this.execCom("JustifyLeft")},a.prototype.center=function(){this.execCom("JustifyCenter")},a.prototype.alignRight=function(){this.execCom("JustifyRight")},a.prototype.justify=function(){this.execCom("JustifyFull")},a.prototype.textColor=function(e){this.execCom("ForeColor",e),this.$editableArea.focus()},a.prototype.backgroundColor=function(e){var t=r.ie?"BackColor":"hilitecolor";this.execCom(t,e),this.$editableArea.focus()},a.prototype.removeFormat=function(){this.execCom("removeformat"),this.$editableArea.focus()},a.prototype.getFontName=function(){if(this.bEditable){var e=window.document.queryCommandValue("FontName"),t=this.sBasicFontName,i="";"string"==typeof e&&(e=e.replace(/'/g,""),n.each(this.oOptions.fontNameArray,(function(t,s){(e.indexOf(s)>-1||e.indexOf(s.toLowerCase())>-1)&&(i=s)})),""!==i&&(t=i))}return t},a.prototype.getIsBold=function(){if(this.bEditable)var e=window.document.queryCommandState("bold");return e},a.prototype.getIsItalic=function(){if(this.bEditable)var e=window.document.queryCommandState("italic");return e},a.prototype.getIsUnderline=function(){if(this.bEditable)var e=window.document.queryCommandState("underline");return e},a.prototype.getIsEnumeration=function(){if(this.bEditable)var e=window.document.queryCommandState("insertOrderedList");return e},a.prototype.getIsBullets=function(){if(this.bEditable)var e=window.document.queryCommandState("insertUnorderedList");return e},a.prototype.getIsStrikeThrough=function(){if(this.bEditable)var e=window.document.queryCommandState("StrikeThrough");return e},a.prototype.convertFontSizeToPixels=function(e){var t=0;return n.each(this.aSizes,(function(i,s){0===t&&e<=s.inNumber&&(t=s.inPixels)})),t+"px"},a.prototype.convertFontSizeToNumber=function(e){var t=o.pInt(e),i=0;return t>0&&n.each(this.aSizes,(function(e,s){0===i&&t<=s.inPixels&&(i=s.inNumber)})),i},a.prototype.getFontSizeInNumber=function(){var e="",t=0;return this.bEditable&&(e=window.document.queryCommandValue("FontSize"),t=o.pInt(e)),(isNaN(t)||t<=0)&&(t=this.convertFontSizeToNumber(this.sBasicFontSize)),t},a.prototype.changeLink=function(e){var t=this.normaliseURL(e),i=n(this.oCurrLink);this.oCurrLink&&(i.attr("href")===i.text()&&i.text(t),"A"===this.oCurrLink.tagName?i.attr("href",t):i.parent().attr("href",t),this.oCurrLink=null,this.bInUrl=!1)},a.prototype.removeCurrentLink=function(){if(this.oCurrLink&&document.createRange&&window.getSelection){var e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.oCurrLink),t.removeAllRanges(),t.addRange(e),this.removeLink(),this.oCurrLink=null,this.bInUrl=!1,this.oOptions.onUrlOut()}},a.prototype.changeFocusLink=function(e){var t=null,i=null;r.firefox&&window.getSelection&&(i=(t=window.getSelection()).focusNode?t.focusNode.parentElement:null)&&"A"===i.tagName&&n(i).attr("href",e)},a.prototype.removeCurrentImage=function(){this.oCurrImage&&(this.oCurrImage.remove(),this.oCurrImage=null,this.bInImage=!1,this.oOptions.onImageBlur()),this.setFocus(!0)},a.prototype.changeCurrentImage=function(e){if(this.oCurrImage&&void 0!==e){var t=this.oCurrImage;n.each(e,(function(e,i){t.css(e,i)}))}this.setFocus(!0)},a.prototype.showImageTooltip=function(e){if(this.oCurrImage&&void 0!==e){var t=this.oCurrImage;n.each(e,(function(e,i){t.css(e,i)}))}},a.prototype.normaliseURL=function(e){return-1!==e.search(/^https?:\/\/|^mailto:|^tel:/g)?e:"http://"+e},a.prototype.getSelectedText=function(){var e="",t=null;return window.getSelection&&(t=window.getSelection()).rangeCount>0&&(e=t.getRangeAt(0).toString()),e},a.prototype.storeSelectionPosition=function(){var e=this.getSelectionRanges();s.isArray(e)&&e.length>0&&(this.aRanges=e)},a.prototype.editableIsActive=function(){return!(!n(document.activeElement).hasClass("crea-content-editable")&&!n(document.activeElement).children().first().hasClass("crea-content-editable"))},a.prototype.getSelectionRanges=function(){var e=[];if(window.getSelection&&this.editableIsActive())for(var t=window.getSelection(),i=null,s=0,n=t.rangeCount;s<n;s++)i=t.getRangeAt(s),e.push(i);return e},a.prototype.checkAnchorNode=function(){if(window.getSelection&&this.editableIsActive()){var e=window.getSelection(),t=null;e.anchorNode&&(e.anchorNode.parentElement||e.anchorNode.parentNode)&&(("A"===(t=e.anchorNode.parentElement||e.anchorNode.parentNode).parentNode.tagName||"A"===t.parentElement.tagName)&&(t=t.parentNode),"A"===t.tagName?this.bInUrl&&t===this.oCurrLink?this.bInUrl&&t===this.oCurrLink&&(this.oCurrLink=null,this.bInUrl=!1,this.oOptions.onUrlOut()):(this.oCurrLink=t,this.bInUrl=!0,this.oOptions.onUrlIn(n(t))):this.bInUrl&&(this.oCurrLink=null,this.bInUrl=!1,this.oOptions.onUrlOut()))}},a.prototype.restoreSelectionPosition=function(e){var t,i=null,n=null,o=null;t=this.setSelectionRanges(this.aRanges),window.getSelection&&s.isArray(this.aRanges)&&(e=void 0!==e?e:"",r.firefox&&""===t&&""!==e&&(window.getSelection&&window.getSelection().getRangeAt?(i=window.getSelection()).getRangeAt&&i.rangeCount>0&&(o=(n=i.getRangeAt(0)).createContextualFragment(e),n.insertNode(o)):document.selection&&document.selection.createRange&&document.selection.createRange().pasteHTML(e)))},a.prototype.setSelectionRanges=function(e){var t=null,i=null,n=0,o=0,a="";if(window.getSelection&&s.isArray(e))for(o=e.length,t=window.getSelection(),r.ie10AndAbove||t.removeAllRanges();n<o;n++)(i=e[n])&&(t.addRange(i),a+=""+i);return a},a.prototype.uniteWithNextQuote=function(){var e=window.getSelection?window.getSelection():null,t=e?e.focusNode:null,i=t?this.getLastBlockQuote(t):null,s=i?n(i).next():null,o=s&&s.length>0&&"BLOCKQUOTE"===s[0].tagName?s[0]:null,r=[],a=0,l=0,h=null;if(i&&o){for(n("<br />").appendTo(i),l=(r=n(o).contents()).length,a=0;a<l;a++)h=r[a],n(h).appendTo(i);n(o).remove()}},a.prototype.uniteWithPrevQuote=function(){var e=window.getSelection?window.getSelection():null,t=e?e.focusNode:null,i=t?this.getLastBlockQuote(t):null;this.getPrevAndUnite(i),this.getPrevAndUnite(i)},a.prototype.getPrevAndUnite=function(e){var t=e?n(e).prev():null,i=t&&t.length>0&&"BLOCKQUOTE"===t[0].tagName?t[0]:null,s=[],o=0,r=null;if(e&&i){for(n("<br />").prependTo(e),o=(s=n(i).contents()).length-1;o>0;o--)r=s[o],n(r).prependTo(e);n(i).remove()}},a.prototype.getLastBlockQuote=function(e){for(var t=e,i=null;t&&t.parentNode;)"BLOCKQUOTE"===t.tagName&&(i=t),t=t.parentNode;return i},a.prototype.breakQuotes=function(e){var t=window.getSelection?window.getSelection():null,i=t?t.focusNode:null,s=i?this.getLastBlockQuote(i):null;i&&s&&this.breakBlocks(i,s,t.focusOffset)},a.prototype.setCursorPosition=function(e,t){if(document.createRange&&window.getSelection){var i=document.createRange(),s=window.getSelection();s.removeAllRanges(),i.setStart(e,t),i.setEnd(e,t),i.collapse(!0),s.addRange(i),this.aRanges=[i]}},a.prototype.cloneNode=function(e){var t=null,i="";try{t=n(e).clone()}catch(s){i=e.tagName,t=n("<"+i+"></"+i+">")}return t},a.prototype.breakBlocks=function(e,t,i){for(var s=e,o=null,r=[],a=0,l=0,h=null,u=!0,c=null,d=null,p=null,m=null,g=!0,f=null;g&&s.parentNode;){for(p=c,m=d,c=this.cloneNode(s).empty(),d=this.cloneNode(s).empty(),l=(r=n(s).contents()).length,u=!0,null===o&&(o=r[i]),0===l&&(c=null),a=0;a<l;a++)(h=r[a])===o?(null===p?a===i&&"BR"===h.tagName||n(h).appendTo(d):(p.html().length>0&&p.appendTo(c),m.appendTo(d)),u=!1):u?n(h).appendTo(c):n(h).appendTo(d);t===s&&(g=!1),o=s,s=s.parentNode}null!==c&&null!==d&&(c.insertBefore(n(t)),f=n("<span>&nbsp;</span>").insertBefore(n(t)),n("<br>").insertBefore(n(t)),d.insertBefore(n(t)),n(t).remove(),this.setCursorPosition(f[0],0))},e.exports=a},tqo6:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("AFLV");e.exports={ServerModuleName:"Calendar",HashModuleName:"calendar",ServerMeetingsPluginName:"CalendarMeetingsPlugin",ServerCorporateCalendarName:"CorporateCalendar",AddDescriptionToTitle:!1,AllowAppointments:!0,AllowShare:!1,AllowTasks:!0,DefaultTab:"3",HighlightWorkingDays:!0,HighlightWorkingHours:!0,PublicCalendarId:"",WeekStartsOn:"0",WorkdayEnds:"18",WorkdayStarts:"9",init:function(e){var t=e[this.ServerModuleName],i=e[this.ServerMeetingsPluginName],r=e[this.ServerCorporateCalendarName];s.isEmpty(t)||(this.AddDescriptionToTitle=o.pBool(t.AddDescriptionToTitle,this.AddDescriptionToTitle),this.AddDescriptionToTitle&&n("html").addClass("AddDescriptionToTitle"),s.isEmpty(r)||(this.AllowShare=o.pBool(r.AllowShare,this.AllowShare)),this.AllowTasks=o.pBool(t.AllowTasks,this.AllowTasks),this.DefaultTab=o.pString(t.DefaultTab,this.DefaultTab),this.HighlightWorkingDays=o.pBool(t.HighlightWorkingDays,this.HighlightWorkingDays),this.HighlightWorkingHours=o.pBool(t.HighlightWorkingHours,this.HighlightWorkingHours),this.PublicCalendarId=o.pString(t.PublicCalendarId,this.PublicCalendarId),this.WeekStartsOn=o.pString(t.WeekStartsOn,this.WeekStartsOn),this.WorkdayEnds=o.pString(t.WorkdayEnds,this.WorkdayEnds),this.WorkdayStarts=o.pString(t.WorkdayStarts,this.WorkdayStarts)),s.isEmpty(i)||(this.AllowAppointments=o.pBool(i.AllowAppointments,this.AllowAppointments))},update:function(e,t,i,s,n,o){this.DefaultTab=o.toString(),this.HighlightWorkingDays=e,this.HighlightWorkingHours=t,this.WeekStartsOn=n.toString(),this.WorkdayEnds=s.toString(),this.WorkdayStarts=i.toString()}}},"u+3T":function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("o0Bx"),r=i("OgeD"),a=i("AFLV"),l=r.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("iIt5");function u(){l.call(this,h.ServerModuleName),this.loginLogo=n.observable(h.LoginLogo),this.tabsbarLogo=n.observable(h.TabsbarLogo)}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="BrandingWebclient_AdminSettingsView",u.prototype.getCurrentValues=function(){return[this.loginLogo(),this.tabsbarLogo()]},u.prototype.revertGlobalValues=function(){this.loginLogo(h.LoginLogo),this.tabsbarLogo(h.TabsbarLogo)},u.prototype.getParametersForSave=function(){var e={LoginLogo:this.loginLogo(),TabsbarLogo:this.tabsbarLogo()};return a.isPositiveNumber(this.iTenantId)&&(e.TenantId=this.iTenantId),e},u.prototype.applySavedValues=function(e){a.isPositiveNumber(this.iTenantId)||h.update(e)},u.prototype.setAccessLevel=function(e,t){this.visible(""===e||"Tenant"===e),this.iTenantId=t},u.prototype.onRouteChild=function(e){this.requestPerTenantSettings()},u.prototype.requestPerTenantSettings=function(){a.isPositiveNumber(this.iTenantId)?(this.loginLogo(""),this.tabsbarLogo(""),o.send(h.ServerModuleName,"GetSettings",{TenantId:this.iTenantId},(function(e){e.Result&&(this.loginLogo(e.Result.LoginLogo),this.tabsbarLogo(e.Result.TabsbarLogo),this.updateSavedState())}),this)):this.revertGlobalValues()},e.exports=new u},"uN/E":function(e,t,i){var s,n=n||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,i=function(){return e.URL||e.webkitURL||e},s=t.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in s,o=/constructor/i.test(e.HTMLElement)||e.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l=function(e){setTimeout((function(){"string"==typeof e?i().revokeObjectURL(e):e.remove()}),4e4)},h=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,u,c){c||(t=h(t));var d,p=this,m="application/octet-stream"===t.type,g=function(){!function(e,t,i){for(var s=(t=[].concat(t)).length;s--;){var n=e["on"+t[s]];if("function"==typeof n)try{n.call(e,i||e)}catch(e){a(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,n)return d=i().createObjectURL(t),void setTimeout((function(){var e,t;s.href=d,s.download=u,e=s,t=new MouseEvent("click"),e.dispatchEvent(t),g(),l(d),p.readyState=p.DONE}));!function(){if((r||m&&o)&&e.FileReader){var s=new FileReader;return s.onloadend=function(){var t=r?s.result:s.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,g()},s.readAsDataURL(t),void(p.readyState=p.INIT)}(d||(d=i().createObjectURL(t)),m)?e.location.href=d:e.open(d,"_blank")||(e.location.href=d);p.readyState=p.DONE,g(),l(d)}()},c=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,i){return t=t||e.name||"download",i||(e=h(e)),navigator.msSaveOrOpenBlob(e,t)}:(c.abort=function(){},c.readyState=c.INIT=0,c.WRITING=1,c.DONE=2,c.error=c.onwritestart=c.onprogress=c.onwrite=c.onabort=c.onerror=c.onwriteend=null,function(e,t,i){return new u(e,t||e.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=n:null!==i("B9Yq")&&null!==i("PDX0")&&(void 0===(s=function(){return n}.call(t,i,t,e))||(e.exports=s))},vF2m:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("AFLV");e.exports={ServerModuleName:"Google",HashModuleName:"google",Connected:!1,EnableModule:!1,Id:"",Secret:"",Key:"",Scopes:[],init:function(e){var t=s.extend({},e[this.ServerModuleName]||{},e.Google||{});s.isEmpty(t)||(this.Connected=o.pBool(t.Connected,this.Connected),this.EnableModule=o.pBool(t.EnableModule,this.EnableModule),this.Id=o.pString(t.Id,this.Id),this.Secret=o.pString(t.Secret,this.Secret),this.Key=o.pString(t.Key,this.Key),this.Scopes=o.pArray(t.Scopes,this.Scopes))},getScopesCopy:function(){var e=[];return s.each(this.Scopes,(function(t){e.push({Description:t.Description,Name:t.Name,Value:n.observable(t.Value)})})),e},updateScopes:function(e,t){var i=[];s.each(t,(function(e){i.push({Description:e.Description,Name:e.Name,Value:e.Value()})})),this.Connected=e,this.Scopes=i},updateAdmin:function(e,t,i,s,n){this.EnableModule=e,this.Id=t,this.Secret=i,this.Key=s,this.Scopes=n}}},vsma:function(e,t,i){"use strict";var s=i("0h2I"),n=i("Ol7c"),o=i("AFLV"),r=i("Yjhd");function a(){this.IDENTITY=!0,this.bAccountPart=!1,this.isDefault=s.observable(!1),this.email=s.observable(""),this.friendlyName=s.observable(""),this.fullEmail=s.computed((function(){return n.getFullEmail(this.friendlyName(),this.email())}),this),this.accountId=s.observable(-1),this.id=s.observable(-1),this.signature=s.observable(""),this.useSignature=s.observable(!1),this.hash=s.computed((function(){return r.getHash(this.accountId()+"identity"+this.id())}),this)}a.prototype.parse=function(e){if("Object/Aurora\\Modules\\Mail\\Classes\\Identity"===e["@Object"]){this.bAccountPart=!!e.AccountPart,this.isDefault(!!e.Default),this.email(o.pString(e.Email)),this.friendlyName(o.pString(e.FriendlyName)),this.accountId(o.pInt(e.IdAccount)),this.id(o.pInt(e.EntityId));var t=o.pString(e.Signature);0!==t.indexOf("<")&&(t="<div>"+t+"</div>"),this.signature=s.observable(t),this.useSignature(!!e.UseSignature)}},e.exports=a},"w+bY":function(e,t,i){var s;!function(){function n(e){function t(){for(;a=u<h.length&&e>c;){var t=u++,s=h[t],n=r.call(s,1);n.push(i(t)),++c,s[0].apply(null,n)}}function i(e){return function(i,n){--c,null==p&&(null!=i?(p=i,u=d=NaN,s()):(h[e]=n,--d?a||t():s()))}}function s(){null!=p?m(p):l?m(p,h):m.apply(null,[p].concat(h))}var n,a,l,h=[],u=0,c=0,d=0,p=null,m=o;return e||(e=1/0),n={defer:function(){return p||(h.push(arguments),++d,t()),n},await:function(e){return m=e,l=!1,d||s(),n},awaitAll:function(e){return m=e,l=!0,d||s(),n}}}function o(){}var r=[].slice;n.version="1.0.7",void 0===(s=function(){return n}.call(t,i,t,e))||(e.exports=s)}()},w5n9:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("OgeD"),a=i("SQrT"),l=r.run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),h=i("6ZXr");function u(){l.call(this,h.ServerModuleName),this.enable=n.observable(h.EnableModule),this.id=n.observable(h.Id),this.secret=n.observable(h.Secret),this.scopes=n.observable(h.getScopesCopy())}s.extendOwn(u.prototype,l.prototype),u.prototype.ViewTemplate="Dropbox_AdminSettingsView",u.prototype.getCurrentValues=function(){var e=s.map(this.scopes(),(function(e){return e.Name+e.Value()}));return[this.enable(),this.id(),this.secret(),e]},u.prototype.revertGlobalValues=function(){this.enable(h.EnableModule),this.id(h.Id),this.secret(h.Secret),this.scopes(h.getScopesCopy())},u.prototype.validateBeforeSave=function(){return!this.enable()||""!==this.id()&&""!==this.secret()||(a.showError(o.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY")),!1)},u.prototype.getParametersForSave=function(){return{EnableModule:this.enable(),Id:this.id(),Secret:this.secret(),Scopes:s.map(this.scopes(),(function(e){return{Name:e.Name,Description:e.Description,Value:e.Value()}}))}},u.prototype.applySavedValues=function(e){h.updateAdmin(e.EnableModule,e.Id,e.Secret,e.Scopes)},u.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new u},xIpW:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("o0Bx"),a=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),l=i("p2hp");function h(){a.call(this,l.ServerModuleName),this.bAllowHorizontalLayout=l.AllowHorizontalLayout,this.aLayoutValues=[{text:o.i18n("MAILWEBCLIENT/LABEL_VERT_SPLIT_LAYOUT"),value:!1},{text:o.i18n("MAILWEBCLIENT/LABEL_HORIZ_SPLIT_LAYOUT"),value:!0}],this.allowMultiAccounts=n.observable(l.AllowMultiAccounts),this.autocreateMailAccountOnNewUserFirstLogin=n.observable(l.AutocreateMailAccountOnNewUserFirstLogin),this.allowAddAccounts=n.observable(l.AllowAddAccounts),this.horizontalLayoutByDefault=n.observable(l.HorizontalLayoutByDefault)}s.extendOwn(h.prototype,a.prototype),h.prototype.ViewTemplate="MailWebclient_Settings_MailAdminSettingsFormView",h.prototype.onRouteChild=function(){r.send(l.ServerModuleName,"GetSettings",{},(function(e){e.Result&&this.allowMultiAccounts(e.Result.AllowMultiAccounts)}),this)},h.prototype.getCurrentValues=function(){return[this.autocreateMailAccountOnNewUserFirstLogin(),this.allowAddAccounts(),this.horizontalLayoutByDefault()]},h.prototype.revertGlobalValues=function(){this.autocreateMailAccountOnNewUserFirstLogin(l.AutocreateMailAccountOnNewUserFirstLogin),this.allowAddAccounts(l.AllowAddAccounts),this.horizontalLayoutByDefault(l.HorizontalLayoutByDefault)},h.prototype.getParametersForSave=function(){return{AutocreateMailAccountOnNewUserFirstLogin:this.autocreateMailAccountOnNewUserFirstLogin(),AllowAddAccounts:this.allowAddAccounts(),HorizontalLayoutByDefault:this.horizontalLayoutByDefault()}},h.prototype.applySavedValues=function(e){l.updateAdmin(e.AutocreateMailAccountOnNewUserFirstLogin,e.AllowAddAccounts,e.HorizontalLayoutByDefault)},h.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new h},xzvH:function(e,t,i){"use strict";var s=i("F/us"),n=i("wd/R"),o=i("Yjhd"),r=i("p2hp"),a=null;function l(){this.oMessages={},setInterval(this.checkAndClear.bind(this),18e5)}l.prototype.get=function(e){var t=JSON.stringify(e);return this.oMessages[t]},l.prototype.set=function(e,t){var i=JSON.stringify(e);this.oMessages[i]=t},l.prototype.requireMailCache=function(){null===a&&(a=i("4+IO"))},l.prototype.checkAndClear=function(){this.requireMailCache();var e=a.getCurrentFolder();if(!e&&a.folderList()&&(e=a.folderList().inboxFolder()),e&&!(n().diff(e.oRelevantInformationLastMoment)>18e5)){var t=s.size(this.oMessages),i=n().add(-4,"hours").unix(),l=8*r.MailsPerPage+700;t>l&&(o.log("checkAndClear",t,r.MailsPerPage,l),s.each(a.messages(),(function(e){e.updateLastAccessTime()})),a.currentMessage()&&a.currentMessage().updateLastAccessTime(),s.each(this.oMessages,function(e,t){0!==e.iLastAccessTime&&e.iLastAccessTime<i&&o.destroyObjectWithObservables(this.oMessages,t)}.bind(this)),o.log("checkAndClear",s.size(this.oMessages)))}},l.prototype.remove=function(e){var t=JSON.stringify(e);o.destroyObjectWithObservables(this.oMessages,t)},l.prototype.updateMomentDates=function(){s.each(this.oMessages,(function(e){e.updateMomentDate()}),this)},e.exports=new l},yF5f:function(e,t,i){"use strict";(function(t){var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("AFLV"),a=i("IAk5"),l=i("SQrT");function h(e,t){switch(e.FieldType){case"bool":return r.pBool(t);case"int":return r.pInt(t);default:return r.pString(t)}}function u(){var e,t;this.bAllowEditWebDomain=a.getUserRole()===Enums.UserRole.SuperAdmin,this.id=n.observable(0),this.name=n.observable(""),this.description=n.observable(""),this.webDomain=n.observable(""),this.siteName=n.observable(""),this.sHeading=o.i18n("ADMINPANELWEBCLIENT/HEADING_CREATE_TENANT"),this.sActionCreate=o.i18n("COREWEBCLIENT/ACTION_CREATE"),this.sActionCreateInProgress=o.i18n("COREWEBCLIENT/ACTION_CREATE_IN_PROGRESS"),this.aAdditionalFields=(e="Tenant",t=r.pArray(window.auroraAppData&&window.auroraAppData.additional_entity_fields_to_edit),s.filter(t,(function(t){return t.value=n.observable(h(t,"")),t.Entity===e})))}u.prototype.ViewTemplate="AdminPanelWebclient_EditTenantView",u.prototype.getCurrentValues=function(){var e=[this.id(),this.name(),this.description(),this.webDomain(),this.siteName()];return s.each(this.aAdditionalFields,(function(t){e.push(t.value())})),e},u.prototype.clearFields=function(){this.id(0),this.name(""),this.description(""),this.webDomain(""),this.siteName(""),s.each(this.aAdditionalFields,(function(e){e.value(h(e,""))}))},u.prototype.parse=function(e,t){t?(this.id(e),this.name(t.Name),this.description(t.Description),this.webDomain(t.WebDomain),this.siteName(t.SiteName),s.each(this.aAdditionalFields,(function(e){e.value(h(e,t[e.FieldName])),e.EnableOnCreate=r.pBool(e.EnableOnCreate,!0),e.EnableOnEdit=r.pBool(e.EnableOnEdit,!0)}))):this.clearFields()},u.prototype.isValidSaveData=function(){return""===t.trim(this.name())?(l.showError(o.i18n("ADMINPANELWEBCLIENT/ERROR_TENANT_NAME_EMPTY")),!1):!/[\\\/\:\*\?\\\"\<\>\|]/gi.test(this.name())||(l.showError(o.i18n("ADMINPANELWEBCLIENT/ERROR_TENANT_NAME_INVALID")),!1)},u.prototype.getParametersForSave=function(){var e={TenantId:this.id(),Name:this.name(),Description:this.description(),WebDomain:this.webDomain(),SiteName:this.siteName()};return s.each(this.aAdditionalFields,(function(t){var i=t.value();"int"===t.FieldType&&(i=r.pInt(i)),e[t.FieldName]=i})),e},e.exports=new u}).call(this,i("EVdn"))},yYIs:function(e,t,i){"use strict";var s=i("F/us"),n=i("0h2I"),o=i("RN+F"),r=i("o0Bx"),a=i("JFZZ"),l=i("SQrT"),h=i("76Kh"),u=i("20Ah");function c(e,t){this.sServerModule=e||"Core",this.sUpdateSettingsMethod=t||"UpdateSettings",this.isSaving=n.observable(!1),this.visible=n.observable(!0),this.sSavedState="",this.bShown=!1,this.aSettingsSections=[]}c.prototype.ViewTemplate="",c.prototype.addSettingsSection=function(e){this.aSettingsSections.push(e)},c.prototype.onRoute=function(e){var t=!this.bShown;this.bShown=!0,t&&s.isFunction(this.onShow)&&this.onShow(),this.revert(),s.isFunction(this.onRouteChild)&&this.onRouteChild(e),s.each(this.aSettingsSections,(function(t){s.isFunction(t.onShow)&&t.onShow(e)}))},c.prototype.hide=function(e,t){var i=this.getCurrentState()!==this.sSavedState;s.each(this.aSettingsSections,(function(e){s.isFunction(e.getCurrentState)&&(i=i||e.getCurrentState()!==e.sSavedState)})),i?h.showPopup(u,[o.i18n("COREWEBCLIENT/CONFIRM_DISCARD_CHANGES"),s.bind((function(i){i?(this.bShown=!1,e(),this.revert()):s.isFunction(t)&&t()}),this)]):(this.bShown=!1,e())},c.prototype.getCurrentValues=function(){return[]},c.prototype.getCurrentState=function(){return this.getCurrentValues().join(":")},c.prototype.updateSavedState=function(){this.sSavedState=this.getCurrentState()},c.prototype.revertGlobalValues=function(){},c.prototype.revert=function(){s.each(this.aSettingsSections,(function(e){s.isFunction(e.revert)&&e.revert()})),this.revertGlobalValues(),this.updateSavedState()},c.prototype.getParametersForSave=function(){return{}},c.prototype.save=function(){s.isFunction(this.validateBeforeSave)&&!this.validateBeforeSave()||(this.isSaving(!0),r.send(this.sServerModule,this.sUpdateSettingsMethod,this.getParametersForSave(),this.onResponse,this))},c.prototype.applySavedValues=function(e){},c.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var i=t.Parameters;this.updateSavedState(),this.applySavedValues(i),l.showReport(o.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))}else a.showErrorByCode(e,o.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},c.prototype.setAccessLevel=function(e,t){},e.exports=c},zu1m:function(e,t,i){"use strict";var s=i("F/us"),n=i("EVdn"),o=i("AFLV"),r={};r.showInlinePictures=function(e,t,i,o){var r=function(e){return s.find(t,(function(t){return t.CID===e}))};"string"!=typeof o&&(o=""),i.length>0&&(n("[data-x-src-cid]",e).each((function(){var e=n(this).attr("data-x-src-cid"),t=r(e);t&&t.ViewLink.length>0&&n(this).attr("src",o+t.ViewLink)})),n("[data-x-style-cid]",e).each((function(){var e="",t=n(this).attr("data-x-style-cid-name"),i=n(this).attr("data-x-style-cid"),s=r(i);s&&s.ViewLink.length>0&&""!==t&&(e=""===(e=n.trim(n(this).attr("style")))?"":";"===e.substr(-1)?e+" ":e+"; ",n(this).attr("style",e+t+": url('"+s.ViewLink+"')"))}))),n("[data-x-src-location]",e).each((function(){var e,i=n(this).attr("data-x-src-location"),a=(e=i,s.find(t,(function(t){return t.ContentLocation===e})));a||(a=r(i)),a&&a.ViewLink.length>0&&n(this).attr("src",o+a.ViewLink)}))},r.showExternalPictures=function(e){n("[data-x-src]",e).each((function(){n(this).attr("src",n(this).attr("data-x-src")).removeAttr("data-x-src")})),n("[data-x-style-url]",e).each((function(){var e=n.trim(n(this).attr("style"));e=""===e?"":";"===e.substr(-1)?e+" ":e+"; ",n(this).attr("style",e+n(this).attr("data-x-style-url")).removeAttr("data-x-style-url")}))},r.joinReplyPrefixesInSubject=function(e,t,i){var r=[t.toUpperCase()],a=[i.toUpperCase()],l=s.union(r,a).join("|"),h="",u=e.split(":"),c=[],d="";return s.each(u,(function(e){if(0===d.length){var h=n.trim(e.toUpperCase()),u=-1!==s.indexOf(r,h),p=-1!==s.indexOf(a,h),m=1,g=c.length>0?c[c.length-1]:null;if(!u&&!p){var f=new window.RegExp("^\\s?("+l+")\\s?[\\[\\(]([\\d]+)[\\]\\)]$","gi").exec(h);f&&3===f.length&&(u=-1!==s.indexOf(r,f[1].toUpperCase()),p=-1!==s.indexOf(a,f[1].toUpperCase()),m=o.pInt(f[2]))}u?g&&g.prefix===t?g.count+=m:c.push({prefix:t,count:m}):p?g&&g.prefix===i?g.count+=m:c.push({prefix:i,count:m}):d=e}else d+=":"+e})),s.each(c,(function(e){1===e.count?h+=e.prefix+": ":h+=e.prefix+"["+e.count+"]: "})),h+=n.trim(d)},e.exports=r}}]);