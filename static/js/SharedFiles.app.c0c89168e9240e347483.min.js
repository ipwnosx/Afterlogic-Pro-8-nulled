(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{"1+iQ":function(t,e,i){"use strict";var s=i("F/us"),o={SharedFileAccess:{Full:0,Write:1,Read:2}};void 0===window.Enums&&(window.Enums={}),s.extendOwn(window.Enums,o)},"42lS":function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),n=i("czxF");function r(){n.call(this),this.htmlEmbed=o.observable("")}s.extendOwn(r.prototype,n.prototype),r.prototype.PopupTemplate="CoreWebclient_EmbedHtmlPopup",r.prototype.onOpen=function(t){this.htmlEmbed(t)},r.prototype.close=function(){this.closePopup(),this.htmlEmbed("")},t.exports=new r},"5hOJ":function(t,e,i){"use strict";var s=i("wd/R"),o=i("RN+F"),n=i("Yjhd"),r=i("hPb3");function a(){this.iTimeStampInUTC=0,this.oMoment=null}a.prototype.parse=function(t){this.iTimeStampInUTC=t,this.oMoment=s.unix(this.iTimeStampInUTC)},a.prototype.setDate=function(t,e,i){this.oMoment=s([t,e,i])},a.prototype.getTimeFormat=function(){return r.timeFormat()===window.Enums.TimeFormat.F24?"HH:mm":"hh:mm A"},a.prototype.getFullDate=function(){return this.getDate()+" "+this.getTime()},a.prototype.getMidDate=function(){return this.getShortDate(!0)},a.prototype.getShortDate=function(t){var e="",i=null;return this.oMoment&&((i=s()).format("L")===this.oMoment.format("L")?e=this.oMoment.format(this.getTimeFormat()):(e=i.clone().subtract(1,"days").format("L")===this.oMoment.format("L")?o.i18n("COREWEBCLIENT/LABEL_YESTERDAY"):r.UserSelectsDateFormat?this.oMoment.format(n.getDateFormatForMoment(r.dateFormat())):i.year()===this.oMoment.year()?this.oMoment.format("MMM D"):this.oMoment.format("MMM D, YYYY"),t&&(e+=", "+this.oMoment.format(this.getTimeFormat())))),e},a.prototype.getDate=function(){var t="ddd, MMM D, YYYY";return r.UserSelectsDateFormat&&(t="ddd, "+n.getDateFormatForMoment(r.dateFormat())),this.oMoment?this.oMoment.format(t):""},a.prototype.getTime=function(){return this.oMoment?this.oMoment.format(this.getTimeFormat()):""},a.prototype.getTimeStampInUTC=function(){return this.iTimeStampInUTC},t.exports=a},Pg7U:function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),n=i("wd/R"),r=i("RN+F"),a=i("AFLV"),h=i("Yjhd"),l=i("IAk5"),u=i("ZCBP"),p=i("cGGv"),c=i("5hOJ"),d=i("76Kh"),m=i("42lS"),b=window.Enums;function S(t,e){this.IS_FILE=!0,this.storageType=o.observable(a.pString(t.Type)),this.sLastModified=S.parseLastModified(t.LastModified),this.iLastModified=a.pInt(t.LastModified),this.path=o.observable(a.pString(t.Path)),this.fullPath=o.observable(a.pString(t.FullPath)),this.selected=o.observable(!1),this.checked=o.observable(!1),this.bIsLink=!!t.IsLink,this.oExtendedProps=t.ExtendedProps,this.sLinkType=this.bIsLink?a.pString(t.LinkType):"",this.sLinkUrl=this.bIsLink?a.pString(t.LinkUrl):"",this.sThumbnailExternalLink=this.bIsLink?a.pString(t.ThumbnailUrl):"",this.deleted=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.published=o.observable(!1),this.sOwnerName=a.pString(t.Owner),p.call(this),this.content=o.observable(""),this.thumbUrlInQueueSubscribtion.dispose(),this.thumbUrlInQueue.subscribe((function(){""!==this.sThumbnailExternalLink?this.thumbnailSrc(this.sThumbnailExternalLink):this.bIsLink||this.getInThumbQueue()}),this),this.visibleCancelButton=o.computed((function(){return this.visibleProgress()&&100!==this.progressPercent()}),this),this.oActionsData.list={Text:r.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:s.bind((function(){l.broadcastEvent("Files::ShowList",{Item:this})}),this)},this.oActionsData.open={Text:r.i18n("COREWEBCLIENT/ACTION_OPEN_LINK"),Handler:s.bind(this.openLink,this)},this.iconAction(""),this.sHeaderText=s.bind((function(){if(this.sLastModified){var t=""!==this.sOwnerName?"FILESWEBCLIENT/INFO_OWNER_AND_DATA":"FILESWEBCLIENT/INFO_DATA";return r.i18n(t,{OWNER:this.sOwnerName,LASTMODIFIED:this.sLastModified})}return""}),this)(),this.type=this.storageType,this.canShare=o.computed((function(){return this.storageType()===b.FileStorageType.Personal||this.storageType()===b.FileStorageType.Corporate}),this),this.sHtmlEmbed=a.pString(t.OembedHtml),this.commonParseActions(t),this.cssClasses=o.computed((function(){var t=this.getCommonClasses();return this.allowDrag()&&t.push("dragHandle"),this.selected()&&t.push("selected"),this.checked()&&t.push("checked"),this.deleted()&&t.push("deleted"),this.allowPublicLink()&&this.published()&&t.push("published"),this.bIsLink&&t.push("aslink"),t.join(" ")}),this),this.parse(t,e)}s.extendOwn(S.prototype,p.prototype),S.parseLastModified=function(t){var e=new c;return t?(e.parse(t),e.getShortDate()):""},S.prepareLinkData=function(t,e){return{IsLink:!0,LinkType:t.LinkType,LinkUrl:e,Name:t.Name,Size:t.Size,ThumbnailUrl:t.Thumb}},S.prototype.parse=function(t,e){this.uploaded(!0),this.allowDrag(!e),this.allowUpload(!0),this.allowPublicLink(!0),this.allowActions(!e&&""!==this.fullPath()),this.fileName(a.pString(t.Name)),this.content(a.pString(t.Content)),this.id(a.pString(t.Id)),this.published(!!t.Published),this.size(a.pInt(t.Size)),this.hash(a.pString(t.Hash)),this.thumbUrlInQueue(""!==a.pString(t.ThumbnailUrl)?a.pString(t.ThumbnailUrl)+"/"+Math.random():""),this.mimeType(a.pString(t.ContentType)),this.bHasHtmlEmbed=!e&&""!==this.fullPath()&&"oembeded"===this.sLinkType,this.bHasHtmlEmbed&&this.iconAction("view"),this.isViewSupported()||this.bHasHtmlEmbed||this.actions(s.without(this.actions(),"view")),l.broadcastEvent("FilesWebclient::ParseFile::after",[this,t])},S.prepareUploadFileData=function(t,e,i,s){var o=t.FileName,r=h.getFileExtension(o),a=h.getFileNameWithoutExtension(o),u=0;for(""!==r&&(r="."+r);s(o);)o=a+"_"+u+r,u++;return t.FileName=o,{Name:o,LastModified:n().unix(),Owner:l.getUserPublicId(),Path:e,FullPath:e+"/"+o,Type:i,ContentType:t.Type,Size:t.Size}},S.prototype.viewFile=function(t,e){e&&(e.ctrlKey||e.shiftKey)||(""!==this.sHtmlEmbed?d.showPopup(m,[this.sHtmlEmbed]):this.bIsLink?this.viewCommonFile(this.sLinkUrl):this.viewCommonFile())},S.prototype.openLink=function(){this.bIsLink&&u.openTab(this.sLinkUrl)},S.prototype.commonParseActions=function(t){s.each(t.Actions,(function(t,e){this.oActionsData[e]||(this.oActionsData[e]={});var i="";"download"!==e&&"view"!==e||(i="&"+h.getRandomHash()),this.oActionsData[e].Url=a.pString(t.url)+i,this.actions.push(e)}),this)},t.exports=S},QFUI:function(t,e,i){"use strict";var s,o,n=i("RN+F"),r=i("76Kh"),a=i("1grR"),h=i("hPb3"),l={};l.getDownloadLink=function(t,e,i){return e.length>0?"?/Download/"+t+"/DownloadFile/"+e+"/"+(i?"0/"+i:""):""},l.getIframeWrappwer=function(t,e){return"?/Raw/Iframe/"+t+"/"+window.encodeURIComponent(e)+"/"},l.thumbQueue=(s={},o={},function(t,e,i){e&&i?!(t in o)||o[t]>0?(t in o||(o[t]=2,s[t]=[]),o[t]--,i(e)):s[t].push({imageSrc:e,imageSrcObserver:i,messageUid:t}):s[t]&&s[t].length&&(s[t][0].imageSrcObserver(s[t][0].imageSrc),s[t].shift())}),l.showErrorIfAttachmentSizeLimit=function(t,e){var i=n.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE_DETAILED",{FILENAME:t,MAXSIZE:n.getFriendlySize(h.AttachmentSizeLimit)});return h.AttachmentSizeLimit>0&&e>h.AttachmentSizeLimit&&(r.showPopup(a,[i]),!0)},t.exports=l},cGGv:function(t,e,i){"use strict";var s=i("F/us"),o=i("EVdn"),n=i("0h2I"),r=i("wd/R"),a=i("IAk5"),h=i("QFUI"),l=i("RN+F"),u=i("AFLV"),p=i("ZP6a"),c=i("Yjhd"),d=i("ZCBP"),m=["image/jpeg","image/jpg","image/png","image/gif","text/html","text/plain","text/css","text/rfc822-headers","message/delivery-status","application/x-httpd-php","application/javascript"],b=[];function S(){this.id=n.observable(""),this.index=n.observable(0),this.fileName=n.observable(""),this.tempName=n.observable(""),this.displayName=n.observable(""),this.extension=n.observable(""),this.fileName.subscribe((function(t){this.id(t),this.displayName(t),this.extension(c.getFileExtension(t))}),this),this.size=n.observable(0),this.friendlySize=n.computed((function(){return this.size()>0?l.getFriendlySize(this.size()):""}),this),this.hash=n.observable(""),this.thumbUrlInQueue=n.observable(""),this.thumbUrlInQueueSubscribtion=this.thumbUrlInQueue.subscribe((function(){this.getInThumbQueue()}),this),this.thumbnailSrc=n.observable(""),this.thumbnailLoaded=n.observable(!1),this.thumbnailSessionUid=n.observable(""),this.mimeType=n.observable(""),this.uploadUid=n.observable(""),this.uploaded=n.observable(!1),this.uploadError=n.observable(!1),this.downloading=n.observable(!1),this.isViewMimeType=n.computed((function(){return-1!==o.inArray(this.mimeType(),m)}),this),this.bHasHtmlEmbed=!1,this.otherTemplates=n.observableArray([]),this.visibleCancelButton=n.observable(!0),this.statusText=n.observable(""),this.statusTooltip=n.computed((function(){return this.uploadError()?this.statusText():""}),this),this.progressPercent=n.observable(0),this.visibleProgress=n.observable(!1),this.uploadStarted=n.observable(!1),this.uploadStarted.subscribe((function(){this.uploadStarted()?(this.uploaded(!1),this.visibleProgress(!0),this.progressPercent(20)):(this.progressPercent(100),this.visibleProgress(!1),this.uploaded(!0))}),this),this.downloading.subscribe((function(){this.downloading()?this.visibleProgress(!0):(this.visibleProgress(!1),this.progressPercent(0))}),this),this.allowDrag=n.observable(!1),this.allowUpload=n.observable(!1),this.allowPublicLink=n.observable(!1),this.bIsSecure=n.observable(!1),this.isShared=n.observable(!1),this.sHeaderText="",this.oActionsData={view:{Text:l.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),HandlerName:"viewFile"},download:{Text:l.i18n("COREWEBCLIENT/ACTION_DOWNLOAD_FILE"),HandlerName:"downloadFile",Tooltip:n.computed((function(){var t=l.i18n("COREWEBCLIENT/INFO_CLICK_TO_DOWNLOAD_FILE",{FILENAME:this.fileName(),SIZE:this.friendlySize()});return""===this.friendlySize()&&(t=t.replace(" ()","")),t}),this)}},this.allowActions=n.observable(!0),this.iconAction=n.observable("download"),this.cssClasses=n.computed((function(){return this.getCommonClasses().join(" ")}),this),this.actions=n.observableArray([]),this.firstAction=n.computed((function(){return this.actions().length>1?this.actions()[0]:""}),this),this.secondAction=n.computed((function(){return 1===this.actions().length?this.actions()[0]:this.actions().length>1?this.actions()[1]:""}),this),this.subFiles=n.observableArray([]),this.subFilesExpanded=n.observable(!1),this.sUploadSubFolder="",this.bIsHidden=!1}o("html").hasClass("pdf")&&(m.push("application/pdf"),m.push("application/x-pdf")),S.prototype.addAction=function(t,e,i){e?this.actions.unshift(t):this.actions.push(t),this.actions(s.compact(this.actions())),i&&(this.oActionsData[t]=i)},S.prototype.removeAction=function(t){this.actions(s.without(this.actions(),t))},S.prototype.getMainAction=function(){return this.actions()[0]},S.prototype.hasAction=function(t){return-1!==s.indexOf(this.actions(),t)},S.prototype.getActionText=function(t){return this.hasAction(t)&&this.oActionsData[t]&&("string"==typeof this.oActionsData[t].Text||s.isFunction(this.oActionsData[t].Text))?s.isFunction(this.oActionsData[t].Text)?this.oActionsData[t].Text():this.oActionsData[t].Text:""},S.prototype.getActionUrl=function(t){return this.hasAction(t)&&this.oActionsData[t]&&this.oActionsData[t].Url||""},S.prototype.executeAction=function(t){var e=this.hasAction(t)&&this.oActionsData[t];e&&(s.isFunction(e.Handler)?e.Handler():"string"==typeof e.HandlerName&&s.isFunction(this[e.HandlerName])&&this[e.HandlerName]())},S.prototype.getTooltip=function(t){var e=this.hasAction(t)&&this.oActionsData[t]?this.oActionsData[t].Tooltip:"";return"string"==typeof e?e:s.isFunction(e)?e():""},S.prototype.getCommonClasses=function(){var t=[];return(this.allowUpload()&&!this.uploaded()||this.downloading())&&t.push("incomplete"),this.uploadError()?t.push("fail"):t.push("success"),t},S.prototype.parse=function(t){this.fileName(u.pString(t.FileName)),this.tempName(u.pString(t.TempName)),""===this.tempName()&&this.tempName(this.fileName()),this.mimeType(u.pString(t.MimeType)),this.size(t.EstimatedSize?u.pInt(t.EstimatedSize):u.pInt(t.SizeInBytes)),this.hash(u.pString(t.Hash)),this.parseActions(t),this.uploadUid(this.hash()),this.uploaded(!0),o.isFunction(this.additionalParse)&&this.additionalParse(t)},S.prototype.parseActions=function(t){this.thumbUrlInQueue(""!==u.pString(t.ThumbnailUrl)?u.pString(t.ThumbnailUrl)+"/"+Math.random():""),this.commonParseActions(t),this.commonExcludeActions()},S.prototype.commonExcludeActions=function(){this.isViewSupported()||this.actions(s.without(this.actions(),"view"))},S.prototype.commonParseActions=function(t){s.each(t.Actions,(function(t,e){this.oActionsData[e]||(this.oActionsData[e]={}),this.oActionsData[e].Url=u.pString(t.url),this.actions.push(e)}),this)},S.addViewExtensions=function(t){s.isArray(t)&&(b=s.union(b,t))},S.prototype.isViewSupported=function(){return-1!==o.inArray(this.mimeType(),m)||-1!==o.inArray(this.extension(),b)},S.prototype.getInThumbQueue=function(){""===this.thumbUrlInQueue()||this.linked&&(!this.linked||this.linked())||(this.thumbnailSessionUid(Date.now().toString()),h.thumbQueue(this.thumbnailSessionUid(),this.thumbUrlInQueue(),this.thumbnailSrc))},S.prototype.downloadFile=function(t){var e=this.getActionUrl("download"),i={File:this,CancelDownload:!1};e.length>0&&"#"!==e&&(t||a.broadcastEvent("AbstractFileModel::FileDownload::before",i),i.CancelDownload||(s.isFunction(i.CustomDownloadHandler)?i.CustomDownloadHandler():(e+="/"+r().unix(),p.downloadByUrl(e,"eml"===this.extension()))))},S.prototype.viewFile=function(t,e){c.calmEvent(e),this.viewCommonFile()},S.prototype.viewCommonFile=function(t){var e=null,i=null;u.isNonEmptyString(t)||(t=p.getAppPath()+this.getActionUrl("view")),t.length>0&&"#"!==t&&(i={sUrl:t,index:this.index(),bBreakView:!1},a.broadcastEvent("AbstractFileModel::FileView::before",i),i.bBreakView||(e=d.open(i.sUrl,i.sUrl,!1))&&e.focus())},S.prototype.eventDragStart=function(t,e){var i=e.originalEvent||e;return t&&i&&i.dataTransfer&&i.dataTransfer.setData&&i.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},S.prototype.generateTransferDownloadUrl=function(){var t=this.getActionUrl("download");return"http"!==t.substr(0,4)&&(t=p.getAppPath()+t),this.mimeType()+":"+this.fileName()+":"+t},S.prototype.onUploadSelect=function(t,e,i){i||(this.fileName(u.pString(e.FileName)),this.mimeType(u.pString(e.Type)),this.size(u.pInt(e.Size))),this.uploadUid(t),this.uploaded(!1),this.statusText(""),this.progressPercent(0),this.visibleProgress(!1),this.sUploadSubFolder=u.pString(e.Folder),this.bIsHidden=""!==this.sUploadSubFolder},S.prototype.onUploadStart=function(){this.visibleProgress(!0)},S.prototype.onUploadProgress=function(t,e){e>0&&(this.progressPercent(Math.ceil(t/e*100)),this.visibleProgress(!0))},S.prototype.onDownloadProgress=function(t,e){e>0&&(this.progressPercent(Math.ceil(t/e*100)),this.visibleProgress(this.progressPercent()<100))},S.prototype.onUploadComplete=function(t,e,i){var s,o=!(e&&i&&!i.ErrorCode&&i.Result&&!i.Result.Error),n=i&&i.ErrorCode&&i.ErrorCode===Enums.Errors.CanNotUploadFileLimit?l.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):l.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN");this.progressPercent(0),this.visibleProgress(!1),this.uploaded(!0),this.uploadError(o),this.statusText(o?n:l.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),o||(this.fillDataAfterUploadComplete(i,t),setTimeout((s=this,function(){s.statusText("")}),3e3))},S.prototype.fillDataAfterUploadComplete=function(t,e){},S.prototype.onImageLoad=function(t,e){""===this.thumbUrlInQueue()||this.thumbnailLoaded()||(this.thumbnailLoaded(!0),h.thumbQueue(this.thumbnailSessionUid()))},S.prototype.stopDownloading=function(){this.downloading(!1)},S.prototype.startDownloading=function(){this.downloading(!0)},t.exports=S},eywM:function(t,e,i){"use strict";var s=i("0h2I"),o=i("RN+F"),n=i("Yjhd"),r=i("76Kh"),a=i("1grR"),h=i("oTCo");function l(){this.shareTooltip=s.computed((function(){return o.i18n("SHAREDFILES/ACTION_SHARE")}),this),this.storageType=null,this.isUploadEnabled=s.observable(!1)}l.prototype.ViewTemplate="SharedFiles_ButtonsView",l.prototype.useFilesViewData=function(t){this.selectedItem=t.selector.itemSelected,this.storageType=t.storageType,t.pathItems.subscribe((function(){var e=t.pathItems().length,i=t.pathItems()[e-1]||!1;!this.isSharedStorage()||0!==e&&i.oExtendedProps&&i.oExtendedProps.Access&&i.oExtendedProps.Access===Enums.SharedFileAccess.Write?(t.enableButton(t.createFolderButtonModules,"SharedFiles"),t.enableButton(t.renameButtonModules,"SharedFiles"),t.enableButton(t.shortcutButtonModules,"SharedFiles"),this.isUploadEnabled(!0)):(t.disableButton(t.createFolderButtonModules,"SharedFiles"),t.disableButton(t.renameButtonModules,"SharedFiles"),t.disableButton(t.shortcutButtonModules,"SharedFiles"),this.isUploadEnabled(!1)),this.isSharedStorage()&&0!==e&&i.oExtendedProps&&i.oExtendedProps.Access&&i.oExtendedProps.Access!==Enums.SharedFileAccess.Write?t.disableButton(t.deleteButtonModules,"SharedFiles"):t.enableButton(t.deleteButtonModules,"SharedFiles")}),this),this.shareCommand=n.createCommand(this,(function(){this.selectedItem().IS_FILE&&this.selectedItem().bIsSecure()&&this.selectedItem().oExtendedProps&&!this.selectedItem().oExtendedProps.ParanoidKey?r.showPopup(a,[o.i18n("SHAREDFILES/INFO_SHARING_NOT_SUPPORTED"),null,o.i18n("SHAREDFILES/TITLE_SHARE_FILE")]):r.showPopup(h,[this.selectedItem()])}),(function(){return!t.isZipFolder()&&null!==this.selectedItem()&&1===t.selector.listCheckedAndSelected().length&&t.checkedReadyForOperations()&&(t.storageType()===Enums.FileStorageType.Personal||t.storageType()===Enums.FileStorageType.Encrypted&&this.selectedItem().IS_FILE)}))},l.prototype.isSharedStorage=function(){return this.storageType()===Enums.FileStorageType.Shared},t.exports=new l},oTCo:function(t,e,i){"use strict";var s=i("F/us"),o=i("EVdn"),n=i("0h2I"),r=i("Ol7c"),a=i("RN+F"),h=i("AFLV"),l=i("o0Bx"),u=i("JFZZ"),p=i("IAk5"),c=i("czxF"),d=i("OgeD"),m=i("76Kh"),b=i("SQrT"),S=i("Pg7U"),E=d.run("ActivityHistory","getShowHistoryPopup");function g(){c.call(this),this.guestsDom=n.observable(),this.guestsDom.subscribe((function(){this.initInputosaurus(this.guestsDom,this.guests,this.guestsLock)}),this),this.ownersDom=n.observable(),this.ownersDom.subscribe((function(){this.initInputosaurus(this.ownersDom,this.owners,this.ownersLock)}),this),this.guestsLock=n.observable(!1),this.guests=n.observable("").extend({reversible:!0}),this.guests.subscribe((function(){this.guestsLock()||(o(this.guestsDom()).val(this.guests()),o(this.guestsDom()).inputosaurus("refresh"))}),this),this.ownersLock=n.observable(!1),this.owners=n.observable("").extend({reversible:!0}),this.owners.subscribe((function(){this.ownersLock()||(o(this.ownersDom()).val(this.owners()),o(this.ownersDom()).inputosaurus("refresh"))}),this),this.owner=n.observable(""),this.storage=n.observable(""),this.path=n.observable(""),this.id=n.observable(""),this.shares=n.observableArray([]),this.recivedAnim=n.observable(!1).extend({autoResetToFalse:500}),this.whomAnimate=n.observable(""),this.newShare=n.observable(""),this.newShareFocus=n.observable(!1),this.newShareAccess=n.observable(Enums.SharedFileAccess.Read),this.sharedToAll=n.observable(!1),this.sharedToAllAccess=n.observable(Enums.SharedFileAccess.Read),this.canAdd=n.observable(!1),this.aAccess=[{value:Enums.SharedFileAccess.Read,display:a.i18n("SHAREDFILES/LABEL_READ_ACCESS")},{value:Enums.SharedFileAccess.Write,display:a.i18n("SHAREDFILES/LABEL_WRITE_ACCESS")}],this.oFileItem=n.observable(null),this.bSaving=n.observable(!1),this.sDialogHintText=n.observable(""),this.bAllowShowHistory=!!E}s.extendOwn(g.prototype,c.prototype),g.prototype.PopupTemplate="SharedFiles_FilesSharePopup",g.prototype.onOpen=function(t){s.isUndefined(t)||(this.oFileItem(t),this.storage(t.storageType()),this.path(t.path()),this.id(t.id()),this.sDialogHintText(""),p.broadcastEvent("SharedFiles::OpenFilesSharePopup",{DialogHintText:this.sDialogHintText,IsDir:!(this.oFileItem()instanceof S)}),t.oExtendedProps&&t.oExtendedProps.Shares?this.populateShares(t.oExtendedProps.Shares):this.populateShares([]))},g.prototype.onSaveClick=function(){this.validateShare()&&(this.bSaving(!0),this.updateShare(this.storage(),this.path(),this.id(),this.getShares()))},g.prototype.onEscHandler=function(){this.cancelPopup()},g.prototype.initInputosaurus=function(t,e,i){var n=d.run("ContactsWebclient","getSuggestionsAutocompleteCallback",["team",p.getUserPublicId()])||function(){};t()&&o(t()).length>0&&o(t()).inputosaurus({width:"auto",parseOnBlur:!0,autoCompleteSource:n,change:s.bind((function(t){i(!0),this.setRecipient(e,t.target.value),i(!1)}),this),copy:s.bind((function(t){this.inputosaurusBuffer=t}),this),paste:s.bind((function(){var t=this.inputosaurusBuffer||"";return this.inputosaurusBuffer="",t}),this),mobileDevice:p.isMobile()})},g.prototype.setRecipient=function(t,e){t()===e?t.valueHasMutated():t(e)},g.prototype.getShares=function(){return o.merge(s.map(r.getArrayRecipients(this.guests(),!1),(function(t){return{PublicId:t.email,Access:Enums.SharedFileAccess.Read}})),s.map(r.getArrayRecipients(this.owners(),!1),(function(t){return{PublicId:t.email,Access:Enums.SharedFileAccess.Write}})))},g.prototype.populateShares=function(t){var e="",i="";s.each(t,(function(t){h.pInt(t.Access,Enums.SharedFileAccess.Read)===Enums.SharedFileAccess.Read&&""!==t.PublicId?e=e+t.PublicId+", ":h.pInt(t.Access,Enums.SharedFileAccess.Read)===Enums.SharedFileAccess.Write&&""!==t.PublicId&&(i=i+t.PublicId+", ")}),this),this.setRecipient(this.guests,e),this.setRecipient(this.owners,i)},g.prototype.updateShare=function(t,e,i,o){var n={Storage:t,Path:e,Id:i,Shares:o,IsDir:!(this.oFileItem()instanceof S)},r=s.bind((function(){l.send("SharedFiles","UpdateShare",n,s.bind(this.onUpdateShareResponse,this))}),this),a=s.bind((function(){this.bSaving(!1)}),this);!1===p.broadcastEvent("SharedFiles::UpdateShare::before",{Shares:o,OnSuccessCallback:r,OnErrorCallback:a,oFileItem:this.oFileItem(),IsDir:!(this.oFileItem()instanceof S)})&&r()},g.prototype.onUpdateShareResponse=function(t,e){t.Result?(this.oFileItem().oExtendedProps||(this.oFileItem().oExtendedProps={}),this.oFileItem().oExtendedProps.Shares=[],s.each(this.getShares(),s.bind((function(t){this.oFileItem().oExtendedProps.Shares.push({Access:t.Access,PublicId:t.PublicId})}),this)),0===this.oFileItem().oExtendedProps.Shares.length?this.oFileItem().isShared(!1):this.oFileItem().isShared(!0),b.showReport(a.i18n("SHAREDFILES/INFO_SHARING_STATUS_UPDATED"))):u.showErrorByCode(t,a.i18n("SHAREDFILES/ERROR_UNKNOWN_ERROR")),this.bSaving(!1),this.closePopup(),this.oFileItem(null)},g.prototype.validateShare=function(){var t=s.map(r.getArrayRecipients(this.guests(),!1),(function(t){return t.email})),e=s.map(r.getArrayRecipients(this.owners(),!1),(function(t){return t.email})),i=s.intersection(t,e);return!(i.length>0)||(b.showError(a.i18n("SHAREDFILES/ERROR_DUPLICATE_USERS",{USERNAME:i.length>1?i.join(", "):i[0]},null,i.length)),!1)},g.prototype.showHistory=function(){this.bAllowShowHistory&&m.showPopup(E,[a.i18n("SHAREDFILES/HEADING_HISTORY_POPUP"),this.oFileItem()])},t.exports=new g},uoSt:function(t,e,i){"use strict";t.exports=function(t){var e=i("F/us"),s=i("RN+F"),o=i("IAk5"),n=i("SQrT"),r=null;function a(){return r||(r=i("eywM")),r}return i("1+iQ"),o.isUserNormalOrTenant()?{start:function(t){t.run("FilesWebclient","registerToolbarButtons",[a()]),o.subscribeEvent("FilesWebclient::ParseFile::after",(function(t){var i=t[0];void 0!==i.oExtendedProps&&void 0!==i.oExtendedProps.Shares&&e.isArray(i.oExtendedProps.Shares)&&i.oExtendedProps.Shares.length>0&&i.isShared(!0)})),o.subscribeEvent("FilesWebclient::ParseFolder::after",(function(t){var i=t[0];void 0!==i.oExtendedProps&&void 0!==i.oExtendedProps.Shares&&e.isArray(i.oExtendedProps.Shares)&&i.oExtendedProps.Shares.length>0&&i.isShared(!0)})),o.subscribeEvent("Jua::FileUpload::isUploadAvailable",(function(t){a().isUploadEnabled()||"Files"!==t.sModuleName||(n.showError(s.i18n("SHAREDFILES/ERROR_NOT_ENOUGH_PERMISSIONS")),t.isUploadAvailable(!1))}))},getFilesSharePopup:function(){return i("oTCo")}}:null}}}]);